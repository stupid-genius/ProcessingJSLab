(()=>{var ee=Object.defineProperty;var Ue=Object.getOwnPropertyDescriptor;var $e=Object.getOwnPropertyNames;var je=Object.prototype.hasOwnProperty;var $=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(n,t)=>(typeof require<"u"?require:n)[t]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var Ge=(e,n)=>()=>(e&&(n=e(e=0)),n);var z=(e,n)=>()=>(n||e((n={exports:{}}).exports,n),n.exports),He=(e,n)=>{for(var t in n)ee(e,t,{get:n[t],enumerable:!0})},Xe=(e,n,t,c)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of $e(n))!je.call(e,r)&&r!==t&&ee(e,r,{get:()=>n[r],enumerable:!(c=Ue(n,r))||c.enumerable});return e};var me=e=>Xe(ee({},"__esModule",{value:!0}),e);var ne={};He(ne,{APITransport:()=>we,ConsoleTransport:()=>te,FileTransport:()=>ye,default:()=>T,interpolate:()=>xe});function T(e){if(e===void 0)throw new Error("Logger requires the file name of where it's being used.");if(!new.target)return new T(...arguments);Object.defineProperties(this,{log:{value:function(n,t,c){j.indexOf(n)<=j.indexOf(T.state.currentLevel)&&Object.values(T.state.transports).forEach(r=>{queueMicrotask(()=>r.log({level:n,msg:t,category:e,...c}))})}}}),j.forEach(n=>{let t;n==="noop"?t=()=>{}:t=this.log.bind(this,n),Object.defineProperty(this,n,{value:t})})}function te(e){if(!new.target)return new te(...arguments);Object.defineProperty(this,"log",{value:function(n){let t=Object.assign({},e,n);if(t.isTable)console.table(t.msg,t.args);else if(t.group)console[t.group](t.msg);else{let[c,r]=t.style?.length===2?t.style:["font-weight: bold; color: green;","font-style: italic;"];console[t.level](`%c${t.timestamp||new Date().toLocaleTimeString("en-US",t.dateFmt)}%c %c[${t.category}]%c ${t.msg}`,c,"",r,"",...t.args||[])}}})}function ye(e){if(window.showSaveFilePicker===void 0){let n="FileTransport requires the File System Access API";throw console.warn(n),new Error(n)}if(!new.target)return new ye(...arguments);Object.defineProperty(this,"initialize",{value:async function(){try{let n=await window.showSaveFilePicker({types:[{description:"Log Files",accept:{"text/plain":[".log"]}}]});Object.defineProperty(this,"log",{value:async function(t){let c=Object.assign({},e,t),r;try{r=await n.createWritable({keepExistingData:!0}),await r.write(`${c.timestamp||new Date().toLocaleTimeString("en-US",c.dateFmt)} [${c.category}] ${c.level}: ${c.msg}
`)}catch(d){console.error(d)}finally{await r.close()}}})}catch(n){console.error(n)}}})}function we(e){if(!new.target)return new we(...arguments);Object.defineProperty(this,"log",{value:async function(n){let t=xe(e,n);try{let c=await fetch(t.url,{method:t.method,headers:Object.entries(t.headers||{}).reduce((r,[d,s])=>(r[d]=s,r),{}),body:t.body});console.debug(c)}catch(c){console.error(c)}}})}var j,xe,re=Ge(()=>{j=["noop","error","warn","info","debug","silly"];Object.defineProperties(T,{addTransport:{value:(e,n)=>{T.state.transports[e]=n}},state:{value:{currentLevel:"noop",transports:{}}},level:{get:()=>T.state.currentLevel},removeTransport:{value:e=>{delete T.state.transports[e]}},setLogLevel:{value:e=>{if(j.some(n=>n===e))T.state.currentLevel=e;else throw new Error(`${e} is not a valid logger level`)}}});T.addTransport("default",te({}));j.reduce((e,n)=>(Object.defineProperty(e,n.toUpperCase(),{enumerable:!0,get:()=>n}),e),T);xe=function e(n,t){if(n instanceof Object){let c=Array.isArray(n)?[]:{};for(let r in n){let d=e(n[r],t);try{c[r]=JSON.parse(d)}catch{d!==void 0&&d!==""&&(c[r]=d)}}return c}return typeof n!="string"?n:n.replace(/\{\{(.+?)}}/g,(c,r)=>{let d=t[r]||"";return d instanceof Object?JSON.stringify(d):d})}});var ke=z((tt,be)=>{function W(){if(W.instance instanceof W)return W.instance;if(!new.target)return new W(...arguments);Object.defineProperty(W,"instance",{value:this});let e=Math.PI/180;Object.defineProperties(this,{cos:{value:{},enumerable:!0},sin:{value:{},enumerable:!0}});for(let n=0;n<=360;++n)Object.defineProperty(this.cos,n,{value:Math.cos(n*e)}),Object.defineProperty(this.sin,n,{value:Math.sin(n*e)})}var G=Object.freeze({addColors:(...e)=>e.length===0?[]:e[0].map((n,t)=>e.reduce((c,r)=>c+r[t],0)),decodeColor:e=>[e>>16&255,e>>8&255,e&255,e>>>24],direction:(e,n,t,c)=>Math.atan2(c-n,t-e),distance:(e,n,t,c)=>Math.hypot(Math.abs(t-e),Math.abs(c-n)),fastInvSqrt:e=>{let t=new Float32Array([e]),c=new Float32Array([e]),r=new Int32Array(t.buffer);return r[0]=1597463007-(r[0]>>1),c[0]=t[0],c[0]=c[0]*(1.5-e*.5*c[0]*c[0]),c[0]},fastTrig:W(),intersection:(e,n,t,c,r,d,s,u)=>{let w=(e-t)*(d-u)-(n-c)*(r-s);if(w===0)return null;let y=e*c-n*t,v=r*u-d*s,o=(y*(r-s)-(e-t)*v)/w,h=(y*(d-u)-(n-c)*v)/w;return[o,h]},invSqrt:e=>1/Math.sqrt(e),randomColor:(e=!1)=>{let n=Array.from({length:3},()=>G.roll(255));return n.push(e?G.roll(255):255),n},randomGrayscale:(e=!1)=>{let n=G.roll(255),t=Array.from({length:3},()=>n);return t.push(e?G.roll(255):255),t},range:(e,n)=>{let t=Math.random()*(n-e);return Number.isInteger(e)&&Number.isInteger(n)&&(t=Math.floor(t)),t+e},roll:e=>Math.floor(Math.random()*e)});be.exports=G});var Oe=z((nt,Pe)=>{function ze(){this.x+=this.dx,this.y+=this.dy}function Ye(e){e.stroke(this.r,this.g,this.b,this.a),e.point(this.x,this.y)}function _e(e,n=ze,t=Ye){if(!new.target)return new _e(...arguments);let c=2,r=new d;r.next=new d,r.prev=r.next,r.prev.next=r,r.prev.prev=r,r.active=!1,r.prev.active=!1,this.ACCELERATION=[0,.25],this.ELASTICITY=.2,this.MAX_COUNT=1e4,Object.defineProperties(this,{count:{get:function(){return c}},createParticle:{value:function(s,u,w,y,v,o,h,l,a){let p;if(r.prev.active){if(c>=this.MAX_COUNT)return;p=new d(s,u,w,y,v,o,h,l,a),p.next=r,p.prev=r.prev,p.prev.next=p,r.prev=p,r=p,++c}else p=r.prev,p.activate(s,u,w,y,v,o,h,l,a),r=p;return p}},list:{get:function(){return r}},render:{value:function(){let s=r;for(;s.active;){n.call(s,this),t.call(s,e);let u=s;if(s.ttl>0&&++s.t>=s.ttl&&(s.active=!1),s=s.next,s===r)break;u.active||(u===r?r=u.next:(u.next.prev=u.prev,u.prev.next=u.next,u.next=r,u.prev=r.prev,r.prev.next=u,r.prev=u))}}}});function d(s,u,w,y,v,o,h,l,a){if(!new.target)return new d(...arguments);Object.defineProperties(this,{activate:{value:function(p,m,f,i,g,x,b,_,O){this.active=!0,this.ttl=p,this.t=0,this.x=m,this.y=f,this.dx=i,this.dy=g,this.ddx=0,this.ddy=0,this.r=x,this.g=b,this.b=_,this.a=O}}}),this.activate(s,u,w,y,v,o,h,l,a)}}Pe.exports=_e});var Ee=z((Le,ie)=>{(function(e){if(typeof Le=="object"&&typeof ie<"u")ie.exports=e();else if(typeof define=="function"&&define.amd)define([],e);else{var n;typeof window<"u"?n=window:typeof global<"u"?n=global:typeof self<"u"?n=self:n=this,n.GIF=e()}})(function(){var e,n,t;return function c(r,d,s){function u(v,o){if(!d[v]){if(!r[v]){var h=typeof $=="function"&&$;if(!o&&h)return h(v,!0);if(w)return w(v,!0);var l=new Error("Cannot find module '"+v+"'");throw l.code="MODULE_NOT_FOUND",l}var a=d[v]={exports:{}};r[v][0].call(a.exports,function(p){var m=r[v][1][p];return u(m||p)},a,a.exports,c,r,d,s)}return d[v].exports}for(var w=typeof $=="function"&&$,y=0;y<s.length;y++)u(s[y]);return u}({1:[function(c,r,d){function s(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}r.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._maxListeners=void 0,s.defaultMaxListeners=10,s.prototype.setMaxListeners=function(o){if(!w(o)||o<0||isNaN(o))throw TypeError("n must be a positive number");return this._maxListeners=o,this},s.prototype.emit=function(o){var h,l,a,p,m,f;if(this._events||(this._events={}),o==="error"&&(!this._events.error||y(this._events.error)&&!this._events.error.length)){if(h=arguments[1],h instanceof Error)throw h;var i=new Error('Uncaught, unspecified "error" event. ('+h+")");throw i.context=h,i}if(l=this._events[o],v(l))return!1;if(u(l))switch(arguments.length){case 1:l.call(this);break;case 2:l.call(this,arguments[1]);break;case 3:l.call(this,arguments[1],arguments[2]);break;default:p=Array.prototype.slice.call(arguments,1),l.apply(this,p)}else if(y(l))for(p=Array.prototype.slice.call(arguments,1),f=l.slice(),a=f.length,m=0;m<a;m++)f[m].apply(this,p);return!0},s.prototype.addListener=function(o,h){var l;if(!u(h))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",o,u(h.listener)?h.listener:h),this._events[o]?y(this._events[o])?this._events[o].push(h):this._events[o]=[this._events[o],h]:this._events[o]=h,y(this._events[o])&&!this._events[o].warned&&(v(this._maxListeners)?l=s.defaultMaxListeners:l=this._maxListeners,l&&l>0&&this._events[o].length>l&&(this._events[o].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[o].length),typeof console.trace=="function"&&console.trace())),this},s.prototype.on=s.prototype.addListener,s.prototype.once=function(o,h){if(!u(h))throw TypeError("listener must be a function");var l=!1;function a(){this.removeListener(o,a),l||(l=!0,h.apply(this,arguments))}return a.listener=h,this.on(o,a),this},s.prototype.removeListener=function(o,h){var l,a,p,m;if(!u(h))throw TypeError("listener must be a function");if(!this._events||!this._events[o])return this;if(l=this._events[o],p=l.length,a=-1,l===h||u(l.listener)&&l.listener===h)delete this._events[o],this._events.removeListener&&this.emit("removeListener",o,h);else if(y(l)){for(m=p;m-- >0;)if(l[m]===h||l[m].listener&&l[m].listener===h){a=m;break}if(a<0)return this;l.length===1?(l.length=0,delete this._events[o]):l.splice(a,1),this._events.removeListener&&this.emit("removeListener",o,h)}return this},s.prototype.removeAllListeners=function(o){var h,l;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[o]&&delete this._events[o],this;if(arguments.length===0){for(h in this._events)h!=="removeListener"&&this.removeAllListeners(h);return this.removeAllListeners("removeListener"),this._events={},this}if(l=this._events[o],u(l))this.removeListener(o,l);else if(l)for(;l.length;)this.removeListener(o,l[l.length-1]);return delete this._events[o],this},s.prototype.listeners=function(o){var h;return!this._events||!this._events[o]?h=[]:u(this._events[o])?h=[this._events[o]]:h=this._events[o].slice(),h},s.prototype.listenerCount=function(o){if(this._events){var h=this._events[o];if(u(h))return 1;if(h)return h.length}return 0},s.listenerCount=function(o,h){return o.listenerCount(h)};function u(o){return typeof o=="function"}function w(o){return typeof o=="number"}function y(o){return typeof o=="object"&&o!==null}function v(o){return o===void 0}},{}],2:[function(c,r,d){var s,u,w,y,v;v=navigator.userAgent.toLowerCase(),y=navigator.platform.toLowerCase(),s=v.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],w=s[1]==="ie"&&document.documentMode,u={name:s[1]==="version"?s[3]:s[1],version:w||parseFloat(s[1]==="opera"&&s[4]?s[4]:s[2]),platform:{name:v.match(/ip(?:ad|od|hone)/)?"ios":(v.match(/(?:webos|android)/)||y.match(/mac|win|linux/)||["other"])[0]}},u[u.name]=!0,u[u.name+parseInt(u.version,10)]=!0,u.platform[u.platform.name]=!0,r.exports=u},{}],3:[function(c,r,d){var s,u,w,y=function(l,a){for(var p in a)v.call(a,p)&&(l[p]=a[p]);function m(){this.constructor=l}return m.prototype=a.prototype,l.prototype=new m,l.__super__=a.prototype,l},v={}.hasOwnProperty,o=[].indexOf||function(l){for(var a=0,p=this.length;a<p;a++)if(a in this&&this[a]===l)return a;return-1},h=[].slice;s=c("events").EventEmitter,w=c("./browser.coffee"),u=function(l){var a,p;y(m,l),a={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},p={delay:500,copy:!1};function m(f){var i,g,x;this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(f);for(g in a)x=a[g],(i=this.options)[g]==null&&(i[g]=x)}return m.prototype.setOption=function(f,i){if(this.options[f]=i,this._canvas!=null&&(f==="width"||f==="height"))return this._canvas[f]=i},m.prototype.setOptions=function(f){var i,g,x;g=[];for(i in f)v.call(f,i)&&(x=f[i],g.push(this.setOption(i,x)));return g},m.prototype.addFrame=function(f,i){var g,x;i==null&&(i={}),g={},g.transparent=this.options.transparent;for(x in p)g[x]=i[x]||p[x];if(this.options.width==null&&this.setOption("width",f.width),this.options.height==null&&this.setOption("height",f.height),typeof ImageData<"u"&&ImageData!==null&&f instanceof ImageData)g.data=f.data;else if(typeof CanvasRenderingContext2D<"u"&&CanvasRenderingContext2D!==null&&f instanceof CanvasRenderingContext2D||typeof WebGLRenderingContext<"u"&&WebGLRenderingContext!==null&&f instanceof WebGLRenderingContext)i.copy?g.data=this.getContextData(f):g.context=f;else if(f.childNodes!=null)i.copy?g.data=this.getImageData(f):g.image=f;else throw new Error("Invalid image");return this.frames.push(g)},m.prototype.render=function(){var f,i,g,x;if(this.running)throw new Error("Already running");if(this.options.width==null||this.options.height==null)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=function(){var b,_,O;for(O=[],f=b=0,_=this.frames.length;0<=_?b<_:b>_;f=0<=_?++b:--b)O.push(null);return O}.call(this),g=this.spawnWorkers(),this.options.globalPalette===!0)this.renderNextFrame();else for(f=i=0,x=g;0<=x?i<x:i>x;f=0<=x?++i:--i)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},m.prototype.abort=function(){for(var f;f=this.activeWorkers.shift(),f!=null;)this.log("killing active worker"),f.terminate();return this.running=!1,this.emit("abort")},m.prototype.spawnWorkers=function(){var f,i,g,x;return i=Math.min(this.options.workers,this.frames.length),function(){x=[];for(var b=g=this.freeWorkers.length;g<=i?b<i:b>i;g<=i?b++:b--)x.push(b);return x}.apply(this).forEach(function(b){return function(_){var O;return b.log("spawning worker "+_),O=new Worker(b.options.workerScript),O.onmessage=function(P){return b.activeWorkers.splice(b.activeWorkers.indexOf(O),1),b.freeWorkers.push(O),b.frameFinished(P.data)},b.freeWorkers.push(O)}}(this)),i},m.prototype.frameFinished=function(f){var i,g,x;if(this.log("frame "+f.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[f.index]=f,this.options.globalPalette===!0&&(this.options.globalPalette=f.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(i=g=1,x=this.freeWorkers.length;1<=x?g<x:g>x;i=1<=x?++g:--g)this.renderNextFrame();return o.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},m.prototype.finishRendering=function(){var f,i,g,x,b,_,O,P,L,I,E,N,A,R,S,k;for(P=0,R=this.imageParts,b=0,L=R.length;b<L;b++)i=R[b],P+=(i.data.length-1)*i.pageSize+i.cursor;for(P+=i.pageSize-i.cursor,this.log("rendering finished - filesize "+Math.round(P/1e3)+"kb"),f=new Uint8Array(P),N=0,S=this.imageParts,_=0,I=S.length;_<I;_++)for(i=S[_],k=i.data,g=O=0,E=k.length;O<E;g=++O)A=k[g],f.set(A,N),g===i.data.length-1?N+=i.cursor:N+=i.pageSize;return x=new Blob([f],{type:"image/gif"}),this.emit("finished",x,f)},m.prototype.renderNextFrame=function(){var f,i,g;if(this.freeWorkers.length===0)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return f=this.frames[this.nextFrame++],g=this.freeWorkers.shift(),i=this.getTask(f),this.log("starting frame "+(i.index+1)+" of "+this.frames.length),this.activeWorkers.push(g),g.postMessage(i)},m.prototype.getContextData=function(f){return f.getImageData(0,0,this.options.width,this.options.height).data},m.prototype.getImageData=function(f){var i;return this._canvas==null&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),i=this._canvas.getContext("2d"),i.setFill=this.options.background,i.fillRect(0,0,this.options.width,this.options.height),i.drawImage(f,0,0),this.getContextData(i)},m.prototype.getTask=function(f){var i,g;if(i=this.frames.indexOf(f),g={index:i,last:i===this.frames.length-1,delay:f.delay,transparent:f.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:w.name==="chrome"},f.data!=null)g.data=f.data;else if(f.context!=null)g.data=this.getContextData(f.context);else if(f.image!=null)g.data=this.getImageData(f.image);else throw new Error("Invalid frame");return g},m.prototype.log=function(){var f;if(f=1<=arguments.length?h.call(arguments,0):[],!!this.options.debug)return console.log.apply(console,f)},m}(s),r.exports=u},{"./browser.coffee":2,events:1}]},{},[3])(3)})});var Ie=z((it,Me)=>{var Be=Ee(),Ve=(re(),me(ne)).default,D=new Ve("Renderer.js");function se(e,n){if(!new.target)return new se(...arguments);let t=e.pixels.toArray(),c=t.length,r=new Proxy(e,{get:function(d,s,u){if(typeof s=="string"&&!isNaN(s)){let w=+s;if(Number.isInteger(w)&&w>=0&&w<c)return t[w]}else return Reflect.get(d,s,u)},set:function(d,s,u,w){if(typeof s=="string"&&!isNaN(s)){let y=Math.round(+s);Number.isInteger(y)&&y>=0&&y<c?t[y]=Array.isArray(u)?n.color(...u):u:D.noop(`index ${y} out of range, ${c}`)}else return Reflect.set(d,s,u,w)}});return e.loaded=!0,Object.defineProperties(r,{blit:{value:function(d,s){e.pixels.set(t),n.image(e,d,s)}},length:{value:t.length},update:{value:function(){e.pixels.set(t)}}}),r}function oe(e){if(!new.target)return new oe(...arguments);let n=0,t=[];Object.defineProperties(t,{flip:{value:function(){n^=1}},read:{get:function(){return this[n^1]}},write:{get:function(){return this[n]}}});let c=e.createImage();t.push({buffer:c,get pixels(){return c.pixels.toArray()}});let r=e.createImage();t.push({buffer:r,get pixels(){return r.pixels.toArray()}}),Object.defineProperties(this,{flip:{value:function(){let d=t.write.buffer;d.update(),e.background(d),t.flip()}},readBuffer:{get:function(){return t.read.pixels}},writeBuffer:{get:function(){return t.write.buffer}}})}function H(e){if(H.instance!==void 0)return H.instance;if(!new.target)return new H(...arguments);Object.defineProperty(H,"instance",{value:this});let n={background:4278849802,frameRate:60,height:e.height,showFrameRate:!1,showRuler:!1,width:e.width},t,c=!1,r=!1,d=50,s=new Be({workers:navigator.hardwareConcurrency-2,quality:10}),u=!1,w=12,y=5,v=[];Object.defineProperties(this,{createImage:{value:function(o,h){let l=t.createImage(o??e.width,h??e.height);return new se(l,t)}},frame:{set:function(o){let h=t.width/2,l=t.height/2,a=new Proxy(o,{apply:function(p,m,f){if(p.apply(m,f),c&&(t.fill(255),t.textSize(12),t.text(t.__frameRate,t.width-50,t.height-10)),r){t.stroke(255),t.line(0,l,t.width,l),t.line(h,0,h,t.height);for(let i=d;i<t.width;i+=d)t.point(h+i,l-1),t.point(h-i,l-1),t.point(h+i,l+1),t.point(h-i,l+1);for(let i=d;i<t.height;i+=d)t.point(h-1,l+i),t.point(h-1,l-i),t.point(h+1,l+i),t.point(h+1,l-i)}if(u&&s.addFrame(e,{copy:!0,delay:1e3/t.frameRate()}),v.length>0){t.fill(255),t.textSize(w);for(let i=0;i<v.length;++i)t.text(v[i],t.width-200,t.height-300+i*w);v.length=0}}});Object.defineProperty(t,"draw",{value:a,writable:!0}),D.debug("pjs.draw set")}},doubleBuffer:{value:function(){return new oe(this)}},echo:{value:function(o){v.push(o),v.length>y&&v.shift()}},init:{value:function(o){if(t!==void 0){t.exit(),t=void 0;let a=document.createElement("canvas");e.replaceWith(a),e=a}let h=Object.assign({},n,o),l=this.echo.bind(this);t=new Processing(e,a=>{D.info("Processing.js created"),D.debug(`canvas width (${e.width}) height (${e.height})`),Object.defineProperties(a,{keyPressed:{value:function p(){switch(console.log(a.I,a.V),a.keyCode){case a.UP:a.loop();break;case a.DOWN:a.noLoop();break;case a.LEFT:switch(p.mode){case a.I:a.save("image.png");break;case a.v:u&&s.on("finished",function(m){window.open(URL.createObjectURL(m))}),u=!u;break}break;case a.RIGHT:a.redraw();break;case a.i:p.mode=a.I,l("Image capture mode");break;case a.V:p.mode=a.V,l("Video capture mode");break}},writable:!0},setup:{value:function(){a.size(h.width,h.height,a[h.renderer]),D.debug(`processingjs width (${a.width}) height (${a.height}) ${a.use3DContext}`),a.frameRate(h.frameRate),a.noLoop(),a.background(h.background),c=h.showFrameRate,r=h.showRuler,D.info("Processing.js setup")},writable:!0}})}),Object.setPrototypeOf(this,t)}},input:{set:function(o){D.debug("keyPressed set"),Object.defineProperty(t,"keyPressed",{value:o,writable:!0})}},pixelHeight:{get:function(){return 0}},pixelWidth:{get:function(){return 0}}}),this.init()}Me.exports={DoubleBuffer:oe,Image:se,Renderer:H}});var Ce=(re(),me(ne)).default,C=ke(),Je=Oe(),{Renderer:Ke}=Ie();Ce.setLogLevel("debug");var Fe=new Ce("rod.js"),M;window.addEventListener("load",()=>{Fe.info("Creating renderer");let e=document.querySelector("canvas"),n=e.getBoundingClientRect();e.width=n.width,e.height=n.height,Fe.debug(`initial canvas width (${e.width}) height (${e.height})`),M=Ke(e),Qe.apply(M)});function Qe(){let e=M.width,n=M.height,t=e/2,c=n/2,r=e/2+C.range(-100,100.01),d=e/2+C.range(-100,100.01),s=C.roll(-3.01,3),u=C.roll(-3.01,3),w,y,v=20,o=12,h=5,l=200,a=3,p=5e-4,m=100,f=40,i=.75,g=.5,x=3,b=.66,_=new Je(M,function(P){let L={x:0,y:0},I={x:0,y:0},E={x:0,y:0},N={x:0,y:0},A=0,R=0,S=P.list,k=S;for(;k.active;){if(k===this){if(k=k.next,k===S)break;continue}let F=Math.hypot(this.x-k.x,this.y-k.y);if(F<m&&(L.x+=k.dx,L.y+=k.dy,I.x+=k.x,I.y+=k.y,A++),F<f){let U=(f-F)/f;E.x+=(this.x-k.x)*U,E.y+=(this.y-k.y)*U,R++}if(k=k.next,k===S)break}if(w+=this.x,y+=this.y,A>0){L.x/=A,L.y/=A;let F=Math.hypot(L.x,L.y);F>0&&(L.x=L.x/F*p*i,L.y=L.y/F*p*i),I.x=(I.x/A-this.x)*p*g,I.y=(I.y/A-this.y)*p*g}if(R>0){E.x/=R,E.y/=R;let F=Math.hypot(E.x,E.y);F>0&&(E.x=E.x/F*p*x,E.y=E.y/F*p*x)}if(Math.random()>b){let F=Math.atan2(this.dy,this.dx)+C.range(-.1,.1),U=Math.hypot(this.dx,this.dy);N.x=U*Math.cos(F)-this.dx,N.y=U*Math.sin(F)-this.dy}this.ddx=L.x+I.x+E.x+N.x+(r-this.x)*1e-4,this.ddy=L.y+I.y+E.y+N.y+(d-this.y)*1e-4,C.distance(this.x,this.y,r,d)<50&&(this.ddx+=(r-this.x)*.01,this.ddy+=(d-this.y)*.01),this.dx+=this.ddx,this.dy+=this.ddy;let Y=Math.hypot(this.dx,this.dy);Y>a&&(this.dx=this.dx/Y*a,this.dy=this.dy/Y*a),this.x+=this.dx,this.y+=this.dy;let ae=C.direction(this.x,this.y,this.x-this.dx,this.y-this.dy),B=Math.cos(ae),V=Math.sin(ae),he=.33*o,le=.66*o,J=he*B,K=he*V,Q=le*B,Z=le*V,fe=this.x+o*B,ue=this.y+o*V;this.unique??=C.roll(Math.PI/2);let ce=Math.PI/h*M.frameCount+this.unique,X=Math.cos(ce),q=Math.sin(ce),Te=this.x+J+.5*(J*-q-K*X),Ne=this.y+K+.5*(J*X+K*-q),Ae=this.x+Q+.5*(Q*X-Z*q),Re=this.y+Z+.5*(Q*q+Z*X),de=this.x-fe,ge=this.y-ue,pe=Math.hypot(de,ge),Se=-ge/pe,De=de/pe,ve=q*3,We=fe+Se*ve,qe=ue+De*ve;M.bezier(this.x,this.y,Te,Ne,Ae,Re,We,qe),this.x>=e-1?(this.x=e-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=n-1?(this.y=n-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1)},function(P){P.stroke(this.r,this.g,this.b,this.a),P.ellipse(this.x,this.y,2,2)}),O=C.range(0,2*Math.PI);for(let P=0;P<l;++P){let L=C.range(.001,1)*a,I=C.range(-.1,.1);_.createParticle(0,C.range(t-10.01,t+10),C.range(c-10.01,c+10),L*Math.cos(I+O),L*Math.sin(I+O),255,255,255,255)}M.frame=function(){w=0,y=0,M.background(0),M.fill(0,0,0,0),M.stroke(255,255,255,255),_.render(),w/=_.count,y/=_.count,s+=-(w-r)*1e-4+(t-r)*1e-4,u+=-(y-d)*1e-4+(c-d)*1e-4;let P=Math.hypot(s,u);P>a*1.4&&(s=s/P*a*1.4,u=u/P*a*1.4),r+=s,d+=u,r<0&&(r=0,s=-s),r>e-v&&(r=e-v,s=-s),d<0&&(d=0,u=-u),d>n-v&&(d=n-v,u=-u),M.stroke(196,128,196),M.fill(255,128,164,128),M.ellipse(r,d,v,v)},M.loop()}})();
