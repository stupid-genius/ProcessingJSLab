(()=>{var dt=Object.defineProperty;var ce=Object.getOwnPropertyDescriptor;var he=Object.getOwnPropertyNames;var de=Object.prototype.hasOwnProperty;var le=(t,e)=>()=>(t&&(e=t(t=0)),e);var j=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),ue=(t,e)=>{for(var i in e)dt(t,i,{get:e[i],enumerable:!0})},fe=(t,e,i,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of he(e))!de.call(t,r)&&r!==i&&dt(t,r,{get:()=>e[r],enumerable:!(s=ce(e,r))||s.enumerable});return t};var z=t=>fe(dt({},"__esModule",{value:!0}),t);var U={};ue(U,{APITransport:()=>$t,ConsoleTransport:()=>lt,FileTransport:()=>Ht,default:()=>$,interpolate:()=>qt});function $(t){if(t===void 0)throw new Error("Logger requires the file name of where it's being used.");if(!new.target)return new $(...arguments);Object.defineProperties(this,{log:{value:function(e,i,s){W.indexOf(e)<=W.indexOf($.state.currentLevel)&&Object.values($.state.transports).forEach(r=>{queueMicrotask(()=>r.log({level:e,msg:i,category:t,...s}))})}}}),W.forEach(e=>{let i;e==="noop"?i=()=>{}:i=this.log.bind(this,e),Object.defineProperty(this,e,{value:i})})}function lt(t){if(!new.target)return new lt(...arguments);Object.defineProperty(this,"log",{value:function(e){let i=Object.assign({},t,e);if(i.isTable)console.table(i.msg,i.args);else if(i.group)console[i.group](i.msg);else{let[s,r]=i.style?.length===2?i.style:["font-weight: bold; color: green;","font-style: italic;"];console[i.level](`%c${i.timestamp||new Date().toLocaleTimeString("en-US",i.dateFmt)}%c %c[${i.category}]%c ${i.msg}`,s,"",r,"",...i.args||[])}}})}function Ht(t){if(window.showSaveFilePicker===void 0){let e="FileTransport requires the File System Access API";throw console.warn(e),new Error(e)}if(!new.target)return new Ht(...arguments);Object.defineProperty(this,"initialize",{value:async function(){try{let e=await window.showSaveFilePicker({types:[{description:"Log Files",accept:{"text/plain":[".log"]}}]});Object.defineProperty(this,"log",{value:async function(i){let s=Object.assign({},t,i),r;try{r=await e.createWritable({keepExistingData:!0}),await r.write(`${s.timestamp||new Date().toLocaleTimeString("en-US",s.dateFmt)} [${s.category}] ${s.level}: ${s.msg}
`)}catch(n){console.error(n)}finally{await r.close()}}})}catch(e){console.error(e)}}})}function $t(t){if(!new.target)return new $t(...arguments);Object.defineProperty(this,"log",{value:async function(e){let i=qt(t,e);try{let s=await fetch(i.url,{method:i.method,headers:Object.entries(i.headers||{}).reduce((r,[n,o])=>(r[n]=o,r),{}),body:i.body});console.debug(s)}catch(s){console.error(s)}}})}var W,qt,Y=le(()=>{W=["noop","error","warn","info","debug","silly"];Object.defineProperties($,{addTransport:{value:(t,e)=>{$.state.transports[t]=e}},state:{value:{currentLevel:"noop",transports:{}}},level:{get:()=>$.state.currentLevel},removeTransport:{value:t=>{delete $.state.transports[t]}},setLogLevel:{value:t=>{if(W.some(e=>e===t))$.state.currentLevel=t;else throw new Error(`${t} is not a valid logger level`)}}});$.addTransport("default",lt({}));W.reduce((t,e)=>(Object.defineProperty(t,e.toUpperCase(),{enumerable:!0,get:()=>e}),t),$);qt=function t(e,i){if(e instanceof Object){let s=Array.isArray(e)?[]:{};for(let r in e){let n=t(e[r],i);try{s[r]=JSON.parse(n)}catch{n!==void 0&&n!==""&&(s[r]=n)}}return s}return typeof e!="string"?e:e.replace(/\{\{(.+?)}}/g,(s,r)=>{let n=i[r]||"";return n instanceof Object?JSON.stringify(n):n})}});var jt=j((Ae,_t)=>{var ut;typeof window>"u"?ut=(Y(),z(U)):ut=(Y(),z(U)).default;var pe=new ut("getopt.js"),Dt=function(t){pe.warn(t)};function y(t,e){typeof y.place>"u"&&(y.place="",y.iplace=0);let i;if(y.optreset>0||y.iplace===y.place.length){if(y.optreset=0,y.place=t[y.optind],y.iplace=0,y.optind>=t.length||y.place.charAt(y.iplace++)!=="-")return y.place="",y.iplace=0,"";if(y.optopt=y.place.charAt(y.iplace++),y.optopt==="-"&&y.iplace===y.place.length)return++y.optind,y.getopt.place="",y.getopt.iplace=0,"";if(y.optopt===0){if(y.place="",y.iplace=0,e.indexOf("-")===-1)return"";y.optopt="-"}}else y.optopt=y.place.charAt(y.iplace++);if(y.optopt===":"||(i=e.indexOf(y.optopt))===-1)return y.iplace===y.place.length&&++y.optind,y.opterr&&e.charAt(0)!==":"&&Dt("illegal option -- "+y.optopt),"?";if(e.charAt(i+1)!==":")y.optarg=null,y.iplace===y.place.length&&++y.optind;else{if(y.iplace<y.place.length)y.optarg=y.place.substr(y.iplace);else if(t.length>++y.optind)y.optarg=t[y.optind];else return y.place="",y.iplace=0,e.charAt(0)===":"?":":y.opterr?(Dt("option requires an argument -- "+y.optopt),":"):"?";y.place="",y.iplace=0,++y.optind}return y.optopt}y.opterr=1;y.optind=0;y.optopt="";y.optreset=0;y.optarg="";_t.exports=y});var ft=j((Oe,Ft)=>{var q=jt();function P(t,e,i){if(typeof e=="function")return function(){return e.apply(this,arguments)||P.OK};let s=this;s.echo===void 0&&(s.echo=t.info);let r=[],n=/"([^"]*)"|'([^']*)'|\S+/g,o=async function(a){t.info(`Executing: ${a}`);let d=a.match(n).map(u=>u.replace(/^['"]|['"]$/g,"")),h=d.shift(),l=e[h];if(l===void 0){if(r.includes(h))try{let u=JSON.stringify(await i(a));return t.debug(`RPC Response: ${u}`),s.echo(u),P.OK}catch(u){return s.echo(u),P.ECMDERR}return s.echo(`${h}: no such command`),P.ENOTFOUND}let{func:g,opts:p,usage:w}=l,f=p;if(w&&(f=f?`${f}h`:"h"),f!==void 0){t.debug(`Parsing options: ${f} with ${d}`);let u={},m;for(q.optreset=1,q.optind=0;(m=q(d,f))!=="";)switch(t.debug(`Opt: ${m}, optarg: ${q.optarg}, optind: ${q.optind}`),m){case"h":return s.echo(`Usage: ${w}`),P.OK;case":":return s.echo(`${q.optopt}: option needs a value`),P.EBADARGS;case"?":return s.echo(`${q.optopt}: no such option`),P.EBADARGS;default:t.debug(`Switch: ${m}, optarg: ${q.optarg}`),u[m]=q.optarg||!0}g.opts=u,t.debug(`Switches: ${JSON.stringify(u)}`)}else q.optind=0;return t.debug(`Terms: ${d}`),await g.apply(this,d.slice(q.optind))??P.OK};return i!==void 0&&queueMicrotask(async function(){let a=await i("system.describe");t.debug(`system.describe result: ${a}`),JSON.parse(a).procs.forEach(d=>r.push(d)),e.help.rpcList=r,t.debug(`RPC List: ${r}`),Object.defineProperties(o,{login:{value:async function(d,h){t.info(`Attempting to log in user ${d}`);try{let l=await i(`login ${d} ${h}`);if(l===!1)return s.echo("Login failed"),P.NOTOKEN;let g=i;return o.exit??Object.defineProperty(o,"exit",{value:async function(){t.info("Logging out"),i=g,s.authState=P.NOTOKEN,s.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!0}}))}}),i=new Proxy(i,{apply:function(p,w,f){return p(f[0],l)}}),P.OK}catch(l){return t.error(l),l}}}})}),o}var V=0;Object.defineProperties(P,{OK:{value:V++},ENOTFOUND:{value:V++},ECMDERR:{value:V++},EBADARGS:{value:V++},NOTOKEN:{value:V++}});function ge(t,e){let i=0;return function(s,r){try{t.info(`Executing RPC: ${s}`);let n=s.trim().split(/\s+/),o=n.shift(),a=n;r&&(a={token:r,params:a}),t.debug(`Method: ${o}, params: ${a}`);try{return e.jsonrpc({id:i++,method:o,params:a}).then(d=>{let h=JSON.parse(d);if(t.debug(`Response: ${JSON.stringify(h)}`),h.error)throw new Error(h.error.message);return h.result})}catch(d){return t.error(d),d}}catch(n){return t.error(n),n}}}Ft.exports={JSONRPCClient:ge,Executor:P}});var Xt=j(()=>{var{Executor:F}=ft(),pt=(Y(),z(U)).default,E=new pt("Terminal.js"),ye=100,xe=1e3,gt=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.parentTerminal=null,this.commandHistory=[],this.historyIndex=-1;let e=localStorage.getItem("commandHistory");e&&(this.commandHistory=JSON.parse(e),E.debug(`Loading command history (${this.commandHistory.length} items)`),this.historyIndex=this.commandHistory.length),this.inputHandler=this.inputHandler.bind(this),this.reset=this.reset.bind(this),this.addEventListener("terminal-reset",this.reset);let i=function(){E.debug("DOMContentLoaded event fired"),this.reset(new CustomEvent("terminal-reset",{detail:{clear:!0}})),document.removeEventListener("DOMContentLoaded",i)}.bind(this);document.addEventListener("DOMContentLoaded",i)}connectedCallback(){E.debug("Terminal connected")}disconnectedCallback(){E.debug("Terminal disconnected"),this.inputLine.removeEventListener("keydown",this.inputHandler),this.removeEventListener("click",this.focusHandler)}reset(e){if(E.debug(`Terminal reset (${this.parentTerminal?"sub-terminal":"main terminal"})`),E.debug(`Auth state: ${this.authState}, RPC enabled: ${this.rpcEnabled}`),this.rpcEnabled&&this.authState!==F.OK)E.debug("logging in"),this.loginModal();else{let i=e.detail?.clear??!1;E.debug(`reset ${i?"and clear ":""}terminal`),this.uiModal(i)}this.focusHandler=function(){this.inputLine.focus()}.bind(this),this.addEventListener("click",this.focusHandler),this.focusHandler()}applyStyles(){let e=this.querySelector("style").cloneNode(!0);this.shadowRoot.appendChild(e)}loginModal(){this.shadowRoot.innerHTML="",this.applyStyles();let e=this.querySelector("template#login").content.cloneNode(!0);this.shadowRoot.appendChild(e),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.output=this.shadowRoot.querySelector(".output"),this.echo("Please log in");let i,s,r=async n=>{if(n.key==="Enter"){n.preventDefault();let o=(this.inputLine.value??this.inputLine.textContent).trim();if(i===void 0?i=o:s=o,i&&s)try{if(this.authState=await this.executor.login(i,s),E.debug(`Login state: ${this.authState}`),this.authState===F.NOTOKEN){this.loginModal(),this.focusHandler();return}this.inputLine.removeEventListener("keydown",r),this.removeEventListener("click",this.focusHandler),this.reset(new CustomEvent("terminal-reset",{detail:{clear:!0}}))}catch(a){this.echo(a),E.error(a)}else{E.debug(`awaiting password for ${i}`);let a=document.createElement("input");a.type="password",a.classList.add("input-line"),this.inputLine.textContent=this.inputLine.value="",this.inputLine.removeEventListener("keydown",r),this.removeEventListener("click",this.focusHandler),this.inputLine.replaceWith(a),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.prompt="password:",this.inputLine.addEventListener("keydown",r),this.addEventListener("click",this.focusHandler),this.focusHandler()}}};this.inputLine.addEventListener("keydown",r)}uiModal(e){let i=this.shadowRoot.querySelector(".output")?.innerHTML;this.shadowRoot.innerHTML="",this.applyStyles();let s=this.querySelector("template#ui").content.cloneNode(!0);this.shadowRoot.appendChild(s),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.output=this.shadowRoot.querySelector(".output"),e&&this.greeting?(E.debug("clearing terminal"),this.echo(this.greeting)):this.output.innerHTML=i??"",this.inputLine.addEventListener("keydown",this.inputHandler),this.inputLine.focus()}get executor(){return this._executor}set executor(e){E.info("Setting executor"),this._executor=e}get greeting(){return this.getAttribute("greeting")}set greeting(e){e===void 0?this.removeAttribute("greeting"):this.setAttribute("greeting",e)}get prompt(){return this.shadowRoot.querySelector(".prompt").textContent}set prompt(e){let i=this.shadowRoot.querySelector(".prompt");i.innerHTML=`${e}&nbsp;`}get rpcEnabled(){return this.getAttribute("rpc")==="true"}inputHandler(e){switch(e.key){case"Enter":{e.preventDefault();let i=this.inputLine.textContent.trim();this.inputLine.textContent="",this.echo(`${this.prompt}${i}`),this.processCommand(i),this.historyIndex=this.commandHistory.length;break}case"ArrowUp":E.debug(`History index (back): ${this.historyIndex}`),this.historyIndex>0&&(this.historyIndex-=1,this.inputLine.textContent=this.commandHistory[this.historyIndex]);break;case"ArrowDown":E.debug(`History index (forward): ${this.historyIndex}`),this.historyIndex<this.commandHistory.length-1?(this.historyIndex+=1,this.inputLine.textContent=this.commandHistory[this.historyIndex]):(this.historyIndex=this.commandHistory.length,this.inputLine.textContent="");break}}async processCommand(e){try{let i=await this.executor(e);switch(E.debug(`Status: ${i}`),i){case F.OK:E.debug(`${e} executed successfully`),e!==this.commandHistory[this.commandHistory.length-1]&&(this.commandHistory.push(e),this.commandHistory.length>ye&&this.commandHistory.shift(),localStorage.setItem("commandHistory",JSON.stringify(this.commandHistory)));break;case F.ENOTFOUND:E.info(`${e} not found`);break;case F.ECMDERR:E.error(`Error executing ${e}`);break;case F.EBADARGS:E.warn(`${e} called with bad arguments`);break;default:E.error(`Unknown status: ${i} for ${e}`);break}}catch(i){E.error(i),this.echo(i)}}clear(){this.output.innerHTML=""}echo(e){for(e!=null&&e!==""&&(this.output.innerHTML+=`<div>${e}</div>`);this.output.children.length>xe;)this.output.removeChild(this.output.firstChild);this.inputLine.getBoundingClientRect().bottom>window.innerHeight&&this.inputLine.scrollIntoView({behavior:"smooth"})}log(e){pt.level==="debug"&&(typeof e=="string"?console.info(e):console.dir(e))}startSubTerminal(e){E.info(`Starting sub-terminal: ${e.name}`),this.removeEventListener("terminal-reset",this.reset);let i=new pt(`Executor.js (${e.name})`),s=document.createElement("ng-terminal");return s.innerHTML=this.innerHTML,s.greeting=e.greeting,s.executor=F.bind(s)(i,e.registry),s.parentTerminal=this,this.replaceWith(s),s.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!0}})),e.prompt!==void 0&&(s.prompt=e.prompt),s}exitSubTerminal(){this.parentTerminal?(E.info("Exiting sub-terminal"),E.debug(`Parent terminal: ${JSON.stringify(this.parentTerminal)}`),this.parentTerminal.addEventListener("terminal-reset",this.parentTerminal.reset),this.replaceWith(this.parentTerminal),this.parentTerminal.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!1}}))):E.warn("No parent terminal found")}};customElements.define("ng-terminal",gt)});var tt=j((Ce,Ut)=>{var me=(Y(),z(U)).default,B=new me("Renderer.js");function yt(t,e){if(!new.target)return new yt(...arguments);let i=t.pixels.toArray(),s=i.length,r=new Proxy(t,{get:function(n,o,a){if(typeof o=="string"&&!isNaN(o)){let d=+o;if(Number.isInteger(d)&&d>=0&&d<s)return i[d]}else return Reflect.get(n,o,a)},set:function(n,o,a,d){if(typeof o=="string"&&!isNaN(o)){let h=+o;Number.isInteger(h)&&h>=0&&h<s&&(i[h]=Array.isArray(a)?e.color.apply(this,a):a)}else return Reflect.set(n,o,a,d)}});return t.loaded=!0,Object.defineProperties(r,{blit:{value:function(n,o){t.pixels.set(i),e.image(t,n,o)}},length:{value:i.length},update:{value:function(){t.pixels.set(i)}}}),r}function xt(t){if(!new.target)return new xt(...arguments);let e=0,i=[];Object.defineProperties(i,{flip:{value:function(){e^=1}},read:{get:function(){return this[e^1]}},write:{get:function(){return this[e]}}});let s=t.createImage();i.push({buffer:s,get pixels(){return s.pixels.toArray()}});let r=t.createImage();i.push({buffer:r,get pixels(){return r.pixels.toArray()}}),Object.defineProperties(this,{flip:{value:function(){let o=i.write.buffer;o.update(),t.background(o),i.flip()}},readBuffer:{get:function(){return i.read.pixels}},writeBuffer:{get:function(){return i.write.buffer}}})}function Q(t){if(Q.instance!==void 0)return Q.instance;if(!new.target)return new Q(...arguments);let e={background:4278849802,frameRate:60,height:t.height,width:t.width},i;Object.defineProperties(this,{createImage:{value:function(r,n){let o=i.createImage(r??t.width,n??t.height);return new yt(o,i)}},frame:{set:function(r){B.debug("pjs.draw set"),Object.defineProperty(i,"draw",{value:r,writable:!0})}},doubleBuffer:{value:function(){return new xt(this)}},init:{value:function(r){i!==void 0&&i.exit();let n=Object.assign({},e,r);i=new Processing(t,o=>{B.info("Processing.js created"),B.debug(`canvas width (${t.width}) height (${t.height})`),Object.defineProperties(o,{keyPressed:{value:function(){switch(o.keyCode){case o.UP:o.loop();break;case o.DOWN:o.noLoop();break;case o.LEFT:o.save("image.png");break;case o.RIGHT:o.redraw()}},writable:!0},setup:{value:function(){o.size(n.width,n.height),B.debug(`processingjs width (${o.width}) height (${o.height}) ${o.use3DContext}`),o.frameRate(n.frameRate),o.noLoop(),o.background(n.background),B.info("Processing.js setup")}}})})}},input:{set:function(r){B.debug("keyPressed set"),Object.defineProperty(i,"keyPressed",{value:r,writable:!0})}},pixelHeight:{get:function(){return 0}},pixelWidth:{get:function(){return 0}},showFrameRate:{value:function(){}},showRuler:{set:function(){}}}),this.init();let s=new Proxy(this,{get:function(r,n){return r[n]??i[n]}});return Object.defineProperty(Q,"instance",{value:s}),s}Ut.exports={DoubleBuffer:xt,Image:yt,Renderer:Q}});var Bt=j((Se,Yt)=>{function G(){if(G.instance instanceof G)return G.instance;if(!new.target)return new G(...arguments);Object.defineProperty(G,"instance",{value:this});let t=Math.PI/180;Object.defineProperties(this,{cos:{value:{},enumerable:!0},sin:{value:{},enumerable:!0}});for(let e=0;e<=360;++e)Object.defineProperty(this.cos,e,{value:Math.cos(e*t)}),Object.defineProperty(this.sin,e,{value:Math.sin(e*t)})}var mt=Object.freeze({addColors:(...t)=>t.length===0?[]:t[0].map((e,i)=>t.reduce((s,r)=>s+r[i],0)),decodeColor:t=>[t>>16&255,t>>8&255,t&255,t>>>24],direction:(t,e,i,s)=>Math.atan2(s-e,i-t),distance:(t,e,i,s)=>Math.hypot(Math.abs(i-t),Math.abs(s-e)),fastInvSqrt:t=>{let i=new Float32Array([t]),s=new Float32Array([t]),r=new Int32Array(i.buffer);return r[0]=1597463007-(r[0]>>1),s[0]=i[0],s[0]=s[0]*(1.5-t*.5*s[0]*s[0]),s[0]},fastTrig:G(),invSqrt:t=>1/Math.sqrt(t),randomColor:(t=!1)=>{let e=Array.from({length:3},()=>mt.roll(255));return e.push(t?mt.roll(255):255),e},range:(t,e)=>{let i=Math.random()*(e-t);return Number.isInteger(t)&&Number.isInteger(e)&&(i=Math.floor(i)),i+t},roll:t=>Math.floor(Math.random()*t)});Yt.exports=mt});var Kt=j((Ne,Jt)=>{function Gt(t,e){if(!new.target)return new Gt(...arguments);let i=2,s=new r;s.next=new r,s.prev=s.next,s.prev.next=s,s.prev.prev=s,s.active=!1,s.prev.active=!1,this.ACCELERATION=[0,.25],this.ELASTICITY=.2,this.SHAPE="point",this.MAX_COUNT=3e3,Object.defineProperties(this,{count:{get:function(){return i}},createParticle:{value:function(n,o,a,d,h,l,g,p,w){if(s.prev.active){if(i>=this.MAX_COUNT)return;let f=new r(n,o,a,d,h,l,g,p,w);f.next=s,f.prev=s.prev,f.prev.next=f,s.prev=f,s=f,++i}else{let f=s.prev;f.activate(n,o,a,d,h,l,g,p,w),s=f}}},list:{get:function(){return s}},render:{value:function(){let n=s;for(;n.active;){e.call(n,this),t.stroke(n.r,n.g,n.b,n.a),t[this.SHAPE](n.x,n.y,2,2);let o=n;if(n.ttl>0&&++n.t>=n.ttl&&(n.active=!1),n=n.next,n===s)break;o.active||(o===s?s=o.next:(o.next.prev=o.prev,o.prev.next=o.next,o.next=s,o.prev=s.prev,s.prev.next=o,s.prev=o))}}}});function r(n,o,a,d,h,l,g,p,w){if(!new.target)return new r(...arguments);Object.defineProperties(this,{activate:{value:function(f,u,m,b,T,L,C,I,k){this.active=!0,this.ttl=f,this.t=0,this.x=u,this.y=m,this.dx=b,this.dy=T,this.ddx=0,this.ddy=0,this.dddx=0,this.dddy=0,this.r=L,this.g=C,this.b=I,this.a=k}}}),this.activate(n,o,a,d,h,l,g,p,w)}}Jt.exports=Gt});var Vt=j((Ie,Wt)=>{var x=Bt(),H=Kt(),c=tt().Renderer();function zt(t,e,i,s){let r=s%t,n=Math.floor(s/t),o=i,a=Math.floor(r/e)%2==0,d=Math.floor(n/e)%2==0;return a!=d&&(o=0),[o,o,o,255]}var we={ants:function(){let t=c.width,e=c.height,i=200,s=1,r=new H(c,function(n){let o=n.list,a=o;for(;a.active;){if(a===this){if(a=a.next,a===o)break;continue}if(a=a.next,a===o)break}this.ddx=x.range(-1.01,1),this.ddy=x.range(-1.01,1),this.dx+=this.ddx,this.dy+=this.ddy;let d=Math.hypot(this.dx,this.dy);d>s&&(this.dx=this.dx/d*s,this.dy=this.dy/d*s);let h=this.x-3*this.dx,l=this.y-3*this.dy;this.x+=this.dx,this.y+=this.dy,c.line(this.x,this.y,h,l),this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-1?(this.y=e-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1)});for(let n=0;n<i;++n)r.createParticle(0,x.range(1e-4,t),x.range(1e-4,e),0,0,207,16,32);c.stroke(0,0,0,255),c.frame=function(){c.background(0),r.render()},c.loop()},boids:function(){let t=c.width,e=c.height,i=t/2,s=e/2,r=200,n=3,o=5e-4,a=100,d=40,h=1,l=1.25,g=1,p=.75,w=new H(c,function(u){let m=0,b=0,T=0,L=0,C=0,I=0,k=0,J=0,S=0,A=0,N=u.list,v=N;for(;v.active;){if(v===this){if(v=v.next,v===N)break;continue}let O=Math.hypot(this.x-v.x,this.y-v.y);if(O<a&&(m+=v.dx,b+=v.dy,T+=v.x,L+=v.y,S++),O<d){let M=(d-O)/d;C+=(this.x-v.x)*M,I+=(this.y-v.y)*M,A++}if(v=v.next,v===N)break}if(S>0){m/=S,b/=S;let O=Math.hypot(m,b);O>0&&(m=m/O*o*h,b=b/O*o*h),T=(T/S-this.x)*o*l,L=(L/S-this.y)*o*l}if(A>0){C/=A,I/=A;let O=Math.hypot(C,I);O>0&&(C=C/O*o*g,I=I/O*o*g)}if(Math.random()>p){let O=Math.atan2(this.dy,this.dx)+x.range(-.1,.1),M=Math.hypot(this.dx,this.dy);k=M*Math.cos(O)-this.dx,J=M*Math.sin(O)-this.dy}this.ddx=m+T+C+k,this.ddy=b+L+I+J,this.dx+=this.ddx,this.dy+=this.ddy;let D=Math.hypot(this.dx,this.dy);D>n&&(this.dx=this.dx/D*n,this.dy=this.dy/D*n);let _=this.x-3*this.dx,X=this.y-3*this.dy;this.x+=this.dx,this.y+=this.dy,c.line(this.x,this.y,_,X),this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-1?(this.y=e-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1)}),f=x.range(0,2*Math.PI);for(let u=0;u<r;++u){let m=x.range(.001,1)*n,b=x.range(-.1,.1);w.createParticle(0,x.range(i-10.01,i+10),x.range(s-10.01,s+10),m*Math.cos(b+f),m*Math.sin(b+f),...x.randomColor())}c.stroke(0,0,0,255),c.frame=function(){c.background(0),w.render()},c.loop()},bz:function(){let t=c.width,e=Array.from({length:8},()=>Math.random()*t),i=Array.from({length:8},()=>Math.random()*t),s=Array.from({length:8},()=>Math.random()*15);c.background(255),c.noFill(),c.frame=function(){c.stroke(0,0,0,20),e.map(function(r,n,o){let a=r+s[n];a<0?(a=0,s[n]*=-1):a>t&&(a=t,s[n]*=-1),o[n]=a}),c.bezier.apply(null,e),c.stroke(255,128,128,20),i.map(function(r,n,o){let a=r+s[n];a<0?(a=0,s[n]*=-1):a>t&&(a=t,s[n]*=-1),o[n]=a}),c.bezier.apply(null,i)},c.loop()},cell:function(t=30,e=!1,i=200,s=200){c.init({background:0,frameRate:400,height:+s,width:+i});let r=c.width,n=c.height,o=1,a=0,d=new Array(r*n).fill(a),h=(p=>{let w=p.toString(2).padStart(8,"0"),f=[];for(let u=0;u<8;++u)+w[7-u]&&f.push(u);return(u,m)=>{let b=(m-1)*r+u,T=parseInt([d[b-1],d[b],d[b+1]].join(""),2);return f.some(L=>T===L)?o:a}})(+t);if(c.stroke(255),e&&e!=="false")for(let p=0;p<r;++p)d[p]=Math.random()>.5?o:a,c.point(p,0);else d[r/2]=o,c.point(r/2,0);let l=0,g=d.length/r;c.frame=function(){for(let p=0;p<r;++p){let w=h(p,l);w&&(d[l*r+p]=w,c.point(p,l))}l!==g&&l++},c.loop()},chaos:function(t="3"){c.init({frameRate:400});let e=c.width,i=c.height,s=e/2,r=i/2,n=s-50,o=Math.PI/180,a={3:[{x:e/2,y:50},{x:50,y:i-50},{x:e-50,y:i-50}],5:[{x:e-50,y:50},{x:50,y:50},{x:50,y:i-50},{x:e-50,y:i-50},{x:s,y:r}],6:[{x:Math.cos(0)*n+s,y:Math.sin(0)*n+r},{x:Math.cos(60*o)*n+s,y:Math.sin(60*o)*n+r},{x:Math.cos(120*o)*n+s,y:Math.sin(120*o)*n+r},{x:Math.cos(180*o)*n+s,y:Math.sin(180*o)*n+r},{x:Math.cos(240*o)*n+s,y:Math.sin(240*o)*n+r},{x:Math.cos(300*o)*n+s,y:Math.sin(300*o)*n+r}]}[t],d={3:2,5:1.5,6:1.5}[t];c.background(0),c.stroke(255,255,255,255);for(let{x:g,y:p}of a)c.point(g,p);let h=Math.random()*e,l=Math.random()*i;c.frame=function(){let g=x.roll(a.length);h+=(a[g].x-h)/d,l+=(a[g].y-l)/d,c.point(h,l)},c.loop()},fire:function(){c.init({background:0,frameRate:60,height:300,width:300});let t=c.width,e=c.doubleBuffer(),i=e.writeBuffer;for(let n=0;n<i.length;++n)i[n]=[0,0,0,255];e.flip(),i=e.writeBuffer;for(let n=0;n<i.length;++n)i[n]=[0,0,0,255];e.flip();let s=e.readBuffer.length/t,r=c.color(255,128,96);c.frame=function(){let n=e.readBuffer,o=e.writeBuffer;for(let a=t;a<o.length-t;++a){if(a%t<1||a%t>=t-1)continue;let d=a/t;if(Math.random()<Math.pow(Math.E,Math.pow(d/s,4))-1&&Math.random()>.975){o[a]=r;continue}o[a]=x.addColors(x.decodeColor(n[a-1]),x.decodeColor(n[a]),x.decodeColor(n[a+1]),x.decodeColor(n[a+t])).map((h,l)=>{if(l===3)return 255;let g=h/4.25;return g<10?0:g})}e.flip()},c.loop()},fireworks:function(){let t=c.width,e=c.height,i=new H(c,function(){this.dx+=i.ACCELERATION[0],this.dy+=i.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let h=1-this.t/this.ttl;this.r=255*Math.pow(h,.2),this.g=255*h*h,this.b=255*h*h*h*h,this.a=255*h}),s=new H(c,function(){this.dx+=s.ACCELERATION[0],this.dy+=s.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let h=1-this.t/this.ttl;this.b=255*Math.pow(h,.2),this.g=255*h*h,this.r=255*h*h*h*h,this.a=255*h}),r=new H(c,function(){this.dx+=r.ACCELERATION[0],this.dy+=r.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let h=1-this.t/this.ttl;this.g=255*Math.pow(h,.2),this.r=255*h*h,this.b=255*h*h*h*h,this.a=255*h}),n=new H(c,function(){this.dx+=n.ACCELERATION[0],this.dy+=n.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let h=1-this.t/this.ttl;this.r=255*Math.pow(h,.2),this.g=255*Math.pow(h,.2),this.b=255*h*h*h*h,this.a=255*h}),o=new H(c,function(){this.dx+=o.ACCELERATION[0],this.dy+=o.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let h=1-this.t/this.ttl;this.r=255*Math.pow(h,.2),this.b=255*h*h*h*h,this.g=255*h,this.a=255*h}),a=new H(c,function(){this.dx+=a.ACCELERATION[0],this.dy+=a.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let h=1-this.t/this.ttl;this.r=255*Math.pow(h,.2),this.b=255*Math.pow(h,.2),this.g=255*h*h*h*h,this.a=255*h});i.ACCELERATION=[0,.15],s.ACCELERATION=[0,.15],r.ACCELERATION=[0,.15],n.ACCELERATION=[0,.15],o.ACCELERATION=[0,.15],a.ACCELERATION=[0,.15];function d(h,l){let g;switch(x.range(0,5)){case 0:g=i;break;case 1:g=s;break;case 2:g=r;break;case 3:g=n;break;case 4:g=a;break;case 5:g=o;break}for(let p=0;p<300;++p){let w=x.range(0,Math.PI*2),f=x.range(.001,10);g.createParticle(x.range(50.001,100),h,l,Math.cos(w)*f,Math.sin(w)*f,0,0,0,0)}}c.frame=function(){c.background(0),Math.random()>.95&&d(x.range(.001,t),x.range(.001,e/2)),i.render(),s.render(),r.render(),n.render(),a.render(),o.render()},c.loop()},fountain:function(){let t=c.width,e=c.height,i=new H(c,function(){this.dx+=i.ACCELERATION[0],this.dy+=i.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let n=1-this.t/this.ttl;this.r=255*Math.pow(n,.2),this.g=255*n*n,this.b=255*n*n*n*n,this.a=255*Math.pow(n,.2),this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-2?(this.dy<.25?this.y=e-1:this.y=e-2,this.dy*=-1.2*Math.random()*i.ELASTICITY,Math.random()<.5?this.dx-=this.dy:this.dx+=this.dy):this.y<0&&(this.y=0,this.dy*=-1*i.ELASTICITY),this.y===e-1&&(this.active=!1)}),s=-20.01,r=[255,255,255,255];c.frame=function(){c.background(0);for(let n=0;n<15;++n){let o=x.range(-.098,.098),a=x.range(s,.8*s);i.createParticle(x.range(10,30.01)*-a,t/2,e-20,Math.sin(o)*a,Math.cos(o)*a,...r)}i.render()},c.loop()},graviton:function(){let t=c.width,e=c.height,i=t/2,s=e/2,r=100,n=10,o=new H(c,function(a){let d=0,h=0,l=a.list,g=l;for(;g.active;){if(g===this){if(g=g.next,g===l)break;continue}if(d+=g.x,h+=g.y,g=g.next,g===l)break}d=(d/o.count-this.x)*1e-4,h=(h/o.count-this.y)*1e-4,this.ddx=d,this.ddy=h,this.dx+=this.ddx,this.dy+=this.ddy;let p=Math.hypot(this.dx,this.dy);p>n&&(this.dx=this.dx/p*n,this.dy=this.dy/p*n),this.x+=this.dx,this.y+=this.dy,this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-1?(this.y=e-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1)});for(let a=0;a<r;++a)o.createParticle(0,x.roll(t),x.roll(e),x.range(-5.01,5),x.range(-5.01,5),255,255,196);c.stroke(0,0,0,255),c.frame=function(){c.background(0),o.render()},c.loop()},lens:function(t=150,e=30){t=+t,e=+e;let i=c.width,s=c.createImage(),r=s.height;for(let u=0;u<s.length;++u)s[u]=zt(r,r/32,255,u);s.update();let n=c.createImage(t,t),o=new Array(t*t).fill(0),a=Math.round(t/2),d=a*a,h=a*(t+1),l;for(let u=0;u<d;++u){let m=u%a,b=Math.floor(u/a),T=m*m,L=b*b,C=0,I=0;if(T+L<d){let k=e/Math.sqrt(e*e-(T+L-d));C=Math.floor(m*k)-m,I=Math.floor(b*k)-b}l=I*i+C,o[h-b*t-m]=-l,o[h+b*t+m]=l,l=-I*i+C,o[h-b*t+m]=l,o[h+b*t-m]=-l}let g=i/2,p=i/2,w=1,f=2;c.frame=function(){g+=w,p+=f,g<0&&(g=0,w=-w),g>i-t&&(g=i-t,w=-w),p<0&&(p=0,f=-f),p>i-t&&(p=i-t,f=-f),c.background(s);let u=p*i+g;for(let m=0;m<t*t;++m)n[m]=s[Math.round(u)+Math.floor(m/t)*i+m%t+o[m]];n.blit(g,p)},c.loop()},life:function(t=300,e=300){c.init({background:0,frameRate:12,height:+e,width:+t});let i=c.width,s=c.height,r=.05,n=0,o=1,a=1,d=0,h=-1,l=Array.from(Array(i*s)).map(()=>Array.from(Array(2)));l.forEach(p=>{p[n]=d,p[o]=Math.random()<r?a:d});function g(p){let w=p%i,f=Math.floor(p/i),u=0;return f>0&&(w>0&&(u+=l[p-i-1][n]),w<i-1&&(u+=l[p-i+1][n]),u+=l[p-i][n]),f<s-1&&(w>0&&(u+=l[p+i-1][n]),w<i-1&&(u+=l[p+i+1][n]),u+=l[p+i][n]),w>0&&(u+=l[p-1][n]),w<i-1&&(u+=l[p+1][n]),u}c.stroke(255),c.frame=function(){c.background(0),l.forEach((p,w)=>{let f=l[w];if(p[o]===a||p[n]===a){f[n]=a;let T=w%i,L=w/i;c.point(T,L)}p[o]===h&&(f[n]=d),f[o]=d;let u=w-3*i;if(u<0)return;let m=l[u],b=g(u);b===3&&m[n]===d&&(m[o]=a),(b<2||b>3)&&m[n]===a&&(m[o]=h)})},c.loop()},pattern:function(){let t=c.createImage(),e=t.height;for(let i=0;i<t.length;++i)t[i]=zt(e,e/8,255,i);t.update(),c.background(t)},plasma:function(){c.init({background:0,height:300,width:300});let t=c.width,e=c.height,i=c.createImage(),s={},r={};function n(f){let u=1-f/255,m=255*u,b=255*u*u;return[255*u*u*u*u,b,m,255]}for(let f=0;f<256;++f)r[f]=n(f);for(let f=0;f<512;++f){let u=f*.703125*.0174532;s[f]=Math.sin(u)*1024}let o=0,a=0,d=0,h=0,l=0,g=0,p=0,w=0;c.frame=function(){p=d,w=h;for(let f=0;f<e;++f){l=o+5,g=a+3,p&=511,w&=511;for(let u=0;u<t;++u){l&=511,g&=511;let b=128+(s[l]+s[g]+s[p]+s[w]>>4);i[f*t+u]=r[b],l+=5,g+=3}p+=1,w+=3}o+=9,d+=8,i.update(),c.background(i)},c.loop()},rod:function(){let t=c.width,e=c.height,i=t/2,s=e/2,r=t/2+x.range(-100,100.01),n=t/2+x.range(-100,100.01),o=x.roll(-3.01,3),a=x.roll(-3.01,3),d,h,l=20,g=12,p=5,w=200,f=3,u=5e-4,m=100,b=40,T=.75,L=.5,C=3,I=.66,k=new H(c,function(S){let A={x:0,y:0},N={x:0,y:0},v={x:0,y:0},D={x:0,y:0},_=0,X=0,O=S.list,M=O;for(;M.active;){if(M===this){if(M=M.next,M===O)break;continue}let R=Math.hypot(this.x-M.x,this.y-M.y);if(R<m&&(A.x+=M.dx,A.y+=M.dy,N.x+=M.x,N.y+=M.y,_++),R<b){let K=(b-R)/b;v.x+=(this.x-M.x)*K,v.y+=(this.y-M.y)*K,X++}if(M=M.next,M===O)break}if(d+=this.x,h+=this.y,_>0){A.x/=_,A.y/=_;let R=Math.hypot(A.x,A.y);R>0&&(A.x=A.x/R*u*T,A.y=A.y/R*u*T),N.x=(N.x/_-this.x)*u*L,N.y=(N.y/_-this.y)*u*L}if(X>0){v.x/=X,v.y/=X;let R=Math.hypot(v.x,v.y);R>0&&(v.x=v.x/R*u*C,v.y=v.y/R*u*C)}if(Math.random()>I){let R=Math.atan2(this.dy,this.dx)+x.range(-.1,.1),K=Math.hypot(this.dx,this.dy);D.x=K*Math.cos(R)-this.dx,D.y=K*Math.sin(R)-this.dy}this.ddx=A.x+N.x+v.x+D.x+(r-this.x)*1e-4,this.ddy=A.y+N.y+v.y+D.y+(n-this.y)*1e-4,x.distance(this.x,this.y,r,n)<50&&(this.ddx+=(r-this.x)*.01,this.ddy+=(n-this.y)*.01),this.dx+=this.ddx,this.dy+=this.ddy;let it=Math.hypot(this.dx,this.dy);it>f&&(this.dx=this.dx/it*f,this.dy=this.dy/it*f),this.x+=this.dx,this.y+=this.dy;let Mt=x.direction(this.x,this.y,this.x-this.dx,this.y-this.dy),nt=Math.cos(Mt),st=Math.sin(Mt),At=.33*g,Ot=.66*g,ot=At*nt,rt=At*st,at=Ot*nt,ct=Ot*st,Tt=this.x+g*nt,Lt=this.y+g*st;this.unique??=x.roll(Math.PI/2);let Ct=Math.PI/p*c.frameCount+this.unique,ht=Math.cos(Ct),Z=Math.sin(Ct),St=-Z,Nt=ht,te=this.x+ot+.5*(ot*St-rt*Nt),ee=this.y+rt+.5*(ot*Nt+rt*St),ie=this.x+at+.5*(at*ht-ct*Z),ne=this.y+ct+.5*(at*Z+ct*ht),It=this.x-Tt,Rt=this.y-Lt,kt=Math.hypot(It,Rt),se=-Rt/kt,oe=It/kt,Pt=Z*3,re=Tt+se*Pt,ae=Lt+oe*Pt;c.bezier(this.x,this.y,te,ee,ie,ne,re,ae),this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-1?(this.y=e-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1)});k.SHAPE="ellipse";let J=x.range(0,2*Math.PI);for(let S=0;S<w;++S){let A=x.range(.001,1)*f,N=x.range(-.1,.1);k.createParticle(0,x.range(i-10.01,i+10),x.range(s-10.01,s+10),A*Math.cos(N+J),A*Math.sin(N+J),255,255,255,255)}c.frame=function(){d=0,h=0,c.background(0),c.fill(0,0,0,0),c.stroke(255,255,255,255),k.render(),d/=k.count,h/=k.count,o+=-(d-r)*1e-4+(i-r)*1e-4,a+=-(h-n)*1e-4+(s-n)*1e-4;let S=Math.hypot(o,a);S>f*1.4&&(o=o/S*f*1.4,a=a/S*f*1.4),r+=o,n+=a,r<0&&(r=0,o=-o),r>t-l&&(r=t-l,o=-o),n<0&&(n=0,a=-a),n>e-l&&(n=e-l,a=-a),c.stroke(196,128,196),c.fill(255,128,164,128),c.ellipse(r,n,l,l)},c.loop()},snow:function(){let t=c.width,e=c.height,i=new H(c,function(){this.x+=this.dx,this.y+=this.dy,(this.x>=t-1||this.y>=e-1||this.y<0)&&(this.active=!1)});c.frame=function(){c.background(0),i.createParticle(0,x.range(-t/2,t-1),0,x.range(0,.25),x.range(.4,.6),255,255,255,x.range(96,255)),i.render()},c.loop()},stars:function(){let t=c.width,e=c.height,i=t/2,s=e/2,r=i*.75,n=new H(c,function(){let o=this.x-3*this.dx,a=this.y-3*this.dy;this.x+=this.dx,this.y+=this.dy,c.line(this.x,this.y,o,a),(this.x>=t-1||this.y>=e-1||this.x<0||this.y<0)&&(this.active=!1);let d=Math.hypot(this.dx,this.dy),h=Math.min(x.distance(this.x,this.y,i,s),i);this.a=128*Math.max(1-h/r,0)+64*(d/10)+64*Math.max(1-this.t++,0)});c.frame=function(){c.background(0);for(let o=0;o<20;++o){let a=(x.roll(t)+x.roll(t))/2,d=x.roll(e)+x.roll(e)/2,h=Math.min(x.distance(a,d,i,s),i),l=-Math.atan2(s-d,a-i),g=10*(h/i)+1;n.createParticle(0,a,d,Math.cos(l)*g,Math.sin(l)*g,255,255,255,0)}n.render()},c.loop()}};Wt.exports=we});var Zt=j((Re,Qt)=>{var et=Vt(),wt=tt().Renderer(),bt=Object.freeze({cat:{func:function(t){this.echo(et[t].toString())},man:"Print code listing for [demo]"},clear:{func:function(){this.clear()}},help:{func:function(t){t===void 0?(this.echo("Available commands:"),Object.keys(bt).forEach(e=>this.echo(e))):this.echo(bt[t].man)},man:"Print help text for [command].  If no command is passed, list available commands.",usage:"help [command]"},load:{func:function(t,...e){this.echo(`Loading ${t}\u2026`),t in et&&(wt.init(),et[t].apply(this,e))},man:"Load a demo.  Some demos accept additional arguments.\n<b>Example:</b>\n`load chaos 6`.",usage:"load [demo] [args]"},ls:{func:function(){this.echo("Available demos:"),Object.keys(et).filter(t=>t!=="rod").forEach(t=>this.echo(t))},man:"List available demos"},properties:{func:function(t){t===void 0&&this.echo(JSON.stringify(wt,null,2)),this.echo(wt[t])}}});Qt.exports=bt});var Et=(Y(),z(U)).default,{Executor:be}=ft();Xt();var{Renderer:ve}=tt();Et.setLogLevel("debug");var vt=new Et("index.js");window.addEventListener("load",()=>{vt.info("Creating renderer");let t=document.querySelector("canvas"),e=t.getBoundingClientRect();t.width=e.width,t.height=e.height,vt.debug(`initial canvas width (${t.width}) height (${t.height})`),ve(t),vt.info("Creating executor");let i=document.querySelector("ng-terminal"),s=new Et("Executor.js");i.executor=be.bind(i)(s,Zt())});})();
