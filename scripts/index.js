(()=>{var K=Object.defineProperty;var Mt=Object.getOwnPropertyDescriptor;var Et=Object.getOwnPropertyNames;var Lt=Object.prototype.hasOwnProperty;var Ot=(e,n)=>()=>(e&&(n=e(e=0)),n);var A=(e,n)=>()=>(n||e((n={exports:{}}).exports,n),n.exports),kt=(e,n)=>{for(var t in n)K(e,t,{get:n[t],enumerable:!0})},St=(e,n,t,i)=>{if(n&&typeof n=="object"||typeof n=="function")for(let s of Et(n))!Lt.call(e,s)&&s!==t&&K(e,s,{get:()=>n[s],enumerable:!(i=Mt(n,s))||i.enumerable});return e};var j=e=>St(K({},"__esModule",{value:!0}),e);var N={};kt(N,{APITransport:()=>it,ConsoleTransport:()=>J,FileTransport:()=>nt,default:()=>L,interpolate:()=>rt});function L(e){if(e===void 0)throw new Error("Logger requires the file name of where it's being used.");if(!new.target)return new L(...arguments);Object.defineProperties(this,{log:{value:function(n,t,i){D.indexOf(n)<=D.indexOf(L.state.currentLevel)&&Object.values(L.state.transports).forEach(s=>{queueMicrotask(()=>s.log({level:n,msg:t,category:e,...i}))})}}}),D.forEach(n=>{let t;n==="noop"?t=()=>{}:t=this.log.bind(this,n),Object.defineProperty(this,n,{value:t})})}function J(e){if(!new.target)return new J(...arguments);Object.defineProperty(this,"log",{value:function(n){let t=Object.assign({},e,n);if(t.isTable)console.table(t.msg,t.args);else if(t.group)console[t.group](t.msg);else{let[i,s]=t.style?.length===2?t.style:["font-weight: bold; color: green;","font-style: italic;"];console[t.level](`%c${t.timestamp||new Date().toLocaleTimeString("en-US",t.dateFmt)}%c %c[${t.category}]%c ${t.msg}`,i,"",s,"",...t.args||[])}}})}function nt(e){if(window.showSaveFilePicker===void 0){let n="FileTransport requires the File System Access API";throw console.warn(n),new Error(n)}if(!new.target)return new nt(...arguments);Object.defineProperty(this,"initialize",{value:async function(){try{let n=await window.showSaveFilePicker({types:[{description:"Log Files",accept:{"text/plain":[".log"]}}]});Object.defineProperty(this,"log",{value:async function(t){let i=Object.assign({},e,t),s;try{s=await n.createWritable({keepExistingData:!0}),await s.write(`${i.timestamp||new Date().toLocaleTimeString("en-US",i.dateFmt)} [${i.category}] ${i.level}: ${i.msg}
`)}catch(r){console.error(r)}finally{await s.close()}}})}catch(n){console.error(n)}}})}function it(e){if(!new.target)return new it(...arguments);Object.defineProperty(this,"log",{value:async function(n){let t=rt(e,n);try{let i=await fetch(t.url,{method:t.method,headers:Object.entries(t.headers||{}).reduce((s,[r,o])=>(s[r]=o,s),{}),body:t.body});console.debug(i)}catch(i){console.error(i)}}})}var D,rt,C=Ot(()=>{D=["noop","error","warn","info","debug","silly"];Object.defineProperties(L,{addTransport:{value:(e,n)=>{L.state.transports[e]=n}},state:{value:{currentLevel:"noop",transports:{}}},level:{get:()=>L.state.currentLevel},removeTransport:{value:e=>{delete L.state.transports[e]}},setLogLevel:{value:e=>{if(D.some(n=>n===e))L.state.currentLevel=e;else throw new Error(`${e} is not a valid logger level`)}}});L.addTransport("default",J({}));D.reduce((e,n)=>(Object.defineProperty(e,n.toUpperCase(),{enumerable:!0,get:()=>n}),e),L);rt=function e(n,t){if(n instanceof Object){let i=Array.isArray(n)?[]:{};for(let s in n){let r=e(n[s],t);try{i[s]=JSON.parse(r)}catch{r!==void 0&&r!==""&&(i[s]=r)}}return i}return typeof n!="string"?n:n.replace(/\{\{(.+?)}}/g,(i,s)=>{let r=t[s]||"";return r instanceof Object?JSON.stringify(r):r})}});var at=A((Dt,st)=>{var G;typeof window>"u"?G=(C(),j(N)):G=(C(),j(N)).default;var Pt=new G("getopt.js"),ot=function(e){Pt.warn(e)};function u(e,n){typeof u.place>"u"&&(u.place="",u.iplace=0);let t;if(u.optreset>0||u.iplace===u.place.length){if(u.optreset=0,u.place=e[u.optind],u.iplace=0,u.optind>=e.length||u.place.charAt(u.iplace++)!=="-")return u.place="",u.iplace=0,"";if(u.optopt=u.place.charAt(u.iplace++),u.optopt==="-"&&u.iplace===u.place.length)return++u.optind,u.getopt.place="",u.getopt.iplace=0,"";if(u.optopt===0){if(u.place="",u.iplace=0,n.indexOf("-")===-1)return"";u.optopt="-"}}else u.optopt=u.place.charAt(u.iplace++);if(u.optopt===":"||(t=n.indexOf(u.optopt))===-1)return u.iplace===u.place.length&&++u.optind,u.opterr&&n.charAt(0)!==":"&&ot("illegal option -- "+u.optopt),"?";if(n.charAt(t+1)!==":")u.optarg=null,u.iplace===u.place.length&&++u.optind;else{if(u.iplace<u.place.length)u.optarg=u.place.substr(u.iplace);else if(e.length>++u.optind)u.optarg=e[u.optind];else return u.place="",u.iplace=0,n.charAt(0)===":"?":":u.opterr?(ot("option requires an argument -- "+u.optopt),":"):"?";u.place="",u.iplace=0,++u.optind}return u.optopt}u.opterr=1;u.optind=0;u.optopt="";u.optreset=0;u.optarg="";st.exports=u});var X=A((Ft,ct)=>{var S=at();function E(e,n,t){if(typeof n=="function")return function(){return n.apply(this,arguments)||E.OK};let i=this;i.echo===void 0&&(i.echo=e.info);let s=[],r=/"([^"]*)"|'([^']*)'|\S+/g,o=async function(c){e.info(`Executing: ${c}`);let l=c.match(r).map(p=>p.replace(/^['"]|['"]$/g,"")),a=l.shift(),f=n[a];if(f===void 0){if(s.includes(a))try{let p=JSON.stringify(await t(c));return e.debug(`RPC Response: ${p}`),i.echo(p),E.OK}catch(p){return i.echo(p),E.ECMDERR}return i.echo(`${a}: no such command`),E.ENOTFOUND}let{func:m,opts:g,usage:x}=f,d=g;if(x&&(d=d?`${d}h`:"h"),d!==void 0){e.debug(`Parsing options: ${d} with ${l}`);let p={},y;for(S.optreset=1,S.optind=0;(y=S(l,d))!=="";)switch(e.debug(`Opt: ${y}, optarg: ${S.optarg}, optind: ${S.optind}`),y){case"h":return i.echo(`Usage: ${x}`),E.OK;case":":return i.echo(`${S.optopt}: option needs a value`),E.EBADARGS;case"?":return i.echo(`${S.optopt}: no such option`),E.EBADARGS;default:e.debug(`Switch: ${y}, optarg: ${S.optarg}`),p[y]=S.optarg||!0}m.opts=p,e.debug(`Switches: ${JSON.stringify(p)}`)}else S.optind=0;return e.debug(`Terms: ${l}`),await m.apply(this,l.slice(S.optind))??E.OK};return t!==void 0&&queueMicrotask(async function(){let c=await t("system.describe");e.debug(`system.describe result: ${c}`),JSON.parse(c).procs.forEach(l=>s.push(l)),n.help.rpcList=s,e.debug(`RPC List: ${s}`),Object.defineProperties(o,{login:{value:async function(l,a){e.info(`Attempting to log in user ${l}`);try{let f=await t(`login ${l} ${a}`);if(f===!1)return i.echo("Login failed"),E.NOTOKEN;let m=t;return o.exit??Object.defineProperty(o,"exit",{value:async function(){e.info("Logging out"),t=m,i.authState=E.NOTOKEN,i.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!0}}))}}),t=new Proxy(t,{apply:function(g,x,d){return g(d[0],f)}}),E.OK}catch(f){return e.error(f),f}}}})}),o}var F=0;Object.defineProperties(E,{OK:{value:F++},ENOTFOUND:{value:F++},ECMDERR:{value:F++},EBADARGS:{value:F++},NOTOKEN:{value:F++}});function Tt(e,n){let t=0;return function(i,s){try{e.info(`Executing RPC: ${i}`);let r=i.trim().split(/\s+/),o=r.shift(),c=r;s&&(c={token:s,params:c}),e.debug(`Method: ${o}, params: ${c}`);try{return n.jsonrpc({id:t++,method:o,params:c}).then(l=>{let a=JSON.parse(l);if(e.debug(`Response: ${JSON.stringify(a)}`),a.error)throw new Error(a.error.message);return a.result})}catch(l){return e.error(l),l}}catch(r){return e.error(r),r}}}ct.exports={JSONRPCClient:Tt,Executor:E}});var ht=A(()=>{var{Executor:H}=X(),z=(C(),j(N)).default,b=new z("Terminal.js"),$t=100,At=1e3,Y=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.parentTerminal=null,this.commandHistory=[],this.historyIndex=-1;let n=localStorage.getItem("commandHistory");n&&(this.commandHistory=JSON.parse(n),b.debug(`Loading command history (${this.commandHistory.length} items)`),this.historyIndex=this.commandHistory.length),this.inputHandler=this.inputHandler.bind(this),this.reset=this.reset.bind(this),this.addEventListener("terminal-reset",this.reset);let t=function(){b.debug("DOMContentLoaded event fired"),this.reset(new CustomEvent("terminal-reset",{detail:{clear:!0}})),document.removeEventListener("DOMContentLoaded",t)}.bind(this);document.addEventListener("DOMContentLoaded",t)}connectedCallback(){b.debug("Terminal connected")}disconnectedCallback(){b.debug("Terminal disconnected"),this.inputLine.removeEventListener("keydown",this.inputHandler),this.removeEventListener("click",this.focusHandler)}reset(n){if(b.debug(`Terminal reset (${this.parentTerminal?"sub-terminal":"main terminal"})`),b.debug(`Auth state: ${this.authState}, RPC enabled: ${this.rpcEnabled}`),this.rpcEnabled&&this.authState!==H.OK)b.debug("logging in"),this.loginModal();else{let t=n.detail?.clear??!1;b.debug(`reset ${t?"and clear ":""}terminal`),this.uiModal(t)}this.focusHandler=function(){this.inputLine.focus()}.bind(this),this.addEventListener("click",this.focusHandler),this.focusHandler()}applyStyles(){let n=this.querySelector("style").cloneNode(!0);this.shadowRoot.appendChild(n)}loginModal(){this.shadowRoot.innerHTML="",this.applyStyles();let n=this.querySelector("template#login").content.cloneNode(!0);this.shadowRoot.appendChild(n),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.output=this.shadowRoot.querySelector(".output"),this.echo("Please log in");let t,i,s=async r=>{if(r.key==="Enter"){r.preventDefault();let o=(this.inputLine.value??this.inputLine.textContent).trim();if(t===void 0?t=o:i=o,t&&i)try{if(this.authState=await this.executor.login(t,i),b.debug(`Login state: ${this.authState}`),this.authState===H.NOTOKEN){this.loginModal(),this.focusHandler();return}this.inputLine.removeEventListener("keydown",s),this.removeEventListener("click",this.focusHandler),this.reset(new CustomEvent("terminal-reset",{detail:{clear:!0}}))}catch(c){this.echo(c),b.error(c)}else{b.debug(`awaiting password for ${t}`);let c=document.createElement("input");c.type="password",c.classList.add("input-line"),this.inputLine.textContent=this.inputLine.value="",this.inputLine.removeEventListener("keydown",s),this.removeEventListener("click",this.focusHandler),this.inputLine.replaceWith(c),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.prompt="password:",this.inputLine.addEventListener("keydown",s),this.addEventListener("click",this.focusHandler),this.focusHandler()}}};this.inputLine.addEventListener("keydown",s)}uiModal(n){let t=this.shadowRoot.querySelector(".output")?.innerHTML;this.shadowRoot.innerHTML="",this.applyStyles();let i=this.querySelector("template#ui").content.cloneNode(!0);this.shadowRoot.appendChild(i),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.output=this.shadowRoot.querySelector(".output"),n&&this.greeting?(b.debug("clearing terminal"),this.echo(this.greeting)):this.output.innerHTML=t??"",this.inputLine.addEventListener("keydown",this.inputHandler),this.inputLine.focus()}get executor(){return this._executor}set executor(n){b.info("Setting executor"),this._executor=n}get greeting(){return this.getAttribute("greeting")}set greeting(n){n===void 0?this.removeAttribute("greeting"):this.setAttribute("greeting",n)}get prompt(){return this.shadowRoot.querySelector(".prompt").textContent}set prompt(n){let t=this.shadowRoot.querySelector(".prompt");t.innerHTML=`${n}&nbsp;`}get rpcEnabled(){return this.getAttribute("rpc")==="true"}inputHandler(n){switch(n.key){case"Enter":{n.preventDefault();let t=this.inputLine.textContent.trim();this.inputLine.textContent="",this.echo(`${this.prompt}${t}`),this.processCommand(t),this.historyIndex=this.commandHistory.length;break}case"ArrowUp":b.debug(`History index (back): ${this.historyIndex}`),this.historyIndex>0&&(this.historyIndex-=1,this.inputLine.textContent=this.commandHistory[this.historyIndex]);break;case"ArrowDown":b.debug(`History index (forward): ${this.historyIndex}`),this.historyIndex<this.commandHistory.length-1?(this.historyIndex+=1,this.inputLine.textContent=this.commandHistory[this.historyIndex]):(this.historyIndex=this.commandHistory.length,this.inputLine.textContent="");break}}async processCommand(n){try{let t=await this.executor(n);switch(b.debug(`Status: ${t}`),t){case H.OK:b.debug(`${n} executed successfully`),n!==this.commandHistory[this.commandHistory.length-1]&&(this.commandHistory.push(n),this.commandHistory.length>$t&&this.commandHistory.shift(),localStorage.setItem("commandHistory",JSON.stringify(this.commandHistory)));break;case H.ENOTFOUND:b.info(`${n} not found`);break;case H.ECMDERR:b.error(`Error executing ${n}`);break;case H.EBADARGS:b.warn(`${n} called with bad arguments`);break;default:b.error(`Unknown status: ${t} for ${n}`);break}}catch(t){b.error(t),this.echo(t)}}clear(){this.output.innerHTML=""}echo(n){for(n!=null&&n!==""&&(this.output.innerHTML+=`<div>${n}</div>`);this.output.children.length>At;)this.output.removeChild(this.output.firstChild);this.inputLine.getBoundingClientRect().bottom>window.innerHeight&&this.inputLine.scrollIntoView({behavior:"smooth"})}log(n){z.level==="debug"&&(typeof n=="string"?console.info(n):console.dir(n))}startSubTerminal(n){b.info(`Starting sub-terminal: ${n.name}`),this.removeEventListener("terminal-reset",this.reset);let t=new z(`Executor.js (${n.name})`),i=document.createElement("ng-terminal");return i.innerHTML=this.innerHTML,i.greeting=n.greeting,i.executor=H.bind(i)(t,n.registry),i.parentTerminal=this,this.replaceWith(i),i.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!0}})),n.prompt!==void 0&&(i.prompt=n.prompt),i}exitSubTerminal(){this.parentTerminal?(b.info("Exiting sub-terminal"),b.debug(`Parent terminal: ${JSON.stringify(this.parentTerminal)}`),this.parentTerminal.addEventListener("terminal-reset",this.parentTerminal.reset),this.replaceWith(this.parentTerminal),this.parentTerminal.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!1}}))):b.warn("No parent terminal found")}};customElements.define("ng-terminal",Y)});var B=A((Ut,ut)=>{var Ht=(C(),j(N)).default,I=new Ht("Renderer.js");function V(e,n){if(!new.target)return new V(...arguments);let t=e.pixels.toArray(),i=t.length,s=new Proxy(e,{get:function(r,o,c){if(typeof o=="string"&&!isNaN(o)){let l=+o;if(Number.isInteger(l)&&l>=0&&l<i)return t[l]}else return Reflect.get(r,o,c)},set:function(r,o,c,l){if(typeof o=="string"&&!isNaN(o)){let a=+o;Number.isInteger(a)&&a>=0&&a<i&&(t[a]=Array.isArray(c)?n.color.apply(this,c):c)}else return Reflect.set(r,o,c,l)}});return e.loaded=!0,Object.defineProperties(s,{blit:{value:function(r,o){e.pixels.set(t),n.image(e,r,o)}},length:{value:t.length},update:{value:function(){e.pixels.set(t)}}}),s}function Q(e){if(!new.target)return new Q(...arguments);let n=0,t=[];Object.defineProperties(t,{flip:{value:function(){n^=1}},read:{get:function(){return this[n^1]}},write:{get:function(){return this[n]}}});let i=e.createImage();t.push({buffer:i,get pixels(){return i.pixels.toArray()}});let s=e.createImage();t.push({buffer:s,get pixels(){return s.pixels.toArray()}}),Object.defineProperties(this,{flip:{value:function(){let o=t.write.buffer;o.update(),e.background(o),t.flip()}},readBuffer:{get:function(){return t.read.pixels}},writeBuffer:{get:function(){return t.write.buffer}}})}function _(e){if(_.instance!==void 0)return _.instance;if(!new.target)return new _(...arguments);let n={background:4278849802,frameRate:60,height:e.height,width:e.width},t;Object.defineProperties(this,{createImage:{value:function(s,r){let o=t.createImage(s??e.width,r??e.height);return new V(o,t)}},draw:{set:function(s){I.debug("pjs.draw set"),Object.defineProperty(t,"draw",{value:s,writable:!0})}},doubleBuffer:{value:function(){return new Q(this)}},init:{value:function(s){t!==void 0&&t.noLoop();let r=Object.assign({},n,s);t=new Processing(e,o=>{I.info("Processing.js created"),I.debug(`canvas width (${e.width}) height (${e.height})`),Object.defineProperties(o,{draw:{value:function(){},writable:!0},keyPressed:{value:function(){switch(o.keyCode){case o.UP:o.loop();break;case o.DOWN:o.noLoop();break;case o.LEFT:o.save("image.png");break;case o.RIGHT:o.redraw()}},writable:!0},setup:{value:function(){o.size(r.width,r.height),I.debug(`processingjs width (${o.width}) height (${o.height}) ${o.use3DContext}`),o.frameRate(r.frameRate),o.noLoop(),o.background(r.background),I.info("Processing.js setup")}}})})}},input:{set:function(s){I.debug("keyPressed set"),Object.defineProperty(t,"keyPressed",{value:s,writable:!0})}},pixelHeight:{get:function(){return 0}},pixelWidth:{get:function(){return 0}}}),this.init();let i=new Proxy(this,{get:function(s,r){return s[r]??t[r]}});return Object.defineProperty(_,"instance",{value:i}),i}ut.exports={DoubleBuffer:Q,Image:V,Renderer:_}});var dt=A((Kt,lt)=>{function q(){if(q.instance instanceof q)return q.instance;if(!new.target)return new q(...arguments);Object.defineProperty(q,"instance",{value:this});let e=Math.PI/180;Object.defineProperties(this,{cos:{value:{},enumerable:!0},sin:{value:{},enumerable:!0}});for(let n=0;n<=360;++n)Object.defineProperty(this.cos,n,{value:Math.cos(n*e)}),Object.defineProperty(this.sin,n,{value:Math.sin(n*e)})}var Rt=Object.freeze({addColors:(...e)=>e.length===0?[]:e[0].map((n,t)=>Math.min(e.reduce((i,s)=>i+s[t],0),255)),decodeColor:e=>[e>>16&255,e>>8&255,e&255,e>>>24],distance:(e,n,t,i)=>Math.hypot(Math.abs(t-e),Math.abs(i-n)),fastInvSqrt:()=>1,fastTrig:q(),range:(e,n)=>{let t=Math.random()*(n-e+1);return Number.isInteger(e)&&Number.isInteger(n)&&(t=Math.floor(t)),t+e},roll:e=>Math.floor(Math.random()*e)});lt.exports=Rt});var gt=A((Jt,pt)=>{function ft(e,n){if(!new.target)return new ft(...arguments);let t=2,i=new s;i.next=new s,i.prev=i.next,i.prev.next=i,i.prev.prev=i,i.active=!1,i.prev.active=!1,this.acceleration=[0,.25],this.elasticity=.2,this.MAX_COUNT=3e3,Object.defineProperties(this,{count:{get:function(){return t}},createParticle:{value:function(r,o,c,l,a,f,m,g,x){if(i.prev.active){if(t>=this.MAX_COUNT)return;let d=new s(r,o,c,l,a,f,m,g,x);d.next=i,d.prev=i.prev,d.prev.next=d,i.prev=d,i=d,++t}else{let d=i.prev;d.activate(r,o,c,l,a,f,m,g,x),i=d}}},list:{get:function(){return i}},render:{value:function(){let r=i;for(;r.active;){n.call(r,this),e.stroke(r.r,r.g,r.b,r.a),e.point(r.x,r.y);let o=r;if(r.ttl>0&&++r.t>=r.ttl&&(r.active=!1),r=r.next,r===i)break;o.active||(o===i?i=o.next:(o.next.prev=o.prev,o.prev.next=o.next,o.next=i,o.prev=i.prev,i.prev.next=o,i.prev=o))}}}});function s(r,o,c,l,a,f,m,g,x){if(!new.target)return new s(...arguments);Object.defineProperties(this,{activate:{value:function(d,p,y,M,O,P,v,$,R){this.active=!0,this.ttl=d,this.t=0,this.x=p,this.y=y,this.dx=M,this.dy=O,this.ddx=0,this.ddy=0,this.dddx=0,this.dddy=0,this.r=P,this.g=v,this.b=$,this.a=R}}}),this.activate(r,o,c,l,a,f,m,g,x)}}pt.exports=ft});var xt=A((Gt,mt)=>{var w=dt(),T=gt(),h=B().Renderer();function yt(e,n,t,i){let s=i%e,r=Math.floor(i/e),o=t,c=Math.floor(s/n)%2==0,l=Math.floor(r/n)%2==0;return c!=l&&(o=0),[o,o,o,255]}var Nt={boids:function(){let e=h.width,n=h.height,t=e/2,i=n/2,s=40,r=5,o=1e-4,c=100,l=40,a=1,f=3,m=2,g=new T(h,function(x){let d={x:0,y:0},p={x:0,y:0},y={x:0,y:0},M=0,O=0,P=x.list,v=P;for(;v.active;){if(v===this){if(v=v.next,v===P)break;continue}let k=Math.hypot(this.x-v.x,this.y-v.y);if(k<c&&(d.x+=v.dx,d.y+=v.dy,p.x+=v.x,p.y+=v.y,M++),k<l){let et=(l-k)/l;y.x+=(this.x-v.x)*et,y.y+=(this.y-v.y)*et,O++}if(v=v.next,v===P)break}if(M>0){d.x/=M,d.y/=M;let k=Math.hypot(d.x,d.y);k>0&&(d.x=d.x/k*o*a,d.y=d.y/k*o*a),p.x=(p.x/M-this.x)*o*f,p.y=(p.y/M-this.y)*o*f}if(O>0){y.x/=O,y.y/=O;let k=Math.hypot(y.x,y.y);k>0&&(y.x=y.x/k*o*m,y.y=y.y/k*o*m)}this.ddx=d.x+p.x+y.x,this.ddy=d.y+p.y+y.y,this.dx+=this.ddx,this.dy+=this.ddy;let $=Math.hypot(this.dx,this.dy);$>r&&(this.dx=this.dx/$*r,this.dy=this.dy/$*r);let R=this.x-3*this.dx,vt=this.y-3*this.dy;this.x+=this.dx,this.y+=this.dy,h.line(this.x,this.y,R,vt),this.x>=e-1?(this.x=e-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=n-1?(this.y=n-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1)});for(let x=0;x<s;++x)g.createParticle(0,w.range(t-10,t+10),w.range(i-10,i+10),w.range(-.5,.5),w.range(-.5,.5),w.roll(255),w.roll(255),w.roll(255),255);h.stroke(0,0,0,255),h.draw=function(){h.background(0),g.render()},h.loop()},bz:function(){let e=h.width,n=Array.from({length:8},()=>Math.random()*e),t=Array.from({length:8},()=>Math.random()*e),i=Array.from({length:8},()=>Math.random()*15);h.background(255),h.noFill(),h.draw=function(){h.stroke(0,0,0,20),n.map(function(s,r,o){let c=s+i[r];c<0?(c=0,i[r]*=-1):c>e&&(c=e,i[r]*=-1),o[r]=c}),h.bezier.apply(null,n),h.stroke(255,128,128,20),t.map(function(s,r,o){let c=s+i[r];c<0?(c=0,i[r]*=-1):c>e&&(c=e,i[r]*=-1),o[r]=c}),h.bezier.apply(null,t)},h.loop()},chaos:function(e="3"){h.init({frameRate:400});let n=h.width,t=h.height,i=n/2,s=t/2,r=i-50,o=Math.PI/180,c={3:[{x:n/2,y:50},{x:50,y:t-50},{x:n-50,y:t-50}],5:[{x:n-50,y:50},{x:50,y:50},{x:50,y:t-50},{x:n-50,y:t-50},{x:i,y:s}],6:[{x:Math.cos(0)*r+i,y:Math.sin(0)*r+s},{x:Math.cos(60*o)*r+i,y:Math.sin(60*o)*r+s},{x:Math.cos(120*o)*r+i,y:Math.sin(120*o)*r+s},{x:Math.cos(180*o)*r+i,y:Math.sin(180*o)*r+s},{x:Math.cos(240*o)*r+i,y:Math.sin(240*o)*r+s},{x:Math.cos(300*o)*r+i,y:Math.sin(300*o)*r+s}]}[e],l={3:2,5:1.5,6:1.5}[e];h.background(0),h.stroke(255,255,255,255);for(let{x:m,y:g}of c)h.point(m,g);let a=Math.random()*n,f=Math.random()*t;h.draw=function(){let m=w.roll(c.length);a+=(c[m].x-a)/l,f+=(c[m].y-f)/l,h.point(a,f)},h.loop()},fire:function(){h.init({background:0,frameRate:60,height:300,width:300});let e=h.width,n=h.doubleBuffer(),t=n.writeBuffer;for(let r=0;r<t.length;++r)t[r]=[0,0,0,255];n.flip(),t=n.writeBuffer;for(let r=0;r<t.length;++r)t[r]=[0,0,0,255];n.flip();let i=n.readBuffer.length/e,s=h.color(255,128,96);h.draw=function(){let r=n.readBuffer,o=n.writeBuffer;for(let c=e;c<o.length-e;++c){if(c%e<1||c%e>=e-1)continue;let l=c/e;if(Math.random()<Math.pow(Math.E,Math.pow(l/i,4))-1&&Math.random()>.975){o[c]=s;continue}let a=w.addColors(w.decodeColor(r[c-1]),w.decodeColor(r[c]),w.decodeColor(r[c+1]),w.decodeColor(r[c+e])).map((f,m)=>{if(m===3)return 255;let g=f/4.25;return g<10?0:g});o[c]=a}n.flip()},h.loop()},fireworks:function(){let e=h.width,n=h.height,t=new T(h,function(){this.dx+=t.acceleration[0],this.dy+=t.acceleration[1],this.x+=this.dx,this.y+=this.dy;let a=1-this.t/this.ttl;this.r=255*Math.pow(a,.2),this.g=255*a*a,this.b=255*a*a*a*a,this.a=255*a}),i=new T(h,function(){this.dx+=i.acceleration[0],this.dy+=i.acceleration[1],this.x+=this.dx,this.y+=this.dy;let a=1-this.t/this.ttl;this.b=255*Math.pow(a,.2),this.g=255*a*a,this.r=255*a*a*a*a,this.a=255*a}),s=new T(h,function(){this.dx+=s.acceleration[0],this.dy+=s.acceleration[1],this.x+=this.dx,this.y+=this.dy;let a=1-this.t/this.ttl;this.g=255*Math.pow(a,.2),this.r=255*a*a,this.b=255*a*a*a*a,this.a=255*a}),r=new T(h,function(){this.dx+=r.acceleration[0],this.dy+=r.acceleration[1],this.x+=this.dx,this.y+=this.dy;let a=1-this.t/this.ttl;this.r=255*Math.pow(a,.2),this.g=255*Math.pow(a,.2),this.b=255*a*a*a*a,this.a=255*a}),o=new T(h,function(){this.dx+=o.acceleration[0],this.dy+=o.acceleration[1],this.x+=this.dx,this.y+=this.dy;let a=1-this.t/this.ttl;this.r=255*Math.pow(a,.2),this.b=255*a*a*a*a,this.g=255*a,this.a=255*a}),c=new T(h,function(){this.dx+=c.acceleration[0],this.dy+=c.acceleration[1],this.x+=this.dx,this.y+=this.dy;let a=1-this.t/this.ttl;this.r=255*Math.pow(a,.2),this.b=255*Math.pow(a,.2),this.g=255*a*a*a*a,this.a=255*a});t.acceleration=[0,.15],i.acceleration=[0,.15],s.acceleration=[0,.15],r.acceleration=[0,.15],o.acceleration=[0,.15],c.acceleration=[0,.15];function l(a,f){let m;switch(w.range(0,5)){case 0:m=t;break;case 1:m=i;break;case 2:m=s;break;case 3:m=r;break;case 4:m=c;break;case 5:m=o;break}for(let g=0;g<300;++g){let x=w.range(0,Math.PI*2),d=w.range(.001,10);m.createParticle(w.range(50.001,100),a,f,Math.cos(x)*d,Math.sin(x)*d,0,0,0,0)}}h.draw=function(){h.background(0),Math.random()>.95&&l(w.range(.001,e),w.range(.001,n/2)),t.render(),i.render(),s.render(),r.render(),c.render(),o.render()},h.loop()},fountain:function(){let e=h.width,n=h.height,t=new T(h,function(){this.dx+=t.acceleration[0],this.dy+=t.acceleration[1],this.x+=this.dx,this.y+=this.dy;let s=1-this.t/this.ttl;this.r=255*Math.pow(s,.2),this.g=255*s*s,this.b=255*s*s*s*s,this.a=255*Math.pow(s,.2),this.x>=e-1?(this.x=e-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=n-2?(this.dy<.25?this.y=n-1:this.y=n-2,this.dy*=-1.2*Math.random()*t.elasticity,Math.random()<.5?this.dx-=this.dy:this.dx+=this.dy):this.y<0&&(this.y=0,this.dy*=-1*t.elasticity),this.y===n-1&&(this.active=!1)}),i=-20;h.draw=function(){h.background(0);for(let s=0;s<15;++s){let r=w.range(-.098,.098),o=w.range(i,.8*i);t.createParticle(w.range(10,30)*-o,e/2,n-20,Math.sin(r)*o,Math.cos(r)*o,0,0,0,0)}t.render()},h.loop()},lens:function(e=150,n=30){e=+e,n=+n;let t=h.width,i=h.createImage(),s=i.height;for(let p=0;p<i.length;++p)i[p]=yt(s,s/32,255,p);i.update();let r=h.createImage(e,e),o=new Array(e*e).fill(0),c=Math.round(e/2),l=c*c,a=c*(e+1),f;for(let p=0;p<l;++p){let y=p%c,M=Math.floor(p/c),O=y*y,P=M*M,v=0,$=0;if(O+P<l){let R=n/Math.sqrt(n*n-(O+P-l));v=Math.floor(y*R)-y,$=Math.floor(M*R)-M}f=$*t+v,o[a-M*e-y]=-f,o[a+M*e+y]=f,f=-$*t+v,o[a-M*e+y]=f,o[a+M*e-y]=-f}let m=t/2,g=t/2,x=1,d=2;h.draw=function(){m+=x,g+=d,m<0&&(m=0,x=-x),m>t-e&&(m=t-e,x=-x),g<0&&(g=0,d=-d),g>t-e&&(g=t-e,d=-d),h.background(i);let p=g*t+m;for(let y=0;y<e*e;++y)r[y]=i[Math.round(p)+Math.floor(y/e)*t+y%e+o[y]];r.blit(m,g)},h.loop()},life:function(e=300,n=300){h.init({background:0,frameRate:12,height:+n,width:+e});let t=h.width,i=h.height,s=.05,r=0,o=1,c=1,l=0,a=-1,f=Array.from(Array(t*i)).map(()=>Array.from(Array(2)));f.forEach(g=>{g[r]=l,g[o]=Math.random()<s?c:l});function m(g){let x=g%t,d=Math.floor(g/t),p=0;return d>0&&(x>0&&(p+=f[g-t-1][r]),x<t-1&&(p+=f[g-t+1][r]),p+=f[g-t][r]),d<i-1&&(x>0&&(p+=f[g+t-1][r]),x<t-1&&(p+=f[g+t+1][r]),p+=f[g+t][r]),x>0&&(p+=f[g-1][r]),x<t-1&&(p+=f[g+1][r]),p}h.stroke(255),h.draw=function(){h.background(0),f.forEach((g,x)=>{let d=f[x];if(g[o]===c||g[r]===c){d[r]=c;let O=x%t,P=x/t;h.point(O,P)}g[o]===a&&(d[r]=l),d[o]=l;let p=x-3*t;if(p<0)return;let y=f[p],M=m(p);M===3&&y[r]===l&&(y[o]=c),(M<2||M>3)&&y[r]===c&&(y[o]=a)})},h.loop()},pattern:function(){let e=h.createImage(),n=e.height;for(let t=0;t<e.length;++t)e[t]=yt(n,n/8,255,t);e.update(),h.background(e)},snow:function(){let e=h.width,n=h.height,t=new T(h,function(){this.x+=this.dx,this.y+=this.dy,(this.x>=e-1||this.y>=n-1||this.y<0)&&(this.active=!1)});h.draw=function(){h.background(0),t.createParticle(0,w.range(-e/2,e-1),0,w.range(0,.25),w.range(.4,.6),255,255,255,w.range(96,255)),t.render()},h.loop()},stars:function(){let e=h.width,n=h.height,t=e/2,i=n/2,s=t*.75,r=new T(h,function(){let o=this.x-3*this.dx,c=this.y-3*this.dy;this.x+=this.dx,this.y+=this.dy,h.line(this.x,this.y,o,c),(this.x>=e-1||this.y>=n-1||this.x<0||this.y<0)&&(this.active=!1);let l=Math.hypot(this.dx,this.dy),a=Math.min(w.distance(this.x,this.y,t,i),t);this.a=128*Math.max(1-a/s,0)+64*(l/10)+64*Math.max(1-this.t++,0)});h.draw=function(){h.background(0);for(let o=0;o<20;++o){let c=(w.roll(e)+w.roll(e))/2,l=w.roll(n)+w.roll(n)/2,a=Math.min(w.distance(c,l,t,i),t),f=-Math.atan2(i-l,c-t),m=10*(a/t)+1;r.createParticle(0,c,l,Math.cos(f)*m,Math.sin(f)*m,255,255,255,0)}r.render()},h.loop()}};mt.exports=Nt});var bt=A((Xt,wt)=>{var U=xt(),Ct=B().Renderer(),Z=Object.freeze({cat:{func:function(e){this.echo(U[e].toString())},man:"Print code listing for [demo]"},clear:{func:function(){this.clear()}},help:{func:function(e){e===void 0?(this.echo("Available commands:"),Object.keys(Z).forEach(n=>this.echo(n))):this.echo(Z[e].man)},man:"Print help text for [command].  If no command is passed, list available commands.",usage:"help [command]"},load:{func:function(e,...n){this.echo(`Loading ${e}\u2026`),e in U&&(Ct.init(),U[e].apply(this,n))},man:"Load a demo.  Some demos accept additional arguments.\n<b>Example:</b>\n`load chaos 6`.",usage:"load [demo] [args]"},ls:{func:function(){this.echo("Available demos:"),Object.keys(U).forEach(e=>this.echo(e))},man:"List available demos"}});wt.exports=Z});var tt=(C(),j(N)).default,{Executor:It}=X();ht();var{Renderer:qt}=B();tt.setLogLevel("debug");var W=new tt("index.js");window.addEventListener("load",()=>{W.info("Creating renderer");let e=document.querySelector("canvas"),n=e.getBoundingClientRect();e.width=n.width,e.height=n.height,W.debug(`initial canvas width (${e.width}) height (${e.height})`),qt(e),W.info("Creating executor");let t=document.querySelector("ng-terminal"),i=new tt("Executor.js");t.executor=It.bind(t)(i,bt())});})();
