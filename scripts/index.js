(()=>{var U=Object.defineProperty;var bt=Object.getOwnPropertyDescriptor;var xt=Object.getOwnPropertyNames;var vt=Object.prototype.hasOwnProperty;var Mt=(n,e)=>()=>(n&&(e=n(n=0)),e);var k=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),Lt=(n,e)=>{for(var t in e)U(n,t,{get:e[t],enumerable:!0})},Ot=(n,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of xt(e))!vt.call(n,s)&&s!==t&&U(n,s,{get:()=>e[s],enumerable:!(i=bt(e,s))||i.enumerable});return n};var I=n=>Ot(U({},"__esModule",{value:!0}),n);var H={};Lt(H,{APITransport:()=>et,ConsoleTransport:()=>_,FileTransport:()=>tt,default:()=>L,interpolate:()=>nt});function L(n){if(n===void 0)throw new Error("Logger requires the file name of where it's being used.");if(!new.target)return new L(...arguments);Object.defineProperties(this,{log:{value:function(e,t,i){q.indexOf(e)<=q.indexOf(L.state.currentLevel)&&Object.values(L.state.transports).forEach(s=>{queueMicrotask(()=>s.log({level:e,msg:t,category:n,...i}))})}}}),q.forEach(e=>{let t;e==="noop"?t=()=>{}:t=this.log.bind(this,e),Object.defineProperty(this,e,{value:t})})}function _(n){if(!new.target)return new _(...arguments);Object.defineProperty(this,"log",{value:function(e){let t=Object.assign({},n,e);if(t.isTable)console.table(t.msg,t.args);else if(t.group)console[t.group](t.msg);else{let[i,s]=t.style?.length===2?t.style:["font-weight: bold; color: green;","font-style: italic;"];console[t.level](`%c${t.timestamp||new Date().toLocaleTimeString("en-US",t.dateFmt)}%c %c[${t.category}]%c ${t.msg}`,i,"",s,"",...t.args||[])}}})}function tt(n){if(window.showSaveFilePicker===void 0){let e="FileTransport requires the File System Access API";throw console.warn(e),new Error(e)}if(!new.target)return new tt(...arguments);Object.defineProperty(this,"initialize",{value:async function(){try{let e=await window.showSaveFilePicker({types:[{description:"Log Files",accept:{"text/plain":[".log"]}}]});Object.defineProperty(this,"log",{value:async function(t){let i=Object.assign({},n,t),s;try{s=await e.createWritable({keepExistingData:!0}),await s.write(`${i.timestamp||new Date().toLocaleTimeString("en-US",i.dateFmt)} [${i.category}] ${i.level}: ${i.msg}
`)}catch(r){console.error(r)}finally{await s.close()}}})}catch(e){console.error(e)}}})}function et(n){if(!new.target)return new et(...arguments);Object.defineProperty(this,"log",{value:async function(e){let t=nt(n,e);try{let i=await fetch(t.url,{method:t.method,headers:Object.entries(t.headers||{}).reduce((s,[r,o])=>(s[r]=o,s),{}),body:t.body});console.debug(i)}catch(i){console.error(i)}}})}var q,nt,A=Mt(()=>{q=["noop","error","warn","info","debug","silly"];Object.defineProperties(L,{addTransport:{value:(n,e)=>{L.state.transports[n]=e}},state:{value:{currentLevel:"noop",transports:{}}},level:{get:()=>L.state.currentLevel},removeTransport:{value:n=>{delete L.state.transports[n]}},setLogLevel:{value:n=>{if(q.some(e=>e===n))L.state.currentLevel=n;else throw new Error(`${n} is not a valid logger level`)}}});L.addTransport("default",_({}));q.reduce((n,e)=>(Object.defineProperty(n,e.toUpperCase(),{enumerable:!0,get:()=>e}),n),L);nt=function n(e,t){if(e instanceof Object){let i=Array.isArray(e)?[]:{};for(let s in e){let r=n(e[s],t);try{i[s]=JSON.parse(r)}catch{r!==void 0&&r!==""&&(i[s]=r)}}return i}return typeof e!="string"?e:e.replace(/\{\{(.+?)}}/g,(i,s)=>{let r=t[s]||"";return r instanceof Object?JSON.stringify(r):r})}});var ot=k((It,rt)=>{var K;typeof window>"u"?K=(A(),I(H)):K=(A(),I(H)).default;var Et=new K("getopt.js"),it=function(n){Et.warn(n)};function u(n,e){typeof u.place>"u"&&(u.place="",u.iplace=0);let t;if(u.optreset>0||u.iplace===u.place.length){if(u.optreset=0,u.place=n[u.optind],u.iplace=0,u.optind>=n.length||u.place.charAt(u.iplace++)!=="-")return u.place="",u.iplace=0,"";if(u.optopt=u.place.charAt(u.iplace++),u.optopt==="-"&&u.iplace===u.place.length)return++u.optind,u.getopt.place="",u.getopt.iplace=0,"";if(u.optopt===0){if(u.place="",u.iplace=0,e.indexOf("-")===-1)return"";u.optopt="-"}}else u.optopt=u.place.charAt(u.iplace++);if(u.optopt===":"||(t=e.indexOf(u.optopt))===-1)return u.iplace===u.place.length&&++u.optind,u.opterr&&e.charAt(0)!==":"&&it("illegal option -- "+u.optopt),"?";if(e.charAt(t+1)!==":")u.optarg=null,u.iplace===u.place.length&&++u.optind;else{if(u.iplace<u.place.length)u.optarg=u.place.substr(u.iplace);else if(n.length>++u.optind)u.optarg=n[u.optind];else return u.place="",u.iplace=0,e.charAt(0)===":"?":":u.opterr?(it("option requires an argument -- "+u.optopt),":"):"?";u.place="",u.iplace=0,++u.optind}return u.optopt}u.opterr=1;u.optind=0;u.optopt="";u.optreset=0;u.optarg="";rt.exports=u});var J=k((qt,st)=>{var O=ot();function M(n,e,t){if(typeof e=="function")return function(){return e.apply(this,arguments)||M.OK};let i=this;i.echo===void 0&&(i.echo=n.info);let s=[],r=/"([^"]*)"|'([^']*)'|\S+/g,o=async function(a){n.info(`Executing: ${a}`);let l=a.match(r).map(g=>g.replace(/^['"]|['"]$/g,"")),c=l.shift(),d=e[c];if(d===void 0){if(s.includes(c))try{let g=JSON.stringify(await t(a));return n.debug(`RPC Response: ${g}`),i.echo(g),M.OK}catch(g){return i.echo(g),M.ECMDERR}return i.echo(`${c}: no such command`),M.ENOTFOUND}let{func:p,opts:f,usage:m}=d,y=f;if(m&&(y=y?`${y}h`:"h"),y!==void 0){n.debug(`Parsing options: ${y} with ${l}`);let g={},w;for(O.optreset=1,O.optind=0;(w=O(l,y))!=="";)switch(n.debug(`Opt: ${w}, optarg: ${O.optarg}, optind: ${O.optind}`),w){case"h":return i.echo(`Usage: ${m}`),M.OK;case":":return i.echo(`${O.optopt}: option needs a value`),M.EBADARGS;case"?":return i.echo(`${O.optopt}: no such option`),M.EBADARGS;default:n.debug(`Switch: ${w}, optarg: ${O.optarg}`),g[w]=O.optarg||!0}p.opts=g,n.debug(`Switches: ${JSON.stringify(g)}`)}else O.optind=0;return n.debug(`Terms: ${l}`),await p.apply(this,l.slice(O.optind))??M.OK};return t!==void 0&&queueMicrotask(async function(){let a=await t("system.describe");n.debug(`system.describe result: ${a}`),JSON.parse(a).procs.forEach(l=>s.push(l)),e.help.rpcList=s,n.debug(`RPC List: ${s}`),Object.defineProperties(o,{login:{value:async function(l,c){n.info(`Attempting to log in user ${l}`);try{let d=await t(`login ${l} ${c}`);if(d===!1)return i.echo("Login failed"),M.NOTOKEN;let p=t;return o.exit??Object.defineProperty(o,"exit",{value:async function(){n.info("Logging out"),t=p,i.authState=M.NOTOKEN,i.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!0}}))}}),t=new Proxy(t,{apply:function(f,m,y){return f(y[0],d)}}),M.OK}catch(d){return n.error(d),d}}}})}),o}var j=0;Object.defineProperties(M,{OK:{value:j++},ENOTFOUND:{value:j++},ECMDERR:{value:j++},EBADARGS:{value:j++},NOTOKEN:{value:j++}});function kt(n,e){let t=0;return function(i,s){try{n.info(`Executing RPC: ${i}`);let r=i.trim().split(/\s+/),o=r.shift(),a=r;s&&(a={token:s,params:a}),n.debug(`Method: ${o}, params: ${a}`);try{return e.jsonrpc({id:t++,method:o,params:a}).then(l=>{let c=JSON.parse(l);if(n.debug(`Response: ${JSON.stringify(c)}`),c.error)throw new Error(c.error.message);return c.result})}catch(l){return n.error(l),l}}catch(r){return n.error(r),r}}}st.exports={JSONRPCClient:kt,Executor:M}});var at=k(()=>{var{Executor:P}=J(),z=(A(),I(H)).default,b=new z("Terminal.js"),Pt=100,$t=1e3,X=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.parentTerminal=null,this.commandHistory=[],this.historyIndex=-1;let e=localStorage.getItem("commandHistory");e&&(this.commandHistory=JSON.parse(e),b.debug(`Loading command history (${this.commandHistory.length} items)`),this.historyIndex=this.commandHistory.length),this.inputHandler=this.inputHandler.bind(this),this.reset=this.reset.bind(this),this.addEventListener("terminal-reset",this.reset);let t=function(){b.debug("DOMContentLoaded event fired"),this.reset(new CustomEvent("terminal-reset",{detail:{clear:!0}})),document.removeEventListener("DOMContentLoaded",t)}.bind(this);document.addEventListener("DOMContentLoaded",t)}connectedCallback(){b.debug("Terminal connected")}disconnectedCallback(){b.debug("Terminal disconnected"),this.inputLine.removeEventListener("keydown",this.inputHandler),this.removeEventListener("click",this.focusHandler)}reset(e){if(b.debug(`Terminal reset (${this.parentTerminal?"sub-terminal":"main terminal"})`),b.debug(`Auth state: ${this.authState}, RPC enabled: ${this.rpcEnabled}`),this.rpcEnabled&&this.authState!==P.OK)b.debug("logging in"),this.loginModal();else{let t=e.detail?.clear??!1;b.debug(`reset ${t?"and clear ":""}terminal`),this.uiModal(t)}this.focusHandler=function(){this.inputLine.focus()}.bind(this),this.addEventListener("click",this.focusHandler),this.focusHandler()}applyStyles(){let e=this.querySelector("style").cloneNode(!0);this.shadowRoot.appendChild(e)}loginModal(){this.shadowRoot.innerHTML="",this.applyStyles();let e=this.querySelector("template#login").content.cloneNode(!0);this.shadowRoot.appendChild(e),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.output=this.shadowRoot.querySelector(".output"),this.echo("Please log in");let t,i,s=async r=>{if(r.key==="Enter"){r.preventDefault();let o=(this.inputLine.value??this.inputLine.textContent).trim();if(t===void 0?t=o:i=o,t&&i)try{if(this.authState=await this.executor.login(t,i),b.debug(`Login state: ${this.authState}`),this.authState===P.NOTOKEN){this.loginModal(),this.focusHandler();return}this.inputLine.removeEventListener("keydown",s),this.removeEventListener("click",this.focusHandler),this.reset(new CustomEvent("terminal-reset",{detail:{clear:!0}}))}catch(a){this.echo(a),b.error(a)}else{b.debug(`awaiting password for ${t}`);let a=document.createElement("input");a.type="password",a.classList.add("input-line"),this.inputLine.textContent=this.inputLine.value="",this.inputLine.removeEventListener("keydown",s),this.removeEventListener("click",this.focusHandler),this.inputLine.replaceWith(a),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.prompt="password:",this.inputLine.addEventListener("keydown",s),this.addEventListener("click",this.focusHandler),this.focusHandler()}}};this.inputLine.addEventListener("keydown",s)}uiModal(e){let t=this.shadowRoot.querySelector(".output")?.innerHTML;this.shadowRoot.innerHTML="",this.applyStyles();let i=this.querySelector("template#ui").content.cloneNode(!0);this.shadowRoot.appendChild(i),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.output=this.shadowRoot.querySelector(".output"),e&&this.greeting?(b.debug("clearing terminal"),this.echo(this.greeting)):this.output.innerHTML=t??"",this.inputLine.addEventListener("keydown",this.inputHandler),this.inputLine.focus()}get executor(){return this._executor}set executor(e){b.info("Setting executor"),this._executor=e}get greeting(){return this.getAttribute("greeting")}set greeting(e){e===void 0?this.removeAttribute("greeting"):this.setAttribute("greeting",e)}get prompt(){return this.shadowRoot.querySelector(".prompt").textContent}set prompt(e){let t=this.shadowRoot.querySelector(".prompt");t.innerHTML=`${e}&nbsp;`}get rpcEnabled(){return this.getAttribute("rpc")==="true"}inputHandler(e){switch(e.key){case"Enter":{e.preventDefault();let t=this.inputLine.textContent.trim();this.inputLine.textContent="",this.echo(`${this.prompt}${t}`),this.processCommand(t),this.historyIndex=this.commandHistory.length;break}case"ArrowUp":b.debug(`History index (back): ${this.historyIndex}`),this.historyIndex>0&&(this.historyIndex-=1,this.inputLine.textContent=this.commandHistory[this.historyIndex]);break;case"ArrowDown":b.debug(`History index (forward): ${this.historyIndex}`),this.historyIndex<this.commandHistory.length-1?(this.historyIndex+=1,this.inputLine.textContent=this.commandHistory[this.historyIndex]):(this.historyIndex=this.commandHistory.length,this.inputLine.textContent="");break}}async processCommand(e){try{let t=await this.executor(e);switch(b.debug(`Status: ${t}`),t){case P.OK:b.debug(`${e} executed successfully`),e!==this.commandHistory[this.commandHistory.length-1]&&(this.commandHistory.push(e),this.commandHistory.length>Pt&&this.commandHistory.shift(),localStorage.setItem("commandHistory",JSON.stringify(this.commandHistory)));break;case P.ENOTFOUND:b.info(`${e} not found`);break;case P.ECMDERR:b.error(`Error executing ${e}`);break;case P.EBADARGS:b.warn(`${e} called with bad arguments`);break;default:b.error(`Unknown status: ${t} for ${e}`);break}}catch(t){b.error(t),this.echo(t)}}clear(){this.output.innerHTML=""}echo(e){for(e!=null&&e!==""&&(this.output.innerHTML+=`<div>${e}</div>`);this.output.children.length>$t;)this.output.removeChild(this.output.firstChild);this.inputLine.getBoundingClientRect().bottom>window.innerHeight&&this.inputLine.scrollIntoView({behavior:"smooth"})}log(e){z.level==="debug"&&(typeof e=="string"?console.info(e):console.dir(e))}startSubTerminal(e){b.info(`Starting sub-terminal: ${e.name}`),this.removeEventListener("terminal-reset",this.reset);let t=new z(`Executor.js (${e.name})`),i=document.createElement("ng-terminal");return i.innerHTML=this.innerHTML,i.greeting=e.greeting,i.executor=P.bind(i)(t,e.registry),i.parentTerminal=this,this.replaceWith(i),i.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!0}})),e.prompt!==void 0&&(i.prompt=e.prompt),i}exitSubTerminal(){this.parentTerminal?(b.info("Exiting sub-terminal"),b.debug(`Parent terminal: ${JSON.stringify(this.parentTerminal)}`),this.parentTerminal.addEventListener("terminal-reset",this.parentTerminal.reset),this.replaceWith(this.parentTerminal),this.parentTerminal.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!1}}))):b.warn("No parent terminal found")}};customElements.define("ng-terminal",X)});var B=k((Dt,ct)=>{var St=(A(),I(H)).default,T=new St("Renderer.js");function G(n,e){if(!new.target)return new G(...arguments);let t=n.pixels.toArray(),i=t.length,s=new Proxy(n,{get:function(r,o,a){if(typeof o=="string"&&!isNaN(o)){let l=+o;if(Number.isInteger(l)&&l>=0&&l<i)return t[l]}else return Reflect.get(r,o,a)},set:function(r,o,a,l){if(typeof o=="string"&&!isNaN(o)){let c=+o;Number.isInteger(c)&&c>=0&&c<i&&(t[c]=Array.isArray(a)?e.color.apply(this,a):a)}else return Reflect.set(r,o,a,l)}});return n.loaded=!0,Object.defineProperties(s,{blit:{value:function(r,o){n.pixels.set(t),e.image(n,r,o)}},length:{value:t.length},update:{value:function(){n.pixels.set(t)}}}),s}function Y(n){if(!new.target)return new Y(...arguments);let e=0,t=[];Object.defineProperties(t,{flip:{value:function(){e^=1}},read:{get:function(){return this[e^1]}},write:{get:function(){return this[e]}}});let i=n.createImage();t.push({buffer:i,get pixels(){return i.pixels.toArray()}});let s=n.createImage();t.push({buffer:s,get pixels(){return s.pixels.toArray()}}),Object.defineProperties(this,{flip:{value:function(){let o=t.write.buffer;o.update(),n.background(o),t.flip()}},readBuffer:{get:function(){return t.read.pixels}},writeBuffer:{get:function(){return t.write.buffer}}})}function F(n){if(F.instance!==void 0)return F.instance;if(!new.target)return new F(...arguments);let e={background:4278849802,frameRate:60,height:n.height,width:n.width},t;Object.defineProperties(this,{createImage:{value:function(s,r){let o=t.createImage(s??n.width,r??n.height);return new G(o,t)}},draw:{set:function(s){T.debug("pjs.draw set"),Object.defineProperty(t,"draw",{value:s,writable:!0})}},doubleBuffer:{value:function(){return new Y(this)}},init:{value:function(s){t!==void 0&&t.noLoop();let r=Object.assign({},e,s);t=new Processing(n,o=>{T.info("Processing.js created"),T.debug(`canvas width (${n.width}) height (${n.height})`),Object.defineProperties(o,{draw:{value:function(){},writable:!0},keyPressed:{value:function(){switch(o.keyCode){case o.UP:o.loop();break;case o.DOWN:o.noLoop();break;case o.LEFT:o.save("image.png");break;case o.RIGHT:o.redraw()}},writable:!0},setup:{value:function(){o.size(r.width,r.height),T.debug(`processingjs width (${o.width}) height (${o.height}) ${o.use3DContext}`),o.frameRate(r.frameRate),o.noLoop(),o.background(r.background),T.info("Processing.js setup")}}})})}},input:{set:function(s){T.debug("keyPressed set"),Object.defineProperty(t,"keyPressed",{value:s,writable:!0})}},pixelHeight:{get:function(){return 0}},pixelWidth:{get:function(){return 0}}}),this.init();let i=new Proxy(this,{get:function(s,r){return s[r]??t[r]}});return Object.defineProperty(F,"instance",{value:i}),i}ct.exports={DoubleBuffer:Y,Image:G,Renderer:F}});var ut=k((Bt,ht)=>{function C(){if(C.instance instanceof C)return C.instance;if(!new.target)return new C(...arguments);Object.defineProperty(C,"instance",{value:this});let n=Math.PI/180;Object.defineProperties(this,{cos:{value:{},enumerable:!0},sin:{value:{},enumerable:!0}});for(let e=0;e<=360;++e)Object.defineProperty(this.cos,e,{value:Math.cos(e*n)}),Object.defineProperty(this.sin,e,{value:Math.sin(e*n)})}var Ht=Object.freeze({addColors:(...n)=>n.length===0?[]:n[0].map((e,t)=>Math.min(n.reduce((i,s)=>i+s[t],0),255)),decodeColor:n=>[n>>16&255,n>>8&255,n&255,n>>>24],distance:(n,e,t,i)=>{let s=Math.abs(t-n),r=Math.abs(i-e);return Math.sqrt(s*s+r*r)},fastInvSqrt:()=>1,fastTrig:C(),range:(n,e)=>{let t=Math.random()*(e-n+1);return Number.isInteger(n)&&Number.isInteger(e)&&(t=Math.floor(t)),t+n},roll:n=>Math.floor(Math.random()*n)});ht.exports=Ht});var ft=k((Ut,dt)=>{function lt(n,e){if(!new.target)return new lt(...arguments);let t=2,i=new s;i.next=new s,i.prev=i.next,i.prev.next=i,i.prev.prev=i,i.active=!1,i.prev.active=!1,this.acceleration=[0,.25],this.elasticity=.2,this.MAX_COUNT=3e3,Object.defineProperties(this,{createParticle:{value:function(r,o,a,l,c,d,p,f,m){if(i.prev.active){if(t>=this.MAX_COUNT)return;let y=new s(r,o,a,l,c,d,p,f,m);y.next=i,y.prev=i.prev,y.prev.next=y,i.prev=y,i=y,++t}else{let y=i.prev;y.activate(r,o,a,l,c,d,p,f,m),i=y}}},render:{value:function(){let r=i;for(;r.active;){e.apply(r),n.stroke(r.r,r.g,r.b,r.a),n.point(r.x,r.y);let o=r;if(r.ttl>0&&++r.t>=r.ttl&&(r.active=!1),r=r.next,r===i)break;o.active||(o===i?i=o.next:(o.next.prev=o.prev,o.prev.next=o.next,o.next=i,o.prev=i.prev,i.prev.next=o,i.prev=o))}}}});function s(r,o,a,l,c,d,p,f,m){if(!(this instanceof s))return new s(r,o,a,l,c,d,p,f,m);Object.defineProperties(this,{activate:{value:function(y,g,w,v,$,S,R,N,D){this.active=!0,this.ttl=y,this.t=0,this.x=g,this.y=w,this.dx=v,this.dy=$,this.ddx=0,this.ddy=0,this.dddx=0,this.dddy=0,this.r=S,this.g=R,this.b=N,this.a=D}}}),this.activate(r,o,a,l,c,d,p,f,m)}}dt.exports=lt});var yt=k((_t,gt)=>{var x=ut(),E=ft(),h=B().Renderer();function pt(n,e,t,i){let s=i%n,r=Math.floor(i/n),o=t,a=Math.floor(s/e)%2==0,l=Math.floor(r/e)%2==0;return a!=l&&(o=0),[o,o,o,255]}var At={bz:function(){let n=h.width,e=Array.from({length:8},()=>Math.random()*n),t=Array.from({length:8},()=>Math.random()*n),i=Array.from({length:8},()=>Math.random()*15);h.background(255),h.noFill(),h.draw=function(){h.stroke(0,0,0,20),e.map(function(s,r,o){let a=s+i[r];a<0?(a=0,i[r]*=-1):a>n&&(a=n,i[r]*=-1),o[r]=a}),h.bezier.apply(null,e),h.stroke(255,128,128,20),t.map(function(s,r,o){let a=s+i[r];a<0?(a=0,i[r]*=-1):a>n&&(a=n,i[r]*=-1),o[r]=a}),h.bezier.apply(null,t)},h.loop()},chaos:function(n="3"){h.init({frameRate:400});let e=h.width,t=h.height,i=e/2,s=t/2,r=i-50,o=Math.PI/180,a={3:[{x:e/2,y:50},{x:50,y:t-50},{x:e-50,y:t-50}],5:[{x:e-50,y:50},{x:50,y:50},{x:50,y:t-50},{x:e-50,y:t-50},{x:i,y:s}],6:[{x:Math.cos(0)*r+i,y:Math.sin(0)*r+s},{x:Math.cos(60*o)*r+i,y:Math.sin(60*o)*r+s},{x:Math.cos(120*o)*r+i,y:Math.sin(120*o)*r+s},{x:Math.cos(180*o)*r+i,y:Math.sin(180*o)*r+s},{x:Math.cos(240*o)*r+i,y:Math.sin(240*o)*r+s},{x:Math.cos(300*o)*r+i,y:Math.sin(300*o)*r+s}]}[n],l={3:2,5:1.5,6:1.5}[n];h.background(0),h.stroke(255,255,255,255);for(let{x:p,y:f}of a)h.point(p,f);let c=Math.random()*e,d=Math.random()*t;h.draw=function(){let p=x.roll(a.length);c+=(a[p].x-c)/l,d+=(a[p].y-d)/l,h.point(c,d)},h.loop()},fire:function(){h.init({background:0,frameRate:60,height:300,width:300});let n=h.width,e=h.doubleBuffer(),t=e.writeBuffer;for(let r=0;r<t.length;++r)t[r]=[0,0,0,255];e.flip(),t=e.writeBuffer;for(let r=0;r<t.length;++r)t[r]=[0,0,0,255];e.flip();let i=e.readBuffer.length/n,s=h.color(255,128,96);h.draw=function(){let r=e.readBuffer,o=e.writeBuffer;for(let a=n;a<o.length-n;++a){if(a%n<1||a%n>=n-1)continue;let l=a/n;if(Math.random()<Math.pow(Math.E,Math.pow(l/i,4))-1&&Math.random()>.975){o[a]=s;continue}let c=x.addColors(x.decodeColor(r[a-1]),x.decodeColor(r[a]),x.decodeColor(r[a+1]),x.decodeColor(r[a+n])).map((d,p)=>{if(p===3)return 255;let f=d/4.25;return f<10?0:f});o[a]=c}e.flip()},h.loop()},fireworks:function(){let n=h.width,e=h.height,t=new E(h,function(){this.dx+=t.acceleration[0],this.dy+=t.acceleration[1],this.x+=this.dx,this.y+=this.dy;let c=1-this.t/this.ttl;this.r=255*Math.pow(c,.2),this.g=255*c*c,this.b=255*c*c*c*c,this.a=255*c}),i=new E(h,function(){this.dx+=i.acceleration[0],this.dy+=i.acceleration[1],this.x+=this.dx,this.y+=this.dy;let c=1-this.t/this.ttl;this.b=255*Math.pow(c,.2),this.g=255*c*c,this.r=255*c*c*c*c,this.a=255*c}),s=new E(h,function(){this.dx+=s.acceleration[0],this.dy+=s.acceleration[1],this.x+=this.dx,this.y+=this.dy;let c=1-this.t/this.ttl;this.g=255*Math.pow(c,.2),this.r=255*c*c,this.b=255*c*c*c*c,this.a=255*c}),r=new E(h,function(){this.dx+=r.acceleration[0],this.dy+=r.acceleration[1],this.x+=this.dx,this.y+=this.dy;let c=1-this.t/this.ttl;this.r=255*Math.pow(c,.2),this.g=255*Math.pow(c,.2),this.b=255*c*c*c*c,this.a=255*c}),o=new E(h,function(){this.dx+=o.acceleration[0],this.dy+=o.acceleration[1],this.x+=this.dx,this.y+=this.dy;let c=1-this.t/this.ttl;this.r=255*Math.pow(c,.2),this.b=255*c*c*c*c,this.g=255*c,this.a=255*c}),a=new E(h,function(){this.dx+=a.acceleration[0],this.dy+=a.acceleration[1],this.x+=this.dx,this.y+=this.dy;let c=1-this.t/this.ttl;this.r=255*Math.pow(c,.2),this.b=255*Math.pow(c,.2),this.g=255*c*c*c*c,this.a=255*c});t.acceleration=[0,.15],i.acceleration=[0,.15],s.acceleration=[0,.15],r.acceleration=[0,.15],o.acceleration=[0,.15],a.acceleration=[0,.15];function l(c,d){let p;switch(x.range(0,5)){case 0:p=t;break;case 1:p=i;break;case 2:p=s;break;case 3:p=r;break;case 4:p=a;break;case 5:p=o;break}for(let f=0;f<300;++f){let m=x.range(0,Math.PI*2),y=x.range(.001,10);p.createParticle(x.range(50.001,100),c,d,Math.cos(m)*y,Math.sin(m)*y,0,0,0,0)}}h.draw=function(){h.background(0),Math.random()>.95&&l(x.range(.001,n),x.range(.001,e/2)),t.render(),i.render(),s.render(),r.render(),a.render(),o.render()},h.loop()},fountain:function(){let n=h.width,e=h.height,t=new E(h,function(){this.dx+=t.acceleration[0],this.dy+=t.acceleration[1],this.x+=this.dx,this.y+=this.dy;let s=1-this.t/this.ttl;this.r=255*Math.pow(s,.2),this.g=255*s*s,this.b=255*s*s*s*s,this.a=255*Math.pow(s,.2),this.x>=n-1?(this.x=n-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-2?(this.dy<.25?this.y=e-1:this.y=e-2,this.dy*=-1.2*Math.random()*t.elasticity,Math.random()<.5?this.dx-=this.dy:this.dx+=this.dy):this.y<0&&(this.y=0,this.dy*=-1*t.elasticity),this.y===e-1&&(this.active=!1)}),i=-20;h.draw=function(){h.background(0);for(let s=0;s<15;++s){let r=x.range(-.098,.098),o=x.range(i,.8*i);t.createParticle(x.range(10,30)*-o,n/2,e-20,Math.sin(r)*o,Math.cos(r)*o,0,0,0,0)}t.render()},h.loop()},lens:function(n=150,e=30){n=+n,e=+e;let t=h.width,i=h.createImage(),s=i.height;for(let g=0;g<i.length;++g)i[g]=pt(s,s/32,255,g);i.update();let r=h.createImage(n,n),o=new Array(n*n).fill(0),a=Math.round(n/2),l=a*a,c=a*(n+1),d;for(let g=0;g<l;++g){let w=g%a,v=Math.floor(g/a),$=w*w,S=v*v,R=0,N=0;if($+S<l){let D=e/Math.sqrt(e*e-($+S-l));R=Math.floor(w*D)-w,N=Math.floor(v*D)-v}d=N*t+R,o[c-v*n-w]=-d,o[c+v*n+w]=d,d=-N*t+R,o[c-v*n+w]=d,o[c+v*n-w]=-d}let p=t/2,f=t/2,m=1,y=2;h.draw=function(){p+=m,f+=y,p<0&&(p=0,m=-m),p>t-n&&(p=t-n,m=-m),f<0&&(f=0,y=-y),f>t-n&&(f=t-n,y=-y),h.background(i);let g=f*t+p;for(let w=0;w<n*n;++w)r[w]=i[Math.round(g)+Math.floor(w/n)*t+w%n+o[w]];r.blit(p,f)},h.loop()},life:function(n=300,e=300){h.init({background:0,frameRate:12,height:+e,width:+n});let t=h.width,i=h.height,s=.05,r=0,o=1,a=1,l=0,c=-1,d=Array.from(Array(t*i)).map(()=>Array.from(Array(2)));d.forEach(f=>{f[r]=l,f[o]=Math.random()<s?a:l});function p(f){let m=f%t,y=Math.floor(f/t),g=0;return y>0&&(m>0&&(g+=d[f-t-1][r]),m<t-1&&(g+=d[f-t+1][r]),g+=d[f-t][r]),y<i-1&&(m>0&&(g+=d[f+t-1][r]),m<t-1&&(g+=d[f+t+1][r]),g+=d[f+t][r]),m>0&&(g+=d[f-1][r]),m<t-1&&(g+=d[f+1][r]),g}h.stroke(255),h.draw=function(){h.background(0),d.forEach((f,m)=>{let y=d[m];if(f[o]===a||f[r]===a){y[r]=a;let $=m%t,S=m/t;h.point($,S)}f[o]===c&&(y[r]=l),y[o]=l;let g=m-3*t;if(g<0)return;let w=d[g],v=p(g);v===3&&w[r]===l&&(w[o]=a),(v<2||v>3)&&w[r]===a&&(w[o]=c)})},h.loop()},pattern:function(){let n=h.createImage(),e=n.height;for(let t=0;t<n.length;++t)n[t]=pt(e,e/8,255,t);n.update(),h.background(n)},snow:function(){let n=h.width,e=h.height,t=new E(h,function(){this.x+=this.dx,this.y+=this.dy,(this.x>=n-1||this.y>=e-1||this.y<0)&&(this.active=!1)});h.draw=function(){h.background(0),t.createParticle(0,x.range(-n/2,n-1),0,x.range(0,.25),x.range(.4,.6),255,255,255,x.range(96,255)),t.render()},h.loop()},stars:function(){let n=h.width,e=h.height,t=n/2,i=e/2,s=t*.75,r=new E(h,function(){this.x+=this.dx,this.y+=this.dy,(this.x>=n-1||this.y>=e-1||this.x<0||this.y<0)&&(this.active=!1);let o=Math.sqrt(this.dx*this.dx+this.dy*this.dy),a=Math.min(x.distance(this.x,this.y,t,i),t);this.a=64*(1-a/s)+255*(o*this.t++/s)+64*(o/6)});h.draw=function(){h.background(0);for(let o=0;o<20;++o){let a=x.roll(n),l=x.roll(e);a=(a+x.roll(n))/2,l=(l+x.roll(e))/2;let c=Math.min(x.distance(a,l,t,i),t),d=-Math.atan((i-l)/(a-t));a<t&&(d+=Math.PI);let p=5*(1-c/t)+1;r.createParticle(0,a,l,Math.cos(d)*p,Math.sin(d)*p,255,255,255,0)}r.render()},h.loop()}};gt.exports=At});var wt=k((Kt,mt)=>{var V=yt(),Tt=B().Renderer(),Q=Object.freeze({clear:{func:function(){this.clear()}},help:{func:function(n){n===void 0?(this.echo("Available commands:"),Object.keys(Q).forEach(e=>this.echo(e))):this.echo(Q[n].man)},man:"Print help text for [command].  If no command is passed, list available commands.",usage:"help [command]"},load:{func:function(n,...e){this.echo(`Loading ${n}\u2026`),n in V&&(Tt.init(),V[n].apply(this,e))},man:"Load a demo.  Some demos accept additional arguments.\n<b>Example:</b>\n`load chaos 6`.",usage:"load [demo] [args]"},ls:{func:function(){this.echo("Available demos:"),Object.keys(V).forEach(n=>this.echo(n))},man:"List available demos"}});mt.exports=Q});var W=(A(),I(H)).default,{Executor:Ct}=J();at();var{Renderer:Rt}=B();W.setLogLevel("debug");var Z=new W("index.js");window.addEventListener("load",()=>{Z.info("Creating renderer");let n=document.querySelector("canvas"),e=n.getBoundingClientRect();n.width=e.width,n.height=e.height,Z.debug(`initial canvas width (${n.width}) height (${n.height})`),Rt(n),Z.info("Creating executor");let t=document.querySelector("ng-terminal"),i=new W("Executor.js");t.executor=Ct.bind(t)(i,wt())});})();
