(()=>{var ut=Object.defineProperty;var re=Object.getOwnPropertyDescriptor;var ae=Object.getOwnPropertyNames;var ce=Object.prototype.hasOwnProperty;var he=(t,e)=>()=>(t&&(e=t(t=0)),e);var X=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),le=(t,e)=>{for(var n in e)ut(t,n,{get:e[n],enumerable:!0})},de=(t,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of ae(e))!ce.call(t,a)&&a!==n&&ut(t,a,{get:()=>e[a],enumerable:!(i=re(e,a))||i.enumerable});return t};var z=t=>de(ut({},"__esModule",{value:!0}),t);var U={};le(U,{APITransport:()=>Nt,ConsoleTransport:()=>ft,FileTransport:()=>Rt,default:()=>D,interpolate:()=>Ht});function D(t){if(t===void 0)throw new Error("Logger requires the file name of where it's being used.");if(!new.target)return new D(...arguments);Object.defineProperties(this,{log:{value:function(e,n,i){V.indexOf(e)<=V.indexOf(D.state.currentLevel)&&Object.values(D.state.transports).forEach(a=>{queueMicrotask(()=>a.log({level:e,msg:n,category:t,...i}))})}}}),V.forEach(e=>{let n;e==="noop"?n=()=>{}:n=this.log.bind(this,e),Object.defineProperty(this,e,{value:n})})}function ft(t){if(!new.target)return new ft(...arguments);Object.defineProperty(this,"log",{value:function(e){let n=Object.assign({},t,e);if(n.isTable)console.table(n.msg,n.args);else if(n.group)console[n.group](n.msg);else{let[i,a]=n.style?.length===2?n.style:["font-weight: bold; color: green;","font-style: italic;"];console[n.level](`%c${n.timestamp||new Date().toLocaleTimeString("en-US",n.dateFmt)}%c %c[${n.category}]%c ${n.msg}`,i,"",a,"",...n.args||[])}}})}function Rt(t){if(window.showSaveFilePicker===void 0){let e="FileTransport requires the File System Access API";throw console.warn(e),new Error(e)}if(!new.target)return new Rt(...arguments);Object.defineProperty(this,"initialize",{value:async function(){try{let e=await window.showSaveFilePicker({types:[{description:"Log Files",accept:{"text/plain":[".log"]}}]});Object.defineProperty(this,"log",{value:async function(n){let i=Object.assign({},t,n),a;try{a=await e.createWritable({keepExistingData:!0}),await a.write(`${i.timestamp||new Date().toLocaleTimeString("en-US",i.dateFmt)} [${i.category}] ${i.level}: ${i.msg}
`)}catch(o){console.error(o)}finally{await a.close()}}})}catch(e){console.error(e)}}})}function Nt(t){if(!new.target)return new Nt(...arguments);Object.defineProperty(this,"log",{value:async function(e){let n=Ht(t,e);try{let i=await fetch(n.url,{method:n.method,headers:Object.entries(n.headers||{}).reduce((a,[o,r])=>(a[o]=r,a),{}),body:n.body});console.debug(i)}catch(i){console.error(i)}}})}var V,Ht,B=he(()=>{V=["noop","error","warn","info","debug","silly"];Object.defineProperties(D,{addTransport:{value:(t,e)=>{D.state.transports[t]=e}},state:{value:{currentLevel:"noop",transports:{}}},level:{get:()=>D.state.currentLevel},removeTransport:{value:t=>{delete D.state.transports[t]}},setLogLevel:{value:t=>{if(V.some(e=>e===t))D.state.currentLevel=t;else throw new Error(`${t} is not a valid logger level`)}}});D.addTransport("default",ft({}));V.reduce((t,e)=>(Object.defineProperty(t,e.toUpperCase(),{enumerable:!0,get:()=>e}),t),D);Ht=function t(e,n){if(e instanceof Object){let i=Array.isArray(e)?[]:{};for(let a in e){let o=t(e[a],n);try{i[a]=JSON.parse(o)}catch{o!==void 0&&o!==""&&(i[a]=o)}}return i}return typeof e!="string"?e:e.replace(/\{\{(.+?)}}/g,(i,a)=>{let o=n[a]||"";return o instanceof Object?JSON.stringify(o):o})}});var qt=X((ve,Dt)=>{var pt;typeof window>"u"?pt=(B(),z(U)):pt=(B(),z(U)).default;var ue=new pt("getopt.js"),$t=function(t){ue.warn(t)};function x(t,e){typeof x.place>"u"&&(x.place="",x.iplace=0);let n;if(x.optreset>0||x.iplace===x.place.length){if(x.optreset=0,x.place=t[x.optind],x.iplace=0,x.optind>=t.length||x.place.charAt(x.iplace++)!=="-")return x.place="",x.iplace=0,"";if(x.optopt=x.place.charAt(x.iplace++),x.optopt==="-"&&x.iplace===x.place.length)return++x.optind,x.getopt.place="",x.getopt.iplace=0,"";if(x.optopt===0){if(x.place="",x.iplace=0,e.indexOf("-")===-1)return"";x.optopt="-"}}else x.optopt=x.place.charAt(x.iplace++);if(x.optopt===":"||(n=e.indexOf(x.optopt))===-1)return x.iplace===x.place.length&&++x.optind,x.opterr&&e.charAt(0)!==":"&&$t("illegal option -- "+x.optopt),"?";if(e.charAt(n+1)!==":")x.optarg=null,x.iplace===x.place.length&&++x.optind;else{if(x.iplace<x.place.length)x.optarg=x.place.substr(x.iplace);else if(t.length>++x.optind)x.optarg=t[x.optind];else return x.place="",x.iplace=0,e.charAt(0)===":"?":":x.opterr?($t("option requires an argument -- "+x.optopt),":"):"?";x.place="",x.iplace=0,++x.optind}return x.optopt}x.opterr=1;x.optind=0;x.optopt="";x.optreset=0;x.optarg="";Dt.exports=x});var yt=X((Ee,_t)=>{var F=qt();function H(t,e,n){if(typeof e=="function")return function(){return e.apply(this,arguments)||H.OK};let i=this;i.echo===void 0&&(i.echo=t.info);let a=[],o=/"([^"]*)"|'([^']*)'|\S+/g,r=async function(c){t.info(`Executing: ${c}`);let l=c.match(o).map(u=>u.replace(/^['"]|['"]$/g,"")),h=l.shift(),d=e[h];if(d===void 0){if(a.includes(h))try{let u=JSON.stringify(await n(c));return t.debug(`RPC Response: ${u}`),i.echo(u),H.OK}catch(u){return i.echo(u),H.ECMDERR}return i.echo(`${h}: no such command`),H.ENOTFOUND}let{func:y,opts:p,usage:w}=d,f=p;if(w&&(f=f?`${f}h`:"h"),f!==void 0){t.debug(`Parsing options: ${f} with ${l}`);let u={},g;for(F.optreset=1,F.optind=0;(g=F(l,f))!=="";)switch(t.debug(`Opt: ${g}, optarg: ${F.optarg}, optind: ${F.optind}`),g){case"h":return i.echo(`Usage: ${w}`),H.OK;case":":return i.echo(`${F.optopt}: option needs a value`),H.EBADARGS;case"?":return i.echo(`${F.optopt}: no such option`),H.EBADARGS;default:t.debug(`Switch: ${g}, optarg: ${F.optarg}`),u[g]=F.optarg||!0}y.opts=u,t.debug(`Switches: ${JSON.stringify(u)}`)}else F.optind=0;return t.debug(`Terms: ${l}`),await y.apply(this,l.slice(F.optind))??H.OK};return n!==void 0&&queueMicrotask(async function(){let c=await n("system.describe");t.debug(`system.describe result: ${c}`),JSON.parse(c).procs.forEach(l=>a.push(l)),e.help.rpcList=a,t.debug(`RPC List: ${a}`),Object.defineProperties(r,{login:{value:async function(l,h){t.info(`Attempting to log in user ${l}`);try{let d=await n(`login ${l} ${h}`);if(d===!1)return i.echo("Login failed"),H.NOTOKEN;let y=n;return r.exit??Object.defineProperty(r,"exit",{value:async function(){t.info("Logging out"),n=y,i.authState=H.NOTOKEN,i.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!0}}))}}),n=new Proxy(n,{apply:function(p,w,f){return p(f[0],d)}}),H.OK}catch(d){return t.error(d),d}}}})}),r}var Q=0;Object.defineProperties(H,{OK:{value:Q++},ENOTFOUND:{value:Q++},ECMDERR:{value:Q++},EBADARGS:{value:Q++},NOTOKEN:{value:Q++}});function fe(t,e){let n=0;return function(i,a){try{t.info(`Executing RPC: ${i}`);let o=i.trim().split(/\s+/),r=o.shift(),c=o;a&&(c={token:a,params:c}),t.debug(`Method: ${r}, params: ${c}`);try{return e.jsonrpc({id:n++,method:r,params:c}).then(l=>{let h=JSON.parse(l);if(t.debug(`Response: ${JSON.stringify(h)}`),h.error)throw new Error(h.error.message);return h.result})}catch(l){return t.error(l),l}}catch(o){return t.error(o),o}}}_t.exports={JSONRPCClient:fe,Executor:H}});var Ft=X(()=>{var{Executor:Y}=yt(),gt=(B(),z(U)).default,P=new gt("Terminal.js"),pe=100,ye=1e3,xt=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.parentTerminal=null,this.commandHistory=[],this.historyIndex=-1;let e=localStorage.getItem("commandHistory");e&&(this.commandHistory=JSON.parse(e),P.debug(`Loading command history (${this.commandHistory.length} items)`),this.historyIndex=this.commandHistory.length),this.inputHandler=this.inputHandler.bind(this),this.reset=this.reset.bind(this),this.addEventListener("terminal-reset",this.reset);let n=function(){P.debug("DOMContentLoaded event fired"),this.reset(new CustomEvent("terminal-reset",{detail:{clear:!0}})),document.removeEventListener("DOMContentLoaded",n)}.bind(this);document.addEventListener("DOMContentLoaded",n)}connectedCallback(){P.debug("Terminal connected")}disconnectedCallback(){P.debug("Terminal disconnected"),this.inputLine.removeEventListener("keydown",this.inputHandler),this.removeEventListener("click",this.focusHandler)}reset(e){if(P.debug(`Terminal reset (${this.parentTerminal?"sub-terminal":"main terminal"})`),P.debug(`Auth state: ${this.authState}, RPC enabled: ${this.rpcEnabled}`),this.rpcEnabled&&this.authState!==Y.OK)P.debug("logging in"),this.loginModal();else{let n=e.detail?.clear??!1;P.debug(`reset ${n?"and clear ":""}terminal`),this.uiModal(n)}this.focusHandler=function(){this.inputLine.focus()}.bind(this),this.addEventListener("click",this.focusHandler),this.focusHandler()}applyStyles(){let e=this.querySelector("style").cloneNode(!0);this.shadowRoot.appendChild(e)}loginModal(){this.shadowRoot.innerHTML="",this.applyStyles();let e=this.querySelector("template#login").content.cloneNode(!0);this.shadowRoot.appendChild(e),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.output=this.shadowRoot.querySelector(".output"),this.echo("Please log in");let n,i,a=async o=>{if(o.key==="Enter"){o.preventDefault();let r=(this.inputLine.value??this.inputLine.textContent).trim();if(n===void 0?n=r:i=r,n&&i)try{if(this.authState=await this.executor.login(n,i),P.debug(`Login state: ${this.authState}`),this.authState===Y.NOTOKEN){this.loginModal(),this.focusHandler();return}this.inputLine.removeEventListener("keydown",a),this.removeEventListener("click",this.focusHandler),this.reset(new CustomEvent("terminal-reset",{detail:{clear:!0}}))}catch(c){this.echo(c),P.error(c)}else{P.debug(`awaiting password for ${n}`);let c=document.createElement("input");c.type="password",c.classList.add("input-line"),this.inputLine.textContent=this.inputLine.value="",this.inputLine.removeEventListener("keydown",a),this.removeEventListener("click",this.focusHandler),this.inputLine.replaceWith(c),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.prompt="password:",this.inputLine.addEventListener("keydown",a),this.addEventListener("click",this.focusHandler),this.focusHandler()}}};this.inputLine.addEventListener("keydown",a)}uiModal(e){let n=this.shadowRoot.querySelector(".output")?.innerHTML;this.shadowRoot.innerHTML="",this.applyStyles();let i=this.querySelector("template#ui").content.cloneNode(!0);this.shadowRoot.appendChild(i),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.output=this.shadowRoot.querySelector(".output"),e&&this.greeting?(P.debug("clearing terminal"),this.echo(this.greeting)):this.output.innerHTML=n??"",this.inputLine.addEventListener("keydown",this.inputHandler),this.inputLine.focus()}get executor(){return this._executor}set executor(e){P.info("Setting executor"),this._executor=e}get greeting(){return this.getAttribute("greeting")}set greeting(e){e===void 0?this.removeAttribute("greeting"):this.setAttribute("greeting",e)}get prompt(){return this.shadowRoot.querySelector(".prompt").textContent}set prompt(e){let n=this.shadowRoot.querySelector(".prompt");n.innerHTML=`${e}&nbsp;`}get rpcEnabled(){return this.getAttribute("rpc")==="true"}inputHandler(e){switch(e.key){case"Enter":{e.preventDefault();let n=this.inputLine.textContent.trim();this.inputLine.textContent="",this.echo(`${this.prompt}${n}`),this.processCommand(n),this.historyIndex=this.commandHistory.length;break}case"ArrowUp":P.debug(`History index (back): ${this.historyIndex}`),this.historyIndex>0&&(this.historyIndex-=1,this.inputLine.textContent=this.commandHistory[this.historyIndex]);break;case"ArrowDown":P.debug(`History index (forward): ${this.historyIndex}`),this.historyIndex<this.commandHistory.length-1?(this.historyIndex+=1,this.inputLine.textContent=this.commandHistory[this.historyIndex]):(this.historyIndex=this.commandHistory.length,this.inputLine.textContent="");break}}async processCommand(e){try{let n=await this.executor(e);switch(P.debug(`Status: ${n}`),n){case Y.OK:P.debug(`${e} executed successfully`),e!==this.commandHistory[this.commandHistory.length-1]&&(this.commandHistory.push(e),this.commandHistory.length>pe&&this.commandHistory.shift(),localStorage.setItem("commandHistory",JSON.stringify(this.commandHistory)));break;case Y.ENOTFOUND:P.info(`${e} not found`);break;case Y.ECMDERR:P.error(`Error executing ${e}`);break;case Y.EBADARGS:P.warn(`${e} called with bad arguments`);break;default:P.error(`Unknown status: ${n} for ${e}`);break}}catch(n){P.error(n),this.echo(n)}}clear(){this.output.innerHTML=""}echo(e){for(e!=null&&e!==""&&(this.output.innerHTML+=`<div>${e}</div>`);this.output.children.length>ye;)this.output.removeChild(this.output.firstChild);this.inputLine.getBoundingClientRect().bottom>window.innerHeight&&this.inputLine.scrollIntoView({behavior:"smooth"})}log(e){gt.level==="debug"&&(typeof e=="string"?console.info(e):console.dir(e))}startSubTerminal(e){P.info(`Starting sub-terminal: ${e.name}`),this.removeEventListener("terminal-reset",this.reset);let n=new gt(`Executor.js (${e.name})`),i=document.createElement("ng-terminal");return i.innerHTML=this.innerHTML,i.greeting=e.greeting,i.executor=Y.bind(i)(n,e.registry),i.parentTerminal=this,this.replaceWith(i),i.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!0}})),e.prompt!==void 0&&(i.prompt=e.prompt),i}exitSubTerminal(){this.parentTerminal?(P.info("Exiting sub-terminal"),P.debug(`Parent terminal: ${JSON.stringify(this.parentTerminal)}`),this.parentTerminal.addEventListener("terminal-reset",this.parentTerminal.reset),this.replaceWith(this.parentTerminal),this.parentTerminal.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!1}}))):P.warn("No parent terminal found")}};customElements.define("ng-terminal",xt)});var nt=X((Oe,jt)=>{var ge=(B(),z(U)).default,G=new ge("Renderer.js");function mt(t,e){if(!new.target)return new mt(...arguments);let n=t.pixels.toArray(),i=n.length,a=new Proxy(t,{get:function(o,r,c){if(typeof r=="string"&&!isNaN(r)){let l=+r;if(Number.isInteger(l)&&l>=0&&l<i)return n[l]}else return Reflect.get(o,r,c)},set:function(o,r,c,l){if(typeof r=="string"&&!isNaN(r)){let h=+r;Number.isInteger(h)&&h>=0&&h<i&&(n[h]=Array.isArray(c)?e.color.apply(this,c):c)}else return Reflect.set(o,r,c,l)}});return t.loaded=!0,Object.defineProperties(a,{blit:{value:function(o,r){t.pixels.set(n),e.image(t,o,r)}},length:{value:n.length},update:{value:function(){t.pixels.set(n)}}}),a}function wt(t){if(!new.target)return new wt(...arguments);let e=0,n=[];Object.defineProperties(n,{flip:{value:function(){e^=1}},read:{get:function(){return this[e^1]}},write:{get:function(){return this[e]}}});let i=t.createImage();n.push({buffer:i,get pixels(){return i.pixels.toArray()}});let a=t.createImage();n.push({buffer:a,get pixels(){return a.pixels.toArray()}}),Object.defineProperties(this,{flip:{value:function(){let r=n.write.buffer;r.update(),t.background(r),n.flip()}},readBuffer:{get:function(){return n.read.pixels}},writeBuffer:{get:function(){return n.write.buffer}}})}function Z(t){if(Z.instance!==void 0)return Z.instance;if(!new.target)return new Z(...arguments);let e=new Proxy(this,{get:function(a,o){return a[o]??i[o]}});Object.defineProperty(Z,"instance",{value:e});let n={background:4278849802,frameRate:60,height:t.height,width:t.width},i;return Object.defineProperties(this,{createImage:{value:function(a,o){let r=i.createImage(a??t.width,o??t.height);return new mt(r,i)}},frame:{set:function(a){G.debug("pjs.draw set"),Object.defineProperty(i,"draw",{value:a,writable:!0})}},doubleBuffer:{value:function(){return new wt(this)}},init:{value:function(a){if(i!==void 0){i.exit(),i=void 0;let r=document.createElement("canvas");t.replaceWith(r),t=r}let o=Object.assign({},n,a);i=new Processing(t,r=>{G.info("Processing.js created"),G.debug(`canvas width (${t.width}) height (${t.height})`),Object.defineProperties(r,{keyPressed:{value:function(){switch(r.keyCode){case r.UP:r.loop();break;case r.DOWN:r.noLoop();break;case r.LEFT:r.save("image.png");break;case r.RIGHT:r.redraw()}},writable:!0},setup:{value:function(){r.size(o.width,o.height,r[o.renderer]),G.debug(`processingjs width (${r.width}) height (${r.height}) ${r.use3DContext}`),r.frameRate(o.frameRate),r.noLoop(),r.background(o.background),G.info("Processing.js setup")},writable:!0}})})}},input:{set:function(a){G.debug("keyPressed set"),Object.defineProperty(i,"keyPressed",{value:a,writable:!0})}},pixelHeight:{get:function(){return 0}},pixelWidth:{get:function(){return 0}},showFrameRate:{value:function(){}},showRuler:{set:function(){}}}),this.init(),e}jt.exports={DoubleBuffer:wt,Image:mt,Renderer:Z}});var Yt=X((Ce,Xt)=>{function W(){if(W.instance instanceof W)return W.instance;if(!new.target)return new W(...arguments);Object.defineProperty(W,"instance",{value:this});let t=Math.PI/180;Object.defineProperties(this,{cos:{value:{},enumerable:!0},sin:{value:{},enumerable:!0}});for(let e=0;e<=360;++e)Object.defineProperty(this.cos,e,{value:Math.cos(e*t)}),Object.defineProperty(this.sin,e,{value:Math.sin(e*t)})}var tt=Object.freeze({addColors:(...t)=>t.length===0?[]:t[0].map((e,n)=>t.reduce((i,a)=>i+a[n],0)),decodeColor:t=>[t>>16&255,t>>8&255,t&255,t>>>24],direction:(t,e,n,i)=>Math.atan2(i-e,n-t),distance:(t,e,n,i)=>Math.hypot(Math.abs(n-t),Math.abs(i-e)),fastInvSqrt:t=>{let n=new Float32Array([t]),i=new Float32Array([t]),a=new Int32Array(n.buffer);return a[0]=1597463007-(a[0]>>1),i[0]=n[0],i[0]=i[0]*(1.5-t*.5*i[0]*i[0]),i[0]},fastTrig:W(),invSqrt:t=>1/Math.sqrt(t),randomColor:(t=!1)=>{let e=Array.from({length:3},()=>tt.roll(255));return e.push(t?tt.roll(255):255),e},randomGrayscale:(t=!1)=>{let e=tt.roll(255),n=Array.from({length:3},()=>e);return n.push(t?tt.roll(255):255),n},range:(t,e)=>{let n=Math.random()*(e-t);return Number.isInteger(t)&&Number.isInteger(e)&&(n=Math.floor(n)),n+t},roll:t=>Math.floor(Math.random()*t)});Xt.exports=tt});var Gt=X((Te,Bt)=>{function Ut(t,e){if(!new.target)return new Ut(...arguments);let n=2,i=new a;i.next=new a,i.prev=i.next,i.prev.next=i,i.prev.prev=i,i.active=!1,i.prev.active=!1,this.ACCELERATION=[0,.25],this.ELASTICITY=.2,this.SHAPE="point",this.MAX_COUNT=3e3,Object.defineProperties(this,{count:{get:function(){return n}},createParticle:{value:function(o,r,c,l,h,d,y,p,w){if(i.prev.active){if(n>=this.MAX_COUNT)return;let f=new a(o,r,c,l,h,d,y,p,w);f.next=i,f.prev=i.prev,f.prev.next=f,i.prev=f,i=f,++n}else{let f=i.prev;f.activate(o,r,c,l,h,d,y,p,w),i=f}}},list:{get:function(){return i}},render:{value:function(){let o=i;for(;o.active;){e.call(o,this),t.stroke(o.r,o.g,o.b,o.a),t[this.SHAPE](o.x,o.y,2,2);let r=o;if(o.ttl>0&&++o.t>=o.ttl&&(o.active=!1),o=o.next,o===i)break;r.active||(r===i?i=r.next:(r.next.prev=r.prev,r.prev.next=r.next,r.next=i,r.prev=i.prev,i.prev.next=r,i.prev=r))}}}});function a(o,r,c,l,h,d,y,p,w){if(!new.target)return new a(...arguments);Object.defineProperties(this,{activate:{value:function(f,u,g,b,E,A,T,O,S){this.active=!0,this.ttl=f,this.t=0,this.x=u,this.y=g,this.dx=b,this.dy=E,this.ddx=0,this.ddy=0,this.dddx=0,this.dddy=0,this.r=A,this.g=T,this.b=O,this.a=S}}}),this.activate(o,r,c,l,h,d,y,p,w)}}Bt.exports=Ut});var Kt=X((Se,Jt)=>{var m=Yt(),$=Gt(),s=nt().Renderer();function Wt(t,e,n,i){let a=i%t,o=Math.floor(i/t),r=n,c=Math.floor(a/e)%2==0,l=Math.floor(o/e)%2==0;return c!=l&&(r=0),[r,r,r,255]}var xe={"3d":function(){s.init({renderer:"P3D"});let t=s.width,e=s.height,n=0,i=255,a=255,o=255;s.frame=function(){s.background(0),s.camera(t/2,e/5,200,t/2,e/2,0,0,1,0),s.pointLight(i,a/10,o/10,t/3,e/3,100),s.pointLight(i/10,a,o/10,300,t/3,100),s.pointLight(i/10,a/10,o,300,300,-100),s.pointLight(i,a,o,t/3,300,-100),s.translate(t/2,e/2),s.rotateY(n),s.normal(0,0,1),s.fill(128),s.rect(-100,-100,200,200),n+=.01},s.loop()},ants:function(){let t=s.width,e=s.height,n=200,i=1,a=s.createImage();a.update();let o=new $(s,function(r){let c=r.list,l=c;for(;l.active;){if(l===this){if(l=l.next,l===c)break;continue}if(l=l.next,l===c)break}this.last??=m.roll(60),this.last++>60&&(this.ddx=m.range(-.05,.05),this.ddy=m.range(-.05,.05),this.last=0),this.dx+=this.ddx,this.dy+=this.ddy;let h=Math.hypot(this.dx,this.dy);h>i&&(this.dx=this.dx/h*i,this.dy=this.dy/h*i);let d=this.x-3*this.dx,y=this.y-3*this.dy;this.x+=this.dx,this.y+=this.dy,s.line(this.x,this.y,d,y),this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-1?(this.y=e-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1)});for(let r=0;r<n;++r)o.createParticle(0,m.range(1e-4,t),m.range(1e-4,e),0,0,207,16,32);s.stroke(0,0,0,255),s.frame=function(){s.background(a),o.render()},s.loop()},boids:function(){let t=s.width,e=s.height,n=t/2,i=e/2,a=200,o=3,r=5e-4,c=100,l=40,h=1,d=1.25,y=1,p=.75,w=new $(s,function(u){let g=0,b=0,E=0,A=0,T=0,O=0,S=0,I=0,C=0,v=0,L=u.list,M=L;for(;M.active;){if(M===this){if(M=M.next,M===L)break;continue}let R=Math.hypot(this.x-M.x,this.y-M.y);if(R<c&&(g+=M.dx,b+=M.dy,E+=M.x,A+=M.y,C++),R<l){let k=(l-R)/l;T+=(this.x-M.x)*k,O+=(this.y-M.y)*k,v++}if(M=M.next,M===L)break}if(C>0){g/=C,b/=C;let R=Math.hypot(g,b);R>0&&(g=g/R*r*h,b=b/R*r*h),E=(E/C-this.x)*r*d,A=(A/C-this.y)*r*d}if(v>0){T/=v,O/=v;let R=Math.hypot(T,O);R>0&&(T=T/R*r*y,O=O/R*r*y)}if(Math.random()>p){let R=Math.atan2(this.dy,this.dx)+m.range(-.1,.1),k=Math.hypot(this.dx,this.dy);S=k*Math.cos(R)-this.dx,I=k*Math.sin(R)-this.dy}this.ddx=g+E+T+S,this.ddy=b+A+O+I,this.dx+=this.ddx,this.dy+=this.ddy;let q=Math.hypot(this.dx,this.dy);q>o&&(this.dx=this.dx/q*o,this.dy=this.dy/q*o);let _=this.x-3*this.dx,j=this.y-3*this.dy;this.x+=this.dx,this.y+=this.dy,s.line(this.x,this.y,_,j),this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-1?(this.y=e-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1)}),f=m.range(0,2*Math.PI);for(let u=0;u<a;++u){let g=m.range(.001,1)*o,b=m.range(-.1,.1);w.createParticle(0,m.range(n-10.01,n+10),m.range(i-10.01,i+10),g*Math.cos(b+f),g*Math.sin(b+f),...m.randomColor())}s.stroke(0,0,0,255),s.frame=function(){s.background(0),w.render()},s.loop()},bz:function(){let t=s.width,e=Array.from({length:8},()=>Math.random()*t),n=Array.from({length:8},()=>Math.random()*t),i=Array.from({length:8},()=>Math.random()*15);s.background(255),s.noFill(),s.frame=function(){s.stroke(0,0,0,20),e.map(function(a,o,r){let c=a+i[o];c<0?(c=0,i[o]*=-1):c>t&&(c=t,i[o]*=-1),r[o]=c}),s.bezier.apply(null,e),s.stroke(255,128,128,20),n.map(function(a,o,r){let c=a+i[o];c<0?(c=0,i[o]*=-1):c>t&&(c=t,i[o]*=-1),r[o]=c}),s.bezier.apply(null,n)},s.loop()},cell:function(t=30,e=!1,n=200,i=200){s.init({background:0,frameRate:400,height:+i,width:+n});let a=s.width,o=s.height,r=1,c=0,l=new Array(a*o).fill(c),h=(p=>{let w=p.toString(2).padStart(8,"0"),f=[];for(let u=0;u<8;++u)+w[7-u]&&f.push(u);return(u,g)=>{let b=(g-1)*a+u,E=parseInt([l[b-1],l[b],l[b+1]].join(""),2);return f.some(A=>E===A)?r:c}})(+t);if(s.stroke(255),e&&e!=="false")for(let p=0;p<a;++p)l[p]=Math.random()>.5?r:c,s.point(p,0);else l[a/2]=r,s.point(a/2,0);let d=0,y=l.length/a;s.frame=function(){for(let p=0;p<a;++p){let w=h(p,d);w&&(l[d*a+p]=w,s.point(p,d))}d!==y&&d++},s.loop()},chaos:function(t="3"){s.init({frameRate:400});let e=s.width,n=s.height,i=e/2,a=n/2,o=i-50,r=Math.PI/180,c={3:[{x:e/2,y:50},{x:50,y:n-50},{x:e-50,y:n-50}],5:[{x:e-50,y:50},{x:50,y:50},{x:50,y:n-50},{x:e-50,y:n-50},{x:i,y:a}],6:[{x:Math.cos(0)*o+i,y:Math.sin(0)*o+a},{x:Math.cos(60*r)*o+i,y:Math.sin(60*r)*o+a},{x:Math.cos(120*r)*o+i,y:Math.sin(120*r)*o+a},{x:Math.cos(180*r)*o+i,y:Math.sin(180*r)*o+a},{x:Math.cos(240*r)*o+i,y:Math.sin(240*r)*o+a},{x:Math.cos(300*r)*o+i,y:Math.sin(300*r)*o+a}]}[t],l={3:2,5:1.5,6:1.5}[t];s.background(0),s.stroke(255,255,255,255);for(let{x:y,y:p}of c)s.point(y,p);let h=Math.random()*e,d=Math.random()*n;s.frame=function(){let y=m.roll(c.length);h+=(c[y].x-h)/l,d+=(c[y].y-d)/l,s.point(h,d)},s.loop()},fire:function(){s.init({background:0,frameRate:60,height:300,width:300});let t=s.width,e=s.doubleBuffer(),n=e.writeBuffer;for(let o=0;o<n.length;++o)n[o]=[0,0,0,255];e.flip(),n=e.writeBuffer;for(let o=0;o<n.length;++o)n[o]=[0,0,0,255];e.flip();let i=e.readBuffer.length/t,a=s.color(255,128,96);s.frame=function(){let o=e.readBuffer,r=e.writeBuffer;for(let c=t;c<r.length-t;++c){if(c%t<1||c%t>=t-1)continue;let l=c/t;if(Math.random()<Math.pow(Math.E,Math.pow(l/i,4))-1&&Math.random()>.975){r[c]=a;continue}r[c]=m.addColors(m.decodeColor(o[c-1]),m.decodeColor(o[c]),m.decodeColor(o[c]),m.decodeColor(o[c+1]),m.decodeColor(o[c+t])).map((h,d)=>{if(d===3)return 255;let y=h/5.25;return y<10?0:y})}e.flip()},s.loop()},fireworks:function(){let t=s.width,e=s.height,n=new $(s,function(){this.dx+=n.ACCELERATION[0],this.dy+=n.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let h=1-this.t/this.ttl;this.r=255*Math.pow(h,.2),this.g=255*h*h,this.b=255*h*h*h*h,this.a=255*h}),i=new $(s,function(){this.dx+=i.ACCELERATION[0],this.dy+=i.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let h=1-this.t/this.ttl;this.b=255*Math.pow(h,.2),this.g=255*h*h,this.r=255*h*h*h*h,this.a=255*h}),a=new $(s,function(){this.dx+=a.ACCELERATION[0],this.dy+=a.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let h=1-this.t/this.ttl;this.g=255*Math.pow(h,.2),this.r=255*h*h,this.b=255*h*h*h*h,this.a=255*h}),o=new $(s,function(){this.dx+=o.ACCELERATION[0],this.dy+=o.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let h=1-this.t/this.ttl;this.r=255*Math.pow(h,.2),this.g=255*Math.pow(h,.2),this.b=255*h*h*h*h,this.a=255*h}),r=new $(s,function(){this.dx+=r.ACCELERATION[0],this.dy+=r.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let h=1-this.t/this.ttl;this.r=255*Math.pow(h,.2),this.b=255*h*h*h*h,this.g=255*h,this.a=255*h}),c=new $(s,function(){this.dx+=c.ACCELERATION[0],this.dy+=c.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let h=1-this.t/this.ttl;this.r=255*Math.pow(h,.2),this.b=255*Math.pow(h,.2),this.g=255*h*h*h*h,this.a=255*h});n.ACCELERATION=[0,.15],i.ACCELERATION=[0,.15],a.ACCELERATION=[0,.15],o.ACCELERATION=[0,.15],r.ACCELERATION=[0,.15],c.ACCELERATION=[0,.15];function l(h,d){let y;switch(m.range(0,5)){case 0:y=n;break;case 1:y=i;break;case 2:y=a;break;case 3:y=o;break;case 4:y=c;break;case 5:y=r;break}for(let p=0;p<300;++p){let w=m.range(0,Math.PI*2),f=m.range(.001,10);y.createParticle(m.range(50.001,100),h,d,Math.cos(w)*f,Math.sin(w)*f,0,0,0,0)}}s.frame=function(){s.background(0),Math.random()>.95&&l(m.range(.001,t),m.range(.001,e/2)),n.render(),i.render(),a.render(),o.render(),c.render(),r.render()},s.loop()},fountain:function(){let t=s.width,e=s.height,n=new $(s,function(){this.dx+=n.ACCELERATION[0],this.dy+=n.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let o=1-this.t/this.ttl;this.r=255*Math.pow(o,.2),this.g=255*o*o,this.b=255*o*o*o*o,this.a=255*Math.pow(o,.2),this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-2?(this.dy<.25?this.y=e-1:this.y=e-2,this.dy*=-1.2*Math.random()*n.ELASTICITY,Math.random()<.5?this.dx-=this.dy:this.dx+=this.dy):this.y<0&&(this.y=0,this.dy*=-1*n.ELASTICITY),this.y===e-1&&(this.active=!1)}),i=-20.01,a=[255,255,255,255];s.frame=function(){s.background(0);for(let o=0;o<15;++o){let r=m.range(-.098,.098),c=m.range(i,.8*i);n.createParticle(m.range(10,30.01)*-c,t/2,e-20,Math.sin(r)*c,Math.cos(r)*c,...a)}n.render()},s.loop()},graviton:function(t=3.4,e=20){let n=s.width,i=s.height,a=n/2,o=i/2,r=25,c=+e,l=5,h=1.5,d=+t,y=new $(s,function(p){let w=0,f=0,u=p.list,g=u;for(;g.active;){if(g===this){if(g=g.next,g===u)break;continue}let I=m.distance(this.x,this.y,g.x,g.y),C=m.direction(this.x,this.y,g.x,g.y),v=d/(I/1.25)**h,L=v*Math.cos(C),M=v*Math.sin(C);if(I<1){let q=m.direction(this.x,this.y,g.x,g.y),_=Math.cos(q),j=Math.sin(q),R=Math.hypot(this.dx,this.dy),k=Math.hypot(g.dx,g.dy);this.dx=k*_,this.dy=k*j,g.dx=R*_,g.dy=R*j;break}else I<3?(w+=-L*2,f+=-M*2):(w+=L,f+=M);if(g=g.next,g===u)break}this.ddx=w,this.ddy=f;let b=m.direction(this.x,this.y,a,o),E=m.distance(this.x,this.y,a,o),A=d*2/(E/4)**h,T=A*Math.cos(b),O=A*Math.sin(b);E<r?(this.ddx+=-O*2,this.ddy+=-T*2):(this.ddx+=T,this.ddy+=O),this.dx+=this.ddx,this.dy+=this.ddy;let S=Math.hypot(this.dx,this.dy);S>l&&(this.dx=this.dx/S*l,this.dy=this.dy/S*l),this.x+=this.dx,this.y+=this.dy,this.x>=n-1?(this.x=n-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=i-1?(this.y=i-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1),this.x===0&&this.y===0&&(this.x=m.roll(n),this.y=m.roll(i))});y.SHAPE="ellipse";for(let p=0;p<c;++p){let w=l,f=1.25+m.range(-.088,.088);y.createParticle(0,m.roll(a-100),m.roll(o),w*Math.cos(f),w*Math.sin(f),255,255,196)}s.stroke(0,0,0,255),s.frame=function(){s.background(0),y.render(),s.fill(255,255,200),s.stroke(255,255,0),s.ellipse(a,o,r,r)},s.loop()},lens:function(t=150,e=30){t=+t,e=+e;let n=s.width,i=s.createImage(),a=i.height;for(let u=0;u<i.length;++u)i[u]=Wt(a,a/32,255,u);i.update();let o=s.createImage(t,t),r=new Array(t*t).fill(0),c=Math.round(t/2),l=c*c,h=c*(t+1),d;for(let u=0;u<l;++u){let g=u%c,b=Math.floor(u/c),E=g*g,A=b*b,T=0,O=0;if(E+A<l){let S=e/Math.sqrt(e*e-(E+A-l));T=Math.floor(g*S)-g,O=Math.floor(b*S)-b}d=O*n+T,r[h-b*t-g]=-d,r[h+b*t+g]=d,d=-O*n+T,r[h-b*t+g]=d,r[h+b*t-g]=-d}let y=n/2,p=n/2,w=1,f=2;s.frame=function(){y+=w,p+=f,y<0&&(y=0,w=-w),y>n-t&&(y=n-t,w=-w),p<0&&(p=0,f=-f),p>n-t&&(p=n-t,f=-f),s.background(i);let u=p*n+y;for(let g=0;g<t*t;++g)o[g]=i[Math.round(u)+Math.floor(g/t)*n+g%t+r[g]];o.blit(y,p)},s.loop()},life:function(t=300,e=300){s.init({background:0,frameRate:12,height:+e,width:+t});let n=s.width,i=s.height,a=.05,o=0,r=1,c=1,l=0,h=-1,d=Array.from(Array(n*i)).map(()=>Array.from(Array(2)));d.forEach(p=>{p[o]=l,p[r]=Math.random()<a?c:l});function y(p){let w=p%n,f=Math.floor(p/n),u=0;return f>0&&(w>0&&(u+=d[p-n-1][o]),w<n-1&&(u+=d[p-n+1][o]),u+=d[p-n][o]),f<i-1&&(w>0&&(u+=d[p+n-1][o]),w<n-1&&(u+=d[p+n+1][o]),u+=d[p+n][o]),w>0&&(u+=d[p-1][o]),w<n-1&&(u+=d[p+1][o]),u}s.stroke(255),s.frame=function(){s.background(0),d.forEach((p,w)=>{let f=d[w];if(p[r]===c||p[o]===c){f[o]=c;let E=w%n,A=w/n;s.point(E,A)}p[r]===h&&(f[o]=l),f[r]=l;let u=w-3*n;if(u<0)return;let g=d[u],b=y(u);b===3&&g[o]===l&&(g[r]=c),(b<2||b>3)&&g[o]===c&&(g[r]=h)})},s.loop()},pattern:function(t){let e=s.createImage(),n=e.height;for(let h=0;h<e.length;++h)e[h]=Wt(n,n/8,255,h);if(e.update(),s.background(e),t===void 0)return;let i=s.PVector.bind(s),a=20,o=360,r=s.width/2,c=s.height/2,l=Math.hypot(100,100);s.frame=()=>{s.background(0);let h=Math.PI/o*s.frameCount,d=Math.cos(h),y=Math.sin(h),p=Math.PI/a*s.frameCount,w=Math.cos(p),f=Math.sin(p),u=-f,g=w,b=new i(r,c),E=new i(d,y);E.setMag(l),E.add(b);let A=new i(d,y),T=new i(d,y);A.setMag(l*.33),T.setMag(l*.66);let O=new i(u,g);O.setMag(A.mag()*.5),O.add(A),O.add(b);let S=new i(w,f);S.setMag(T.mag()*.5),S.add(T),S.add(b);let I=new i(E.x,E.y);I.sub(b);let C=new i(O.x,O.y);C.sub(b);let v=(I.x*C.y-I.y*C.x)/I.mag()*1.5,L=new i(b.x,b.y);L.sub(E);let M=new i(-L.y,L.x);switch(M.setMag(v),M.add(E),s.fill(0,0,0,0),t){case"circles":case"full":if(s.stroke(255,0,0,255),s.line(b.x,b.y,E.x,E.y),s.ellipse(b.x+A.x,b.y+A.y,A.mag(),A.mag()),s.ellipse(b.x+T.x,b.y+T.y,T.mag(),T.mag()),s.stroke(0,255,0,255),s.line(b.x+A.x,b.y+A.y,O.x,O.y),s.line(b.x+T.x,b.y+T.y,S.x,S.y),s.line(E.x,E.y,M.x,M.y),s.ellipse(O.x,O.y,3,3),s.ellipse(S.x,S.y,3,3),s.ellipse(M.x,M.y,3,3),t==="circles")break;case"tail":s.stroke(255,255,255,255),s.bezier(b.x,b.y,O.x,O.y,S.x,S.y,M.x,M.y)}},s.loop()},plasma:function(){s.init({background:0,height:300,width:300});let t=s.width,e=s.height,n=s.createImage(),i={},a={};function o(f){let u=1-f/255,g=255*u,b=255*u*u;return[255*u*u*u*u,b,g,255]}for(let f=0;f<256;++f)a[f]=o(f);for(let f=0;f<512;++f){let u=f*.703125*.0174532;i[f]=Math.sin(u)*1024}let r=0,c=0,l=0,h=0,d=0,y=0,p=0,w=0;s.frame=function(){p=l,w=h;for(let f=0;f<e;++f){d=r+5,y=c+3,p&=511,w&=511;for(let u=0;u<t;++u){d&=511,y&=511;let b=128+(i[d]+i[y]+i[p]+i[w]>>4);n[f*t+u]=a[b],d+=5,y+=3}p+=1,w+=3}r+=9,l+=8,n.update(),s.background(n)},s.loop()},rod:function(){let t=s.width,e=s.height,n=t/2,i=e/2,a=t/2+m.range(-100,100.01),o=t/2+m.range(-100,100.01),r=m.roll(-3.01,3),c=m.roll(-3.01,3),l,h,d=20,y=12,p=5,w=200,f=3,u=5e-4,g=100,b=40,E=.75,A=.5,T=3,O=.66,S=new $(s,function(C){let v={x:0,y:0},L={x:0,y:0},M={x:0,y:0},q={x:0,y:0},_=0,j=0,R=C.list,k=R;for(;k.active;){if(k===this){if(k=k.next,k===R)break;continue}let N=Math.hypot(this.x-k.x,this.y-k.y);if(N<g&&(v.x+=k.dx,v.y+=k.dy,L.x+=k.x,L.y+=k.y,_++),N<b){let K=(b-N)/b;M.x+=(this.x-k.x)*K,M.y+=(this.y-k.y)*K,j++}if(k=k.next,k===R)break}if(l+=this.x,h+=this.y,_>0){v.x/=_,v.y/=_;let N=Math.hypot(v.x,v.y);N>0&&(v.x=v.x/N*u*E,v.y=v.y/N*u*E),L.x=(L.x/_-this.x)*u*A,L.y=(L.y/_-this.y)*u*A}if(j>0){M.x/=j,M.y/=j;let N=Math.hypot(M.x,M.y);N>0&&(M.x=M.x/N*u*T,M.y=M.y/N*u*T)}if(Math.random()>O){let N=Math.atan2(this.dy,this.dx)+m.range(-.1,.1),K=Math.hypot(this.dx,this.dy);q.x=K*Math.cos(N)-this.dx,q.y=K*Math.sin(N)-this.dy}this.ddx=v.x+L.x+M.x+q.x+(a-this.x)*1e-4,this.ddy=v.y+L.y+M.y+q.y+(o-this.y)*1e-4,m.distance(this.x,this.y,a,o)<50&&(this.ddx+=(a-this.x)*.01,this.ddy+=(o-this.y)*.01),this.dx+=this.ddx,this.dy+=this.ddy;let ot=Math.hypot(this.dx,this.dy);ot>f&&(this.dx=this.dx/ot*f,this.dy=this.dy/ot*f),this.x+=this.dx,this.y+=this.dy;let Et=m.direction(this.x,this.y,this.x-this.dx,this.y-this.dy),rt=Math.cos(Et),at=Math.sin(Et),At=.33*y,Lt=.66*y,ct=At*rt,ht=At*at,lt=Lt*rt,dt=Lt*at,Ot=this.x+y*rt,Ct=this.y+y*at;this.unique??=m.roll(Math.PI/2);let Tt=Math.PI/p*s.frameCount+this.unique,et=Math.cos(Tt),J=Math.sin(Tt),Qt=this.x+ct+.5*(ct*-J-ht*et),Zt=this.y+ht+.5*(ct*et+ht*-J),te=this.x+lt+.5*(lt*et-dt*J),ee=this.y+dt+.5*(lt*J+dt*et),St=this.x-Ot,Pt=this.y-Ct,kt=Math.hypot(St,Pt),ne=-Pt/kt,ie=St/kt,It=J*3,se=Ot+ne*It,oe=Ct+ie*It;s.bezier(this.x,this.y,Qt,Zt,te,ee,se,oe),this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-1?(this.y=e-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1)});S.SHAPE="ellipse";let I=m.range(0,2*Math.PI);for(let C=0;C<w;++C){let v=m.range(.001,1)*f,L=m.range(-.1,.1);S.createParticle(0,m.range(n-10.01,n+10),m.range(i-10.01,i+10),v*Math.cos(L+I),v*Math.sin(L+I),255,255,255,255)}s.frame=function(){l=0,h=0,s.background(0),s.fill(0,0,0,0),s.stroke(255,255,255,255),S.render(),l/=S.count,h/=S.count,r+=-(l-a)*1e-4+(n-a)*1e-4,c+=-(h-o)*1e-4+(i-o)*1e-4;let C=Math.hypot(r,c);C>f*1.4&&(r=r/C*f*1.4,c=c/C*f*1.4),a+=r,o+=c,a<0&&(a=0,r=-r),a>t-d&&(a=t-d,r=-r),o<0&&(o=0,c=-c),o>e-d&&(o=e-d,c=-c),s.stroke(196,128,196),s.fill(255,128,164,128),s.ellipse(a,o,d,d)},s.loop()},snow:function(){let t=s.width,e=s.height,n=new $(s,function(){this.x+=this.dx,this.y+=this.dy,(this.x>=t-1||this.y>=e-1||this.y<0)&&(this.active=!1)});s.frame=function(){s.background(0),n.createParticle(0,m.range(-t/2,t-1),0,m.range(0,.25),m.range(.4,.6),255,255,255,m.range(96,255)),n.render()},s.loop()},spiro:function(t=!0,e=!1,n=!0){let i=s.width,a=s.height,o=s.PVector.bind(s),r=new o(i/2,a/2),c=new o(0,0),l=new o(0,0),h=n==="false"?360:36,d=i/2,y=100,p=m.roll(y),w=m.roll(d),f=Math.random(),u=Math.random(),g=(y+p)/p,b=(d-w)/w;s.frame=function(){let E=Math.PI/h*s.frameCount,A=Math.cos(E),T=Math.sin(E),O=Math.PI/h*s.frameCount*g,S=-Math.PI/h*s.frameCount*b,I=new o(A,T);I.setMag(d-w),I.add(r);let C=new o(A,T);C.setMag(y+p),C.add(r);let v=new o(Math.cos(O),Math.sin(O));v.setMag(p*f),v.add(C);let L=new o(Math.cos(S),Math.sin(S));L.setMag(w*u),L.add(I),n==="false"?(s.background(0),s.fill(0,0,0,0),s.stroke(0,255,0,255),s.ellipse(r.x,r.y,d*2,d*2),s.ellipse(r.x,r.y,y*2,y*2),t&&t!=="false"&&(s.stroke(255,255,255,255),s.line(r.x,r.y,I.x,I.y),s.line(I.x,I.y,L.x,L.y),s.stroke(255,0,0,255),s.ellipse(I.x,I.y,w*2,w*2),s.ellipse(L.x,L.y,2,2)),e&&e!=="false"&&(s.stroke(255,255,255,255),s.line(r.x,r.y,C.x,C.y),s.line(C.x,C.y,v.x,v.y),s.stroke(255,0,0,255),s.ellipse(C.x,C.y,p*2,p*2),s.ellipse(v.x,v.y,2,2))):(s.stroke(255,255,255,255),t&&t!=="false"&&(l.mag()===0&&l.set(L),s.line(l.x,l.y,L.x,L.y),l.set(L)),s.stroke(128,255,128,255),e&&e!=="false"&&(c.mag()===0&&c.set(v),s.line(c.x,c.y,v.x,v.y),c.set(v)))},s.loop()},stars:function(){let t=s.width,e=s.height,n=t/2,i=e/2,a=n*.75,o=new $(s,function(){let r=this.x-3*this.dx,c=this.y-3*this.dy;this.x+=this.dx,this.y+=this.dy,s.line(this.x,this.y,r,c),(this.x>=t-1||this.y>=e-1||this.x<0||this.y<0)&&(this.active=!1);let l=Math.hypot(this.dx,this.dy),h=Math.min(m.distance(this.x,this.y,n,i),n);this.a=128*Math.max(1-h/a,0)+64*(l/10)+64*Math.max(1-this.t++,0)});s.frame=function(){s.background(0);for(let r=0;r<20;++r){let c=(m.roll(t)+m.roll(t))/2,l=m.roll(e)+m.roll(e)/2,h=Math.min(m.distance(c,l,n,i),n),d=-Math.atan2(i-l,c-n),y=10*(h/n)+1;o.createParticle(0,c,l,Math.cos(d)*y,Math.sin(d)*y,255,255,255,0)}o.render()},s.loop()}};Jt.exports=xe});var Vt=X((Pe,zt)=>{var it=Kt(),st=nt().Renderer(),bt=Object.freeze({cat:{func:function(t){this.echo(it[t].toString())},man:"Print code listing for [demo]"},clear:{func:function(){this.clear()}},help:{func:function(t){t===void 0?(this.echo("Available commands:"),Object.keys(bt).forEach(e=>this.echo(e))):this.echo(bt[t].man)},man:"Print help text for [command].  If no command is passed, list available commands.",usage:"help [command]"},init:{func:function(){st.init()}},load:{func:function(t,...e){t in it&&(this.echo(`Loading ${t}\u2026`),st.init(),it[t].apply(this,e))},man:"Load a demo.  Some demos accept additional arguments.\n<b>Example:</b>\n`load chaos 6`.",usage:"load [demo] [args]"},ls:{func:function(){this.echo("Available demos:"),Object.keys(it).filter(t=>t!=="rod").forEach(t=>this.echo(t))},man:"List available demos"},properties:{func:function(t){t===void 0&&this.echo(JSON.stringify(st,null,2)),this.echo(st[t])}}});zt.exports=bt});var vt=(B(),z(U)).default,{Executor:me}=yt();Ft();var{Renderer:we}=nt();vt.setLogLevel("debug");var Mt=new vt("index.js");window.addEventListener("load",()=>{Mt.info("Creating renderer");let t=document.querySelector("canvas"),e=t.getBoundingClientRect();t.width=e.width,t.height=e.height,Mt.debug(`initial canvas width (${t.width}) height (${t.height})`),we(t),Mt.info("Creating executor");let n=document.querySelector("ng-terminal"),i=new vt("Executor.js");n.executor=me.bind(n)(i,Vt())});})();
