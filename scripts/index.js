(()=>{var lt=Object.defineProperty;var ee=Object.getOwnPropertyDescriptor;var ie=Object.getOwnPropertyNames;var ne=Object.prototype.hasOwnProperty;var tt=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,i)=>(typeof require<"u"?require:e)[i]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var se=(t,e)=>()=>(t&&(e=t(t=0)),e);var Y=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),re=(t,e)=>{for(var i in e)lt(t,i,{get:e[i],enumerable:!0})},oe=(t,e,i,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of ie(e))!ne.call(t,n)&&n!==i&&lt(t,n,{get:()=>e[n],enumerable:!(r=ee(e,n))||r.enumerable});return t};var et=t=>oe(lt({},"__esModule",{value:!0}),t);var K={};re(K,{APITransport:()=>Lt,ConsoleTransport:()=>ut,FileTransport:()=>kt,default:()=>D,interpolate:()=>At});function D(t){if(t===void 0)throw new Error("Logger requires the file name of where it's being used.");if(!new.target)return new D(...arguments);Object.defineProperties(this,{log:{value:function(e,i,r){it.indexOf(e)<=it.indexOf(D.state.currentLevel)&&Object.values(D.state.transports).forEach(n=>{queueMicrotask(()=>n.log({level:e,msg:i,category:t,...r}))})}}}),it.forEach(e=>{let i;e==="noop"?i=()=>{}:i=this.log.bind(this,e),Object.defineProperty(this,e,{value:i})})}function ut(t){if(!new.target)return new ut(...arguments);Object.defineProperty(this,"log",{value:function(e){let i=Object.assign({},t,e);if(i.isTable)console.table(i.msg,i.args);else if(i.group)console[i.group](i.msg);else{let[r,n]=i.style?.length===2?i.style:["font-weight: bold; color: green;","font-style: italic;"];console[i.level](`%c${i.timestamp||new Date().toLocaleTimeString("en-US",i.dateFmt)}%c %c[${i.category}]%c ${i.msg}`,r,"",n,"",...i.args||[])}}})}function kt(t){if(window.showSaveFilePicker===void 0){let e="FileTransport requires the File System Access API";throw console.warn(e),new Error(e)}if(!new.target)return new kt(...arguments);Object.defineProperty(this,"initialize",{value:async function(){try{let e=await window.showSaveFilePicker({types:[{description:"Log Files",accept:{"text/plain":[".log"]}}]});Object.defineProperty(this,"log",{value:async function(i){let r=Object.assign({},t,i),n;try{n=await e.createWritable({keepExistingData:!0}),await n.write(`${r.timestamp||new Date().toLocaleTimeString("en-US",r.dateFmt)} [${r.category}] ${r.level}: ${r.msg}
`)}catch(c){console.error(c)}finally{await n.close()}}})}catch(e){console.error(e)}}})}function Lt(t){if(!new.target)return new Lt(...arguments);Object.defineProperty(this,"log",{value:async function(e){let i=At(t,e);try{let r=await fetch(i.url,{method:i.method,headers:Object.entries(i.headers||{}).reduce((n,[c,a])=>(n[c]=a,n),{}),body:i.body});console.debug(r)}catch(r){console.error(r)}}})}var it,At,J=se(()=>{it=["noop","error","warn","info","debug","silly"];Object.defineProperties(D,{addTransport:{value:(t,e)=>{D.state.transports[t]=e}},state:{value:{currentLevel:"noop",transports:{}}},level:{get:()=>D.state.currentLevel},removeTransport:{value:t=>{delete D.state.transports[t]}},setLogLevel:{value:t=>{if(it.some(e=>e===t))D.state.currentLevel=t;else throw new Error(`${t} is not a valid logger level`)}}});D.addTransport("default",ut({}));it.reduce((t,e)=>(Object.defineProperty(t,e.toUpperCase(),{enumerable:!0,get:()=>e}),t),D);At=function t(e,i){if(e instanceof Object){let r=Array.isArray(e)?[]:{};for(let n in e){let c=t(e[n],i);try{r[n]=JSON.parse(c)}catch{c!==void 0&&c!==""&&(r[n]=c)}}return r}return typeof e!="string"?e:e.replace(/\{\{(.+?)}}/g,(r,n)=>{let c=i[n]||"";return c instanceof Object?JSON.stringify(c):c})}});var Ot=Y((we,Ct)=>{var dt;typeof window>"u"?dt=(J(),et(K)):dt=(J(),et(K)).default;var ae=new dt("getopt.js"),Pt=function(t){ae.warn(t)};function M(t,e){typeof M.place>"u"&&(M.place="",M.iplace=0);let i;if(M.optreset>0||M.iplace===M.place.length){if(M.optreset=0,M.place=t[M.optind],M.iplace=0,M.optind>=t.length||M.place.charAt(M.iplace++)!=="-")return M.place="",M.iplace=0,"";if(M.optopt=M.place.charAt(M.iplace++),M.optopt==="-"&&M.iplace===M.place.length)return++M.optind,M.getopt.place="",M.getopt.iplace=0,"";if(M.optopt===0){if(M.place="",M.iplace=0,e.indexOf("-")===-1)return"";M.optopt="-"}}else M.optopt=M.place.charAt(M.iplace++);if(M.optopt===":"||(i=e.indexOf(M.optopt))===-1)return M.iplace===M.place.length&&++M.optind,M.opterr&&e.charAt(0)!==":"&&Pt("illegal option -- "+M.optopt),"?";if(e.charAt(i+1)!==":")M.optarg=null,M.iplace===M.place.length&&++M.optind;else{if(M.iplace<M.place.length)M.optarg=M.place.substr(M.iplace);else if(t.length>++M.optind)M.optarg=t[M.optind];else return M.place="",M.iplace=0,e.charAt(0)===":"?":":M.opterr?(Pt("option requires an argument -- "+M.optopt),":"):"?";M.place="",M.iplace=0,++M.optind}return M.optopt}M.opterr=1;M.optind=0;M.optopt="";M.optreset=0;M.optarg="";Ct.exports=M});var ft=Y((be,Rt)=>{var W=Ot();function H(t,e,i){if(typeof e=="function")return function(){return e.apply(this,arguments)||H.OK};let r=this;r.echo===void 0&&(r.echo=t.info);let n=[],c=/"([^"]*)"|'([^']*)'|\S+/g,a=async function(h){t.info(`Executing: ${h}`);let d=h.match(c).map(p=>p.replace(/^['"]|['"]$/g,"")),v=d.shift(),f=e[v];if(f===void 0){if(n.includes(v))try{let p=JSON.stringify(await i(h));return t.debug(`RPC Response: ${p}`),r.echo(p),H.OK}catch(p){return r.echo(p),H.ECMDERR}return r.echo(`${v}: no such command`),H.ENOTFOUND}let{func:o,opts:l,usage:u}=f,g=l;if(u&&(g=g?`${g}h`:"h"),g!==void 0){t.debug(`Parsing options: ${g} with ${d}`);let p={},w;for(W.optreset=1,W.optind=0;(w=W(d,g))!=="";)switch(t.debug(`Opt: ${w}, optarg: ${W.optarg}, optind: ${W.optind}`),w){case"h":return r.echo(`Usage: ${u}`),H.OK;case":":return r.echo(`${W.optopt}: option needs a value`),H.EBADARGS;case"?":return r.echo(`${W.optopt}: no such option`),H.EBADARGS;default:t.debug(`Switch: ${w}, optarg: ${W.optarg}`),p[w]=W.optarg||!0}o.opts=p,t.debug(`Switches: ${JSON.stringify(p)}`)}else W.optind=0;return t.debug(`Terms: ${d}`),await o.apply(this,d.slice(W.optind))??H.OK};return i!==void 0&&queueMicrotask(async function(){let h=await i("system.describe");t.debug(`system.describe result: ${h}`),JSON.parse(h).procs.forEach(d=>n.push(d)),e.help.rpcList=n,t.debug(`RPC List: ${n}`),Object.defineProperties(a,{login:{value:async function(d,v){t.info(`Attempting to log in user ${d}`);try{let f=await i(`login ${d} ${v}`);if(f===!1)return r.echo("Login failed"),H.NOTOKEN;let o=i;return a.exit??Object.defineProperty(a,"exit",{value:async function(){t.info("Logging out"),i=o,r.authState=H.NOTOKEN,r.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!0}}))}}),i=new Proxy(i,{apply:function(l,u,g){return l(g[0],f)}}),H.OK}catch(f){return t.error(f),f}}}})}),a}var nt=0;Object.defineProperties(H,{OK:{value:nt++},ENOTFOUND:{value:nt++},ECMDERR:{value:nt++},EBADARGS:{value:nt++},NOTOKEN:{value:nt++}});function he(t,e){let i=0;return function(r,n){try{t.info(`Executing RPC: ${r}`);let c=r.trim().split(/\s+/),a=c.shift(),h=c;n&&(h={token:n,params:h}),t.debug(`Method: ${a}, params: ${h}`);try{return e.jsonrpc({id:i++,method:a,params:h}).then(d=>{let v=JSON.parse(d);if(t.debug(`Response: ${JSON.stringify(v)}`),v.error)throw new Error(v.error.message);return v.result})}catch(d){return t.error(d),d}}catch(c){return t.error(c),c}}}Rt.exports={JSONRPCClient:he,Executor:H}});var It=Y(()=>{var{Executor:V}=ft(),gt=(J(),et(K)).default,I=new gt("Terminal.js"),ce=100,le=1e3,pt=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.parentTerminal=null,this.commandHistory=[],this.historyIndex=-1;let e=localStorage.getItem("commandHistory");e&&(this.commandHistory=JSON.parse(e),I.debug(`Loading command history (${this.commandHistory.length} items)`),this.historyIndex=this.commandHistory.length),this.inputHandler=this.inputHandler.bind(this),this.reset=this.reset.bind(this),this.addEventListener("terminal-reset",this.reset);let i=function(){I.debug("DOMContentLoaded event fired"),this.reset(new CustomEvent("terminal-reset",{detail:{clear:!0}})),document.removeEventListener("DOMContentLoaded",i)}.bind(this);document.addEventListener("DOMContentLoaded",i)}connectedCallback(){I.debug("Terminal connected")}disconnectedCallback(){I.debug("Terminal disconnected"),this.inputLine.removeEventListener("keydown",this.inputHandler),this.removeEventListener("click",this.focusHandler)}reset(e){if(I.debug(`Terminal reset (${this.parentTerminal?"sub-terminal":"main terminal"})`),I.debug(`Auth state: ${this.authState}, RPC enabled: ${this.rpcEnabled}`),this.rpcEnabled&&this.authState!==V.OK)I.debug("logging in"),this.loginModal();else{let i=e.detail?.clear??!1;I.debug(`reset ${i?"and clear ":""}terminal`),this.uiModal(i)}this.focusHandler=function(){this.inputLine.focus()}.bind(this),this.addEventListener("click",this.focusHandler),this.focusHandler()}applyStyles(){let e=this.querySelector("style").cloneNode(!0);this.shadowRoot.appendChild(e)}loginModal(){this.shadowRoot.innerHTML="",this.applyStyles();let e=this.querySelector("template#login").content.cloneNode(!0);this.shadowRoot.appendChild(e),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.output=this.shadowRoot.querySelector(".output"),this.echo("Please log in");let i,r,n=async c=>{if(c.key==="Enter"){c.preventDefault();let a=(this.inputLine.value??this.inputLine.textContent).trim();if(i===void 0?i=a:r=a,i&&r)try{if(this.authState=await this.executor.login(i,r),I.debug(`Login state: ${this.authState}`),this.authState===V.NOTOKEN){this.loginModal(),this.focusHandler();return}this.inputLine.removeEventListener("keydown",n),this.removeEventListener("click",this.focusHandler),this.reset(new CustomEvent("terminal-reset",{detail:{clear:!0}}))}catch(h){this.echo(h),I.error(h)}else{I.debug(`awaiting password for ${i}`);let h=document.createElement("input");h.type="password",h.classList.add("input-line"),this.inputLine.textContent=this.inputLine.value="",this.inputLine.removeEventListener("keydown",n),this.removeEventListener("click",this.focusHandler),this.inputLine.replaceWith(h),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.prompt="password:",this.inputLine.addEventListener("keydown",n),this.addEventListener("click",this.focusHandler),this.focusHandler()}}};this.inputLine.addEventListener("keydown",n)}uiModal(e){let i=this.shadowRoot.querySelector(".output")?.innerHTML;this.shadowRoot.innerHTML="",this.applyStyles();let r=this.querySelector("template#ui").content.cloneNode(!0);this.shadowRoot.appendChild(r),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.output=this.shadowRoot.querySelector(".output"),e&&this.greeting?(I.debug("clearing terminal"),this.echo(this.greeting)):this.output.innerHTML=i??"",this.inputLine.addEventListener("keydown",this.inputHandler),this.inputLine.focus()}get executor(){return this._executor}set executor(e){I.info("Setting executor"),this._executor=e}get greeting(){return this.getAttribute("greeting")}set greeting(e){e===void 0?this.removeAttribute("greeting"):this.setAttribute("greeting",e)}get prompt(){return this.shadowRoot.querySelector(".prompt").textContent}set prompt(e){let i=this.shadowRoot.querySelector(".prompt");i.innerHTML=`${e}&nbsp;`}get rpcEnabled(){return this.getAttribute("rpc")==="true"}inputHandler(e){switch(e.key){case"Enter":{e.preventDefault();let i=this.inputLine.textContent.trim();if(i==="")return;this.inputLine.textContent="",this.echo(`${this.prompt}${i}`),this.processCommand(i),this.historyIndex=this.commandHistory.length;break}case"ArrowUp":I.debug(`History index (back): ${this.historyIndex}`),this.historyIndex>0&&(this.historyIndex-=1,this.inputLine.textContent=this.commandHistory[this.historyIndex]);break;case"ArrowDown":I.debug(`History index (forward): ${this.historyIndex}`),this.historyIndex<this.commandHistory.length-1?(this.historyIndex+=1,this.inputLine.textContent=this.commandHistory[this.historyIndex]):(this.historyIndex=this.commandHistory.length,this.inputLine.textContent="");break}}async processCommand(e){try{let i=await this.executor(e);switch(I.debug(`Status: ${i}`),i){case V.OK:I.debug(`${e} executed successfully`),e!==this.commandHistory[this.commandHistory.length-1]&&(this.commandHistory.push(e),this.commandHistory.length>ce&&this.commandHistory.shift(),localStorage.setItem("commandHistory",JSON.stringify(this.commandHistory)));break;case V.ENOTFOUND:I.info(`${e} not found`);break;case V.ECMDERR:I.error(`Error executing ${e}`);break;case V.EBADARGS:I.warn(`${e} called with bad arguments`);break;default:I.error(`Unknown status: ${i} for ${e}`);break}}catch(i){I.error(i),this.echo(i)}}clear(){this.output.innerHTML=""}echo(e){for(e!=null&&e!==""&&(this.output.innerHTML+=`<div>${e}</div>`);this.output.children.length>le;)this.output.removeChild(this.output.firstChild);this.inputLine.getBoundingClientRect().bottom>window.innerHeight&&this.inputLine.scrollIntoView({behavior:"smooth"})}log(e){gt.level==="debug"&&(typeof e=="string"?console.info(e):console.dir(e))}startSubTerminal(e){I.info(`Starting sub-terminal: ${e.name}`),this.removeEventListener("terminal-reset",this.reset);let i=new gt(`Executor.js (${e.name})`),r=document.createElement("ng-terminal");return r.innerHTML=this.innerHTML,r.greeting=e.greeting,r.executor=V.bind(r)(i,e.registry),r.parentTerminal=this,this.replaceWith(r),r.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!0}})),e.prompt!==void 0&&(r.prompt=e.prompt),r}exitSubTerminal(){this.parentTerminal?(I.info("Exiting sub-terminal"),I.debug(`Parent terminal: ${JSON.stringify(this.parentTerminal)}`),this.parentTerminal.addEventListener("terminal-reset",this.parentTerminal.reset),this.replaceWith(this.parentTerminal),this.parentTerminal.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!1}}))):I.warn("No parent terminal found")}};customElements.define("ng-terminal",pt)});var St=Y((Tt,yt)=>{(function(t){if(typeof Tt=="object"&&typeof yt<"u")yt.exports=t();else if(typeof define=="function"&&define.amd)define([],t);else{var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e=this,e.GIF=t()}})(function(){var t,e,i;return function r(n,c,a){function h(f,o){if(!c[f]){if(!n[f]){var l=typeof tt=="function"&&tt;if(!o&&l)return l(f,!0);if(d)return d(f,!0);var u=new Error("Cannot find module '"+f+"'");throw u.code="MODULE_NOT_FOUND",u}var g=c[f]={exports:{}};n[f][0].call(g.exports,function(p){var w=n[f][1][p];return h(w||p)},g,g.exports,r,n,c,a)}return c[f].exports}for(var d=typeof tt=="function"&&tt,v=0;v<a.length;v++)h(a[v]);return h}({1:[function(r,n,c){function a(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}n.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._maxListeners=void 0,a.defaultMaxListeners=10,a.prototype.setMaxListeners=function(o){if(!d(o)||o<0||isNaN(o))throw TypeError("n must be a positive number");return this._maxListeners=o,this},a.prototype.emit=function(o){var l,u,g,p,w,y;if(this._events||(this._events={}),o==="error"&&(!this._events.error||v(this._events.error)&&!this._events.error.length)){if(l=arguments[1],l instanceof Error)throw l;var x=new Error('Uncaught, unspecified "error" event. ('+l+")");throw x.context=l,x}if(u=this._events[o],f(u))return!1;if(h(u))switch(arguments.length){case 1:u.call(this);break;case 2:u.call(this,arguments[1]);break;case 3:u.call(this,arguments[1],arguments[2]);break;default:p=Array.prototype.slice.call(arguments,1),u.apply(this,p)}else if(v(u))for(p=Array.prototype.slice.call(arguments,1),y=u.slice(),g=y.length,w=0;w<g;w++)y[w].apply(this,p);return!0},a.prototype.addListener=function(o,l){var u;if(!h(l))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",o,h(l.listener)?l.listener:l),this._events[o]?v(this._events[o])?this._events[o].push(l):this._events[o]=[this._events[o],l]:this._events[o]=l,v(this._events[o])&&!this._events[o].warned&&(f(this._maxListeners)?u=a.defaultMaxListeners:u=this._maxListeners,u&&u>0&&this._events[o].length>u&&(this._events[o].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[o].length),typeof console.trace=="function"&&console.trace())),this},a.prototype.on=a.prototype.addListener,a.prototype.once=function(o,l){if(!h(l))throw TypeError("listener must be a function");var u=!1;function g(){this.removeListener(o,g),u||(u=!0,l.apply(this,arguments))}return g.listener=l,this.on(o,g),this},a.prototype.removeListener=function(o,l){var u,g,p,w;if(!h(l))throw TypeError("listener must be a function");if(!this._events||!this._events[o])return this;if(u=this._events[o],p=u.length,g=-1,u===l||h(u.listener)&&u.listener===l)delete this._events[o],this._events.removeListener&&this.emit("removeListener",o,l);else if(v(u)){for(w=p;w-- >0;)if(u[w]===l||u[w].listener&&u[w].listener===l){g=w;break}if(g<0)return this;u.length===1?(u.length=0,delete this._events[o]):u.splice(g,1),this._events.removeListener&&this.emit("removeListener",o,l)}return this},a.prototype.removeAllListeners=function(o){var l,u;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[o]&&delete this._events[o],this;if(arguments.length===0){for(l in this._events)l!=="removeListener"&&this.removeAllListeners(l);return this.removeAllListeners("removeListener"),this._events={},this}if(u=this._events[o],h(u))this.removeListener(o,u);else if(u)for(;u.length;)this.removeListener(o,u[u.length-1]);return delete this._events[o],this},a.prototype.listeners=function(o){var l;return!this._events||!this._events[o]?l=[]:h(this._events[o])?l=[this._events[o]]:l=this._events[o].slice(),l},a.prototype.listenerCount=function(o){if(this._events){var l=this._events[o];if(h(l))return 1;if(l)return l.length}return 0},a.listenerCount=function(o,l){return o.listenerCount(l)};function h(o){return typeof o=="function"}function d(o){return typeof o=="number"}function v(o){return typeof o=="object"&&o!==null}function f(o){return o===void 0}},{}],2:[function(r,n,c){var a,h,d,v,f;f=navigator.userAgent.toLowerCase(),v=navigator.platform.toLowerCase(),a=f.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],d=a[1]==="ie"&&document.documentMode,h={name:a[1]==="version"?a[3]:a[1],version:d||parseFloat(a[1]==="opera"&&a[4]?a[4]:a[2]),platform:{name:f.match(/ip(?:ad|od|hone)/)?"ios":(f.match(/(?:webos|android)/)||v.match(/mac|win|linux/)||["other"])[0]}},h[h.name]=!0,h[h.name+parseInt(h.version,10)]=!0,h.platform[h.platform.name]=!0,n.exports=h},{}],3:[function(r,n,c){var a,h,d,v=function(u,g){for(var p in g)f.call(g,p)&&(u[p]=g[p]);function w(){this.constructor=u}return w.prototype=g.prototype,u.prototype=new w,u.__super__=g.prototype,u},f={}.hasOwnProperty,o=[].indexOf||function(u){for(var g=0,p=this.length;g<p;g++)if(g in this&&this[g]===u)return g;return-1},l=[].slice;a=r("events").EventEmitter,d=r("./browser.coffee"),h=function(u){var g,p;v(w,u),g={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},p={delay:500,copy:!1};function w(y){var x,m,b;this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(y);for(m in g)b=g[m],(x=this.options)[m]==null&&(x[m]=b)}return w.prototype.setOption=function(y,x){if(this.options[y]=x,this._canvas!=null&&(y==="width"||y==="height"))return this._canvas[y]=x},w.prototype.setOptions=function(y){var x,m,b;m=[];for(x in y)f.call(y,x)&&(b=y[x],m.push(this.setOption(x,b)));return m},w.prototype.addFrame=function(y,x){var m,b;x==null&&(x={}),m={},m.transparent=this.options.transparent;for(b in p)m[b]=x[b]||p[b];if(this.options.width==null&&this.setOption("width",y.width),this.options.height==null&&this.setOption("height",y.height),typeof ImageData<"u"&&ImageData!==null&&y instanceof ImageData)m.data=y.data;else if(typeof CanvasRenderingContext2D<"u"&&CanvasRenderingContext2D!==null&&y instanceof CanvasRenderingContext2D||typeof WebGLRenderingContext<"u"&&WebGLRenderingContext!==null&&y instanceof WebGLRenderingContext)x.copy?m.data=this.getContextData(y):m.context=y;else if(y.childNodes!=null)x.copy?m.data=this.getImageData(y):m.image=y;else throw new Error("Invalid image");return this.frames.push(m)},w.prototype.render=function(){var y,x,m,b;if(this.running)throw new Error("Already running");if(this.options.width==null||this.options.height==null)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=function(){var E,A,L;for(L=[],y=E=0,A=this.frames.length;0<=A?E<A:E>A;y=0<=A?++E:--E)L.push(null);return L}.call(this),m=this.spawnWorkers(),this.options.globalPalette===!0)this.renderNextFrame();else for(y=x=0,b=m;0<=b?x<b:x>b;y=0<=b?++x:--x)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},w.prototype.abort=function(){for(var y;y=this.activeWorkers.shift(),y!=null;)this.log("killing active worker"),y.terminate();return this.running=!1,this.emit("abort")},w.prototype.spawnWorkers=function(){var y,x,m,b;return x=Math.min(this.options.workers,this.frames.length),function(){b=[];for(var E=m=this.freeWorkers.length;m<=x?E<x:E>x;m<=x?E++:E--)b.push(E);return b}.apply(this).forEach(function(E){return function(A){var L;return E.log("spawning worker "+A),L=new Worker(E.options.workerScript),L.onmessage=function(C){return E.activeWorkers.splice(E.activeWorkers.indexOf(L),1),E.freeWorkers.push(L),E.frameFinished(C.data)},E.freeWorkers.push(L)}}(this)),x},w.prototype.frameFinished=function(y){var x,m,b;if(this.log("frame "+y.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[y.index]=y,this.options.globalPalette===!0&&(this.options.globalPalette=y.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(x=m=1,b=this.freeWorkers.length;1<=b?m<b:m>b;x=1<=b?++m:--m)this.renderNextFrame();return o.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},w.prototype.finishRendering=function(){var y,x,m,b,E,A,L,C,R,P,O,S,U,q,T,_;for(C=0,q=this.imageParts,E=0,R=q.length;E<R;E++)x=q[E],C+=(x.data.length-1)*x.pageSize+x.cursor;for(C+=x.pageSize-x.cursor,this.log("rendering finished - filesize "+Math.round(C/1e3)+"kb"),y=new Uint8Array(C),S=0,T=this.imageParts,A=0,P=T.length;A<P;A++)for(x=T[A],_=x.data,m=L=0,O=_.length;L<O;m=++L)U=_[m],y.set(U,S),m===x.data.length-1?S+=x.cursor:S+=x.pageSize;return b=new Blob([y],{type:"image/gif"}),this.emit("finished",b,y)},w.prototype.renderNextFrame=function(){var y,x,m;if(this.freeWorkers.length===0)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return y=this.frames[this.nextFrame++],m=this.freeWorkers.shift(),x=this.getTask(y),this.log("starting frame "+(x.index+1)+" of "+this.frames.length),this.activeWorkers.push(m),m.postMessage(x)},w.prototype.getContextData=function(y){return y.getImageData(0,0,this.options.width,this.options.height).data},w.prototype.getImageData=function(y){var x;return this._canvas==null&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),x=this._canvas.getContext("2d"),x.setFill=this.options.background,x.fillRect(0,0,this.options.width,this.options.height),x.drawImage(y,0,0),this.getContextData(x)},w.prototype.getTask=function(y){var x,m;if(x=this.frames.indexOf(y),m={index:x,last:x===this.frames.length-1,delay:y.delay,transparent:y.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:d.name==="chrome"},y.data!=null)m.data=y.data;else if(y.context!=null)m.data=this.getContextData(y.context);else if(y.image!=null)m.data=this.getImageData(y.image);else throw new Error("Invalid frame");return m},w.prototype.log=function(){var y;if(y=1<=arguments.length?l.call(arguments,0):[],!!this.options.debug)return console.log.apply(console,y)},w}(a),n.exports=h},{"./browser.coffee":2,events:1}]},{},[3])(3)})});var at=Y((Le,_t)=>{var ue=St(),de=(J(),et(K)).default,j=new de("Renderer.js");function xt(t,e){if(!new.target)return new xt(...arguments);let i=t.pixels.toArray(),r=i.length,n=new Proxy(t,{get:function(c,a,h){if(typeof a=="string"&&!isNaN(a)){let d=+a;if(Number.isInteger(d)&&d>=0&&d<r)return i[d]}else return Reflect.get(c,a,h)},set:function(c,a,h,d){if(typeof a=="string"&&!isNaN(a)){let v=Math.round(+a);Number.isInteger(v)&&v>=0&&v<r?i[v]=Array.isArray(h)?e.color(...h):h:j.noop(`index ${v} out of range, ${r}`)}else return Reflect.set(c,a,h,d)}});return t.loaded=!0,Object.defineProperties(n,{blit:{value:function(c,a){t.pixels.set(i),e.image(t,c,a)}},length:{value:i.length},update:{value:function(){t.pixels.set(i)}}}),n}function mt(t){if(!new.target)return new mt(...arguments);let e=0,i=[];Object.defineProperties(i,{flip:{value:function(){e^=1}},read:{get:function(){return this[e^1]}},write:{get:function(){return this[e]}}});let r=t.createImage();i.push({buffer:r,get pixels(){return r.pixels.toArray()}});let n=t.createImage();i.push({buffer:n,get pixels(){return n.pixels.toArray()}}),Object.defineProperties(this,{flip:{value:function(){let c=i.write.buffer;c.update(),t.background(c),i.flip()}},readBuffer:{get:function(){return i.read.pixels}},writeBuffer:{get:function(){return i.write.buffer}}})}function st(t){if(st.instance!==void 0)return st.instance;if(!new.target)return new st(...arguments);Object.defineProperty(st,"instance",{value:this});let e={background:4278849802,frameRate:60,height:t.height,showFrameRate:!1,showRuler:!1,width:t.width},i,r=!1,n=!1,c=50,a=new ue({workers:navigator.hardwareConcurrency-2,quality:10}),h=!1,d=12,v=5,f=[];Object.defineProperties(this,{createImage:{value:function(o,l){let u=i.createImage(o??t.width,l??t.height);return new xt(u,i)}},frame:{set:function(o){let l=i.width/2,u=i.height/2,g=new Proxy(o,{apply:function(p,w,y){if(p.apply(w,y),r&&(i.fill(255),i.textSize(12),i.text(i.__frameRate,i.width-50,i.height-10)),n){i.stroke(255),i.line(0,u,i.width,u),i.line(l,0,l,i.height);for(let x=c;x<i.width;x+=c)i.point(l+x,u-1),i.point(l-x,u-1),i.point(l+x,u+1),i.point(l-x,u+1);for(let x=c;x<i.height;x+=c)i.point(l-1,u+x),i.point(l-1,u-x),i.point(l+1,u+x),i.point(l+1,u-x)}if(h&&a.addFrame(t,{copy:!0,delay:1e3/i.frameRate()}),f.length>0){i.fill(255),i.textSize(d);for(let x=0;x<f.length;++x)i.text(f[x],i.width-200,i.height-300+x*d);f.length=0}}});Object.defineProperty(i,"draw",{value:g,writable:!0}),j.debug("pjs.draw set")}},doubleBuffer:{value:function(){return new mt(this)}},echo:{value:function(o){f.push(o),f.length>v&&f.shift()}},init:{value:function(o){if(i!==void 0){i.exit(),i=void 0;let g=document.createElement("canvas");t.replaceWith(g),t=g}let l=Object.assign({},e,o),u=this.echo.bind(this);i=new Processing(t,g=>{j.info("Processing.js created"),j.debug(`canvas width (${t.width}) height (${t.height})`),Object.defineProperties(g,{keyPressed:{value:function p(){switch(console.log(g.I,g.V),g.keyCode){case g.UP:g.loop();break;case g.DOWN:g.noLoop();break;case g.LEFT:switch(p.mode){case g.I:g.save("image.png");break;case g.v:h&&a.on("finished",function(w){window.open(URL.createObjectURL(w))}),h=!h;break}break;case g.RIGHT:g.redraw();break;case g.i:p.mode=g.I,u("Image capture mode");break;case g.V:p.mode=g.V,u("Video capture mode");break}},writable:!0},setup:{value:function(){g.size(l.width,l.height,g[l.renderer]),j.debug(`processingjs width (${g.width}) height (${g.height}) ${g.use3DContext}`),g.frameRate(l.frameRate),g.noLoop(),g.background(l.background),r=l.showFrameRate,n=l.showRuler,j.info("Processing.js setup")},writable:!0}})}),Object.setPrototypeOf(this,i)}},input:{set:function(o){j.debug("keyPressed set"),Object.defineProperty(i,"keyPressed",{value:o,writable:!0})}},pixelHeight:{get:function(){return 0}},pixelWidth:{get:function(){return 0}}}),this.init()}_t.exports={DoubleBuffer:mt,Image:xt,Renderer:st}});var $t=Y((Ae,Nt)=>{function Z(){if(Z.instance instanceof Z)return Z.instance;if(!new.target)return new Z(...arguments);Object.defineProperty(Z,"instance",{value:this});let t=Math.PI/180;Object.defineProperties(this,{cos:{value:{},enumerable:!0},sin:{value:{},enumerable:!0}});for(let e=0;e<=360;++e)Object.defineProperty(this.cos,e,{value:Math.cos(e*t)}),Object.defineProperty(this.sin,e,{value:Math.sin(e*t)})}var rt=Object.freeze({addColors:(...t)=>t.length===0?[]:t[0].map((e,i)=>t.reduce((r,n)=>r+n[i],0)),decodeColor:t=>[t>>16&255,t>>8&255,t&255,t>>>24],direction:(t,e,i,r)=>Math.atan2(r-e,i-t),distance:(t,e,i,r)=>Math.hypot(Math.abs(i-t),Math.abs(r-e)),fastInvSqrt:t=>{let i=new Float32Array([t]),r=new Float32Array([t]),n=new Int32Array(i.buffer);return n[0]=1597463007-(n[0]>>1),r[0]=i[0],r[0]=r[0]*(1.5-t*.5*r[0]*r[0]),r[0]},fastTrig:Z(),intersection:(t,e,i,r,n,c,a,h)=>{let d=(t-i)*(c-h)-(e-r)*(n-a);if(d===0)return null;let v=t*r-e*i,f=n*h-c*a,o=(v*(n-a)-(t-i)*f)/d,l=(v*(c-h)-(e-r)*f)/d;return[o,l]},invSqrt:t=>1/Math.sqrt(t),randomColor:(t=!1)=>{let e=Array.from({length:3},()=>rt.roll(255));return e.push(t?rt.roll(255):255),e},randomGrayscale:(t=!1)=>{let e=rt.roll(255),i=Array.from({length:3},()=>e);return i.push(t?rt.roll(255):255),i},range:(t,e)=>{let i=Math.random()*(e-t);return Number.isInteger(t)&&Number.isInteger(e)&&(i=Math.floor(i)),i+t},roll:t=>Math.floor(Math.random()*t)});Nt.exports=rt});var Dt=Y((Pe,Ht)=>{function fe(){this.x+=this.dx,this.y+=this.dy}function ge(t){t.stroke(this.r,this.g,this.b,this.a),t.point(this.x,this.y)}function Ft(t,e=fe,i=ge){if(!new.target)return new Ft(...arguments);let r=2,n=new c;n.next=new c,n.prev=n.next,n.prev.next=n,n.prev.prev=n,n.active=!1,n.prev.active=!1,this.ACCELERATION=[0,.25],this.ELASTICITY=.2,this.MAX_COUNT=1e4,Object.defineProperties(this,{count:{get:function(){return r}},createParticle:{value:function(a,h,d,v,f,o,l,u,g){let p;if(n.prev.active){if(r>=this.MAX_COUNT)return;p=new c(a,h,d,v,f,o,l,u,g),p.next=n,p.prev=n.prev,p.prev.next=p,n.prev=p,n=p,++r}else p=n.prev,p.activate(a,h,d,v,f,o,l,u,g),n=p;return p}},list:{get:function(){return n}},render:{value:function(){let a=n;for(;a.active;){e.call(a,this),i.call(a,t);let h=a;if(a.ttl>0&&++a.t>=a.ttl&&(a.active=!1),a=a.next,a===n)break;h.active||(h===n?n=h.next:(h.next.prev=h.prev,h.prev.next=h.next,h.next=n,h.prev=n.prev,n.prev.next=h,n.prev=h))}}}});function c(a,h,d,v,f,o,l,u,g){if(!new.target)return new c(...arguments);Object.defineProperties(this,{activate:{value:function(p,w,y,x,m,b,E,A,L){this.active=!0,this.ttl=p,this.t=0,this.x=w,this.y=y,this.dx=x,this.dy=m,this.ddx=0,this.ddy=0,this.r=b,this.g=E,this.b=A,this.a=L}}}),this.activate(a,h,d,v,f,o,l,u,g)}}Ht.exports=Ft});var Wt=Y((Ce,Xt)=>{function qt(t=10){if(!new.target)return new qt(...arguments);let e=new Map;Object.defineProperties(this,{add:{value:function(i,r,n){let c=`${Math.floor(i/t)},${Math.floor(r/t)}`;if(e.has(c)){let a=e.get(c);a.includes(n)||a.push(n)}else e.set(c,[n])}},get:{value:function(i,r){let n=`${Math.floor(i/t)},${Math.floor(r/t)}`;return e.get(n)??[]}},remove:{value:function(i,r,n){let c=`${Math.floor(i/t)},${Math.floor(r/t)}`,a=e.get(c);if(a!==void 0){let h=a.indexOf(n);h!==-1&&a.splice(h,1)}}}})}Xt.exports={Space:qt}});var Gt=Y((Oe,Bt)=>{var k=$t(),$=Dt(),s=at().Renderer(),{Space:pe}=Wt();function Ut(t,e,i,r){let n=r%t,c=Math.floor(r/t),a=i,h=Math.floor(n/e)%2==0,d=Math.floor(c/e)%2==0;return h!=d&&(a=0),[a,a,a,255]}function Yt(t,e,i){let r=t.createShader(i);return t.shaderSource(r,e),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.error("Shader compilation failed:",t.getShaderInfoLog(r)),null)}var ye={"3d":function(){s.init({renderer:"P3D"});let t=s.width,e=s.height,i=0,r=255,n=255,c=255;s.frame=function(){s.background(0),s.camera(t/2,e/5,200,t/2,e/2,0,0,1,0),s.pointLight(r,n/10,c/10,t/3,e/3,100),s.pointLight(r/10,n,c/10,300,t/3,100),s.pointLight(r/10,n/10,c,300,300,-100),s.pointLight(r,n,c,t/3,300,-100),s.translate(t/2,e/2),s.rotateY(i),s.normal(0,0,1),s.fill(128),s.rect(-100,-100,200,200),i+=.01},s.loop()},ants:function(){let t=s.width,e=s.height,i=200,r=1,n=s.createImage();n.update();let c=new $(s,function(a){let h=a.list,d=h;for(;d.active;){if(d===this){if(d=d.next,d===h)break;continue}if(d=d.next,d===h)break}this.last??=k.roll(60),this.last++>60&&(this.ddx=k.range(-.05,.05),this.ddy=k.range(-.05,.05),this.last=0),this.dx+=this.ddx,this.dy+=this.ddy;let v=Math.hypot(this.dx,this.dy);v>r&&(this.dx=this.dx/v*r,this.dy=this.dy/v*r);let f=this.x-3*this.dx,o=this.y-3*this.dy;this.x+=this.dx,this.y+=this.dy,s.line(this.x,this.y,f,o),this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-1?(this.y=e-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1)});for(let a=0;a<i;++a)c.createParticle(0,k.range(1e-4,t),k.range(1e-4,e),0,0,207,16,32);s.stroke(0,0,0,255),s.frame=function(){s.background(n),c.render()},s.loop()},balls:function(){s.init({showFrameRate:!0});let t=s.width,e=s.height,i=1e3,r=10,n=2,c=new pe(r*3),a=new $(s,function(){this.x+=this.dx,this.y+=this.dy,this.x<0&&(this.x=0,this.dx*=-1),this.x>t&&(this.x=t,this.dx*=-1),this.y<0&&(this.y=0,this.dy*=-1),this.y>e&&(this.y=e,this.dy*=-1);let h=c.get(this.x,this.y);for(let v=0;v<h.length;++v){let f=h[v];if(f===this)continue;let o=Math.hypot(this.x-f.x,this.y-f.y);if(o<r){let l=Math.atan2(this.y-f.y,this.x-f.x),u=(r-o)/r;this.dx+=Math.cos(l)*u,this.dy+=Math.sin(l)*u,f.dx-=Math.cos(l)*u,f.dy-=Math.sin(l)*u,this.x+=this.dx,this.y+=this.dy,f.x+=f.dx,f.y+=f.dy}}c.add(this.x,this.y,this);let d=Math.hypot(this.dx,this.dy);d>n&&(this.dx=this.dx/d*n,this.dy=this.dy/d*n)},function(h){h.fill(this.r,this.g,this.b,this.a),h.stroke(this.r,this.g,this.b,this.a),h.ellipse(this.x,this.y,r,r)});for(let h=0;h<i;++h){let d=a.createParticle(0,k.range(.01,t),k.range(.01,e),k.range(-1,1.01),k.range(-1,1.01),...k.randomColor());c.add(d.x,d.y,d)}s.frame=function(){s.background(0),a.render()},s.loop()},boids:function(){let t=s.width,e=s.height,i=t/2,r=e/2,n=200,c=3,a=5e-4,h=100,d=40,v=1,f=1.25,o=1,l=.75,u=new $(s,function(p){let w=0,y=0,x=0,m=0,b=0,E=0,A=0,L=0,C=0,R=0,P=p.list,O=P;for(;O.active;){if(O===this){if(O=O.next,O===P)break;continue}let T=Math.hypot(this.x-O.x,this.y-O.y);if(T<h&&(w+=O.dx,y+=O.dy,x+=O.x,m+=O.y,C++),T<d){let _=(d-T)/d;b+=(this.x-O.x)*_,E+=(this.y-O.y)*_,R++}if(O=O.next,O===P)break}if(C>0){w/=C,y/=C;let T=Math.hypot(w,y);T>0&&(w=w/T*a*v,y=y/T*a*v),x=(x/C-this.x)*a*f,m=(m/C-this.y)*a*f}if(R>0){b/=R,E/=R;let T=Math.hypot(b,E);T>0&&(b=b/T*a*o,E=E/T*a*o)}if(Math.random()>l){let T=Math.atan2(this.dy,this.dx)+k.range(-.1,.1),_=Math.hypot(this.dx,this.dy);A=_*Math.cos(T)-this.dx,L=_*Math.sin(T)-this.dy}this.ddx=w+x+b+A,this.ddy=y+m+E+L,this.dx+=this.ddx,this.dy+=this.ddy;let S=Math.hypot(this.dx,this.dy);S>c&&(this.dx=this.dx/S*c,this.dy=this.dy/S*c);let U=this.x-3*this.dx,q=this.y-3*this.dy;this.x+=this.dx,this.y+=this.dy,s.line(this.x,this.y,U,q),this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-1?(this.y=e-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1)}),g=k.range(0,2*Math.PI);for(let p=0;p<n;++p){let w=k.range(.001,1)*c,y=k.range(-.1,.1);u.createParticle(0,k.range(i-10.01,i+10),k.range(r-10.01,r+10),w*Math.cos(y+g),w*Math.sin(y+g),...k.randomColor())}s.stroke(0,0,0,255),s.frame=function(){s.background(0),u.render()},s.loop()},bz:function(){let t=s.width,e=Array.from({length:8},()=>Math.random()*t),i=Array.from({length:8},()=>Math.random()*t),r=Array.from({length:8},()=>Math.random()*15);s.background(255),s.noFill(),s.frame=function(){s.stroke(0,0,0,20),e.map(function(n,c,a){let h=n+r[c];h<0?(h=0,r[c]*=-1):h>t&&(h=t,r[c]*=-1),a[c]=h}),s.bezier.apply(null,e),s.stroke(255,128,128,20),i.map(function(n,c,a){let h=n+r[c];h<0?(h=0,r[c]*=-1):h>t&&(h=t,r[c]*=-1),a[c]=h}),s.bezier.apply(null,i)},s.loop()},cell:function(t=30,e=!1,i=200,r=200){s.init({background:0,frameRate:400,height:+r,width:+i});let n=s.width,c=s.height,a=1,h=0,d=new Array(n*c).fill(h),v=(l=>{let u=l.toString(2).padStart(8,"0"),g=[];for(let p=0;p<8;++p)+u[7-p]&&g.push(p);return(p,w)=>{let y=(w-1)*n+p,x=parseInt([d[y-1],d[y],d[y+1]].join(""),2);return g.some(m=>x===m)?a:h}})(+t);if(s.stroke(255),e===!1||e==="false")d[n/2]=a,s.point(n/2,0);else if(e==="random")for(let l=0;l<n;++l)Math.random()>.5&&(d[l]=a,s.point(l,0));else{let l=e.length,u=Math.floor((n-l)/2);for(let g=0;g<l;++g)+e[g]&&(d[u+g]=a,s.point(u+g,0))}let f=0,o=d.length/n;s.frame=function(){for(let l=0;l<n;++l){let u=v(l,f);u&&(d[f*n+l]=u,s.point(l,f))}f!==o&&f++},s.loop()},chaos:function(t="3",e,i){s.init({frameRate:400});let r=s.width,n=s.height,c=r/2,a=n/2,h=c-50,d=Math.PI/180,v=e==="alt"?{3:[{x:r/2,y:50},{x:50,y:n-50},{x:r-50,y:n-50}],4:[{x:r/2,y:50},{x:50,y:n-50},{x:r-50,y:n-50},{x:c,y:a}],5:[{x:r-50,y:50},{x:50,y:50},{x:50,y:n-50},{x:r-50,y:n-50},{x:c,y:a}],8:[{x:50,y:50},{x:r-50,y:50},{x:r-50,y:n-50},{x:50,y:n-50},{x:c,y:50},{x:r-50,y:a},{x:c,y:n-50},{x:50,y:a}]}[t]:(u=>{let g=[];for(let p=0;p<u;++p){let w=(p*(360/u)-90)*d;g.push({x:Math.cos(w)*h+c,y:Math.sin(w)*h+a})}return e==="center"&&g.push({x:c,y:a}),g})(+t),f=e==="alt"?{3:.5,4:.573,5:.666667,8:.666667}[t]:i??{0:1/(1+Math.tan(Math.PI/t)),1:1/(1+2*Math.sin(Math.PI/(2*t))),2:1/(1+Math.sin(Math.PI/t)),3:1/(1+2*Math.sin(Math.PI/(2*t)))}[+t%4];s.background(0),s.stroke(255,255,255,255);for(let{x:u,y:g}of v)s.point(u,g);let o=Math.random()*r,l=Math.random()*n;s.frame=function(){let u=k.roll(v.length);o+=(v[u].x-o)*f,l+=(v[u].y-l)*f,s.point(o,l)},s.loop()},fire:function(){s.init({background:0,frameRate:60,height:300,showFrameRate:!1,width:300});let t=s.width,e=s.doubleBuffer(),i=s.createImage(),r=s.color(255,128,96),n=4294940974;for(let d=0;d<i.length;++d)i[d]=419076398;i.update();let c=e.writeBuffer;for(let d=0;d<c.length;++d)c[d]=[0,0,0,255];e.flip(),c=e.writeBuffer;for(let d=0;d<c.length;++d)c[d]=[0,0,0,255];e.flip();let a=e.readBuffer.length/t,h=new $(s,function(){this.x+=this.dx,this.y+=this.dy,this.dy-=.05,this.x<1&&(this.x=1,this.dx*=-.5),this.x>=t-2&&(this.x=t-2,this.dx*=-.5),(this.y|0)<4&&(this.active=!1)},function(d){e.writeBuffer[(this.y|0)*t+this.x]=d.color(this.r,this.g,this.b,this.a*(1-this.t/this.ttl))});s.frame=function(){let d=e.readBuffer,v=e.writeBuffer;for(let f=0;f<t;++f)Math.random()>.97&&h.createParticle(k.range(12,24)*4,f,a-1,k.range(-.95,.95),-k.range(.01,.0625),n);for(let f=t;f<v.length-t;++f){if(f%t<1||f%t>=t-1)continue;let o=f/t;if(Math.random()<Math.pow(Math.E,Math.pow(o/a,10))-1&&Math.random()>.995){v[f-1]=r,v[f+1]=r,h.createParticle(k.range(12,24)*2,f%t,f/t,k.range(-.3,.3),-k.range(.01,.0625),r);continue}v[f]=k.addColors(k.decodeColor(d[f-1]),k.decodeColor(d[f]),k.decodeColor(d[f]),k.decodeColor(d[f+1]),k.decodeColor(d[f+t])).map((l,u)=>{if(u===3)return 255;let g=l/5.3;return g<10?0:g})}h.render(),e.flip(),i.blit(0,0)},s.loop()},fireworks:function(t=1){let e=s.width,i=s.height;t=+t;let r=t===0?function(o){o.stroke(this.r,this.g,this.b,this.a),o.point(this.x,this.y)}:function(o){o.fill(this.r,this.g,this.b,this.a),o.ellipse(this.x,this.y,t*this.ttl/this.t,t*this.ttl/this.t)},n=new $(s,function(){this.dx+=n.ACCELERATION[0],this.dy+=n.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let o=1-this.t/this.ttl;this.r=255*Math.pow(o,.2),this.g=255*o*o,this.b=255*o*o*o*o,this.a=255*o},r),c=new $(s,function(){this.dx+=c.ACCELERATION[0],this.dy+=c.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let o=1-this.t/this.ttl;this.b=255*Math.pow(o,.2),this.g=255*o*o,this.r=255*o*o*o*o,this.a=255*o},r),a=new $(s,function(){this.dx+=a.ACCELERATION[0],this.dy+=a.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let o=1-this.t/this.ttl;this.g=255*Math.pow(o,.2),this.r=255*o*o,this.b=255*o*o*o*o,this.a=255*o},r),h=new $(s,function(){this.dx+=h.ACCELERATION[0],this.dy+=h.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let o=1-this.t/this.ttl;this.r=255*Math.pow(o,.2),this.g=255*Math.pow(o,.2),this.b=255*o*o*o*o,this.a=255*o},r),d=new $(s,function(){this.dx+=d.ACCELERATION[0],this.dy+=d.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let o=1-this.t/this.ttl;this.r=255*Math.pow(o,.2),this.b=255*o*o*o*o,this.g=255*o,this.a=255*o},r),v=new $(s,function(){this.dx+=v.ACCELERATION[0],this.dy+=v.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let o=1-this.t/this.ttl;this.r=255*Math.pow(o,.2),this.b=255*Math.pow(o,.2),this.g=255*o*o*o*o,this.a=255*o},r);n.ACCELERATION=[0,.15],c.ACCELERATION=[0,.15],a.ACCELERATION=[0,.15],h.ACCELERATION=[0,.15],d.ACCELERATION=[0,.15],v.ACCELERATION=[0,.15];function f(o,l){let u;switch(k.range(0,5)){case 0:u=n;break;case 1:u=c;break;case 2:u=a;break;case 3:u=h;break;case 4:u=v;break;case 5:u=d;break}for(let g=0;g<300;++g){let p=k.range(0,Math.PI*2),w=k.range(.001,10);u.createParticle(k.range(50.001,100),o,l,Math.cos(p)*w,Math.sin(p)*w,0,0,0,0)}}s.frame=function(){s.background(0),Math.random()>.95&&f(k.range(.001,e),k.range(.001,i/2)),n.render(),c.render(),a.render(),h.render(),v.render(),d.render()},s.loop()},fountain:function(){let t=s.width,e=s.height,i=new $(s,function(){this.dx+=i.ACCELERATION[0],this.dy+=i.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let c=1-this.t/this.ttl;this.r=255*Math.pow(c,.2),this.g=255*c*c,this.b=255*c*c*c*c,this.a=255*Math.pow(c,.2),this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-2?(this.dy<.25?this.y=e-1:this.y=e-2,this.dy*=-1.2*Math.random()*i.ELASTICITY,Math.random()<.5?this.dx-=this.dy:this.dx+=this.dy):this.y<0&&(this.y=0,this.dy*=-1*i.ELASTICITY),this.y===e-1&&(this.active=!1)}),r=-20.01,n=[255,255,255,255];s.frame=function(){s.background(0);for(let c=0;c<15;++c){let a=k.range(-.098,.098),h=k.range(r,.8*r);i.createParticle(k.range(10,30.01)*-h,t/2,e-20,Math.sin(a)*h,Math.cos(a)*h,...n)}i.render()},s.loop()},graviton:function(t=20,e=66743e-15){let i=s.width,r=s.height,n=i/2,c=r/2,a=25,h=+t,d=6,v=2,f=+e,o=1e7,l=1e6,u=1.0312,g=new $(s,function(p){let w=0,y=0,x=p.list,m=x;for(;m.active;){if(m===this){if(m=m.next,m===x)break;continue}let P=k.distance(this.x,this.y,m.x,m.y),O=k.direction(this.x,this.y,m.x,m.y),S=f*l*l/(P/u)**v,U=S*Math.cos(O),q=S*Math.sin(O);if(P<1){let T=k.direction(this.x,this.y,m.x,m.y),_=Math.cos(T),G=Math.sin(T),N=Math.hypot(this.dx,this.dy),F=Math.hypot(m.dx,m.dy);this.dx=F*_,this.dy=F*G,m.dx=N*_,m.dy=N*G;break}else P<3?(w+=-U*2,y+=-q*2):(w+=U,y+=q);if(m=m.next,m===x)break}this.ddx=w,this.ddy=y;let b=k.direction(this.x,this.y,n,c),E=k.distance(this.x,this.y,n,c),A=f*o*l/(E/u)**v,L=A*Math.cos(b),C=A*Math.sin(b);E<a?(this.ddx+=-C*2,this.ddy+=-L*2):(this.ddx+=L,this.ddy+=C),this.dx+=this.ddx,this.dy+=this.ddy;let R=Math.hypot(this.dx,this.dy);R>d&&(this.dx=this.dx/R*d,this.dy=this.dy/R*d),this.x+=this.dx,this.y+=this.dy,this.x>=i-1?(this.x=i-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=r-1?(this.y=r-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1)},function(p){p.stroke(this.r,this.g,this.b,this.a),p.ellipse(this.x,this.y,3,3)});for(let p=0;p<h;++p){let w=d,y=1.25+k.range(-.088,.088);g.createParticle(0,k.roll(n-100),k.roll(c),w*Math.cos(y),w*Math.sin(y),255,255,196)}s.stroke(0,0,0,255),s.frame=function(){s.background(0),g.render(),s.fill(255,255,200),s.stroke(255,255,0),s.ellipse(n,c,a,a)},s.loop()},lens:function(t=150,e=30){t=+t,e=+e;let i=s.width,r=s.createImage(),n=r.height;for(let p=0;p<r.length;++p)r[p]=Ut(n,n/32,255,p);r.update();let c=s.createImage(t,t),a=new Array(t*t).fill(0),h=Math.round(t/2),d=h*h,v=h*(t+1),f;for(let p=0;p<d;++p){let w=p%h,y=Math.floor(p/h),x=w*w,m=y*y,b=0,E=0;if(x+m<d){let A=e/Math.sqrt(e*e-(x+m-d));b=Math.floor(w*A)-w,E=Math.floor(y*A)-y}f=E*i+b,a[v-y*t-w]=-f,a[v+y*t+w]=f,f=-E*i+b,a[v-y*t+w]=f,a[v+y*t-w]=-f}let o=i/2,l=i/2,u=1,g=2;s.frame=function(){o+=u,l+=g,o<0&&(o=0,u=-u),o>i-t&&(o=i-t,u=-u),l<0&&(l=0,g=-g),l>i-t&&(l=i-t,g=-g),s.background(r);let p=l*i+o;for(let w=0;w<t*t;++w)c[w]=r[Math.round(p)+Math.floor(w/t)*i+w%t+a[w]];c.blit(o,l)},s.loop()},life:function(t=300,e=300){s.init({background:0,frameRate:12,height:+e,width:+t});let i=s.width,r=s.height,n=.05,c=0,a=1,h=1,d=0,v=-1,f=Array.from(Array(i*r)).map(()=>Array.from(Array(2)));f.forEach(l=>{l[c]=d,l[a]=Math.random()<n?h:d});function o(l){let u=l%i,g=Math.floor(l/i),p=0;return g>0&&(u>0&&(p+=f[l-i-1][c]),u<i-1&&(p+=f[l-i+1][c]),p+=f[l-i][c]),g<r-1&&(u>0&&(p+=f[l+i-1][c]),u<i-1&&(p+=f[l+i+1][c]),p+=f[l+i][c]),u>0&&(p+=f[l-1][c]),u<i-1&&(p+=f[l+1][c]),p}s.stroke(255),s.frame=function(){s.background(0),f.forEach((l,u)=>{let g=f[u];if(l[a]===h||l[c]===h){g[c]=h;let x=u%i,m=u/i;s.point(x,m)}l[a]===v&&(g[c]=d),g[a]=d;let p=u-3*i;if(p<0)return;let w=f[p],y=o(p);y===3&&w[c]===d&&(w[a]=h),(y<2||y>3)&&w[c]===h&&(w[a]=v)})},s.loop()},orbit:function(t,e="off",i=66743e-15){s.init({showRuler:e==="full"});let r=s.width,n=s.height,c=r/2,a=n/2,h=s.PVector.bind(s),d=25,v=2,f=+i*1,o=1e13*2,l=1,u=2,g=n/4,p=Math.sqrt(f*o*l/g),w=.05,y=new $(s,function(){let x=new h(c,a),m=new h(this.x,this.y);m.sub(x);let b=new h(this.dx,this.dy),E=k.direction(0,0,b.x,b.y),A=b.mag(),L=new h(m.y,-m.x);L.normalize();let C=Math.sign(b.x*m.y-b.y*m.x);L.mult(C);let R=k.direction(this.x,this.y,c,a),P=m.mag(),O=f*o*l/(P/u)**v,S=new h(Math.cos(R),Math.sin(R)),U=-f*o*l/P,q=.5*l*A**2,T=q+U,_=b.dot(m)/P,G=Math.sqrt(A**2-_**2),N=[],F="";if(this.thrustX=0,this.thrustY=0,t!=="off"){let X=new h(m.x,m.y);X.normalize();let z=new h(X.y,-X.x);if(T>=0)if(N.push("ub"),p=Math.sqrt(f*o*l/P),X.mult(p),z.mult(p),A>p){let Q=Math.abs(_)>X.mag(),B=Math.abs(G)>z.mag();Q?_>0?(N.push("hra"),P<g&&!B?(F+=`
increase tangential velocity`,this.thrustX+=L.x,this.thrustY+=L.y):(F+=`
reduce radial velocity`,this.thrustX+=S.x,this.thrustY+=S.y)):(N.push("hrd"),P<g?(F+=`
increase radial velocity`,this.thrustX+=-S.x,this.thrustY+=-S.y):B||(F+=`
increase tangential velocity`,this.thrustX+=L.x,this.thrustY+=L.y)):_>0?(N.push("sra"),F+=`
increase radial velocity`,this.thrustX+=-S.x,this.thrustY+=-S.y):(N.push("srd"),F+=`
increase radial velocity`,this.thrustX+=-S.x,this.thrustY+=-S.y),B?(N.push("ft"),F+=`
reduce tangential velocity`,this.thrustX+=-L.x,this.thrustY+=-L.y):(N.push("st"),F+=`
increase tangential velocity`,this.thrustX+=L.x,this.thrustY+=L.y)}else P>g?N.push("ha"):N.push("la");else N.push("b"),p=Math.sqrt(2*f*o*l/P),X.mult(p),z.mult(p),A<p?(G<z.mag()&&(N.push("s"),P>g&&N.push("ha"),F+=`
increasing tangential velocity`,this.thrustX+=L.x,this.thrustY+=L.y),Math.abs(_)>X.mag()&&N.push("fr"),Math.abs(_)<X.mag()&&N.push("sr")):A>p&&N.push("?");let zt=2*Math.atan(d/P),Kt=Math.PI/8,Mt=(R-E+Math.PI)%(2*Math.PI)-Math.PI;if(Math.abs(Mt)<zt){N.push("c");let Q=R+Math.sign(-Mt)*(Math.PI/2+Kt);F+=`
alter course (${E.toFixed(2)} -> ${Q.toFixed(2)})`;let B=new h(Math.cos(Q),Math.sin(Q));this.thrustX+=B.x,this.thrustY+=B.y,e==="full"&&(B.setMag(w),s.stroke(255,128,64,255),s.line(this.x,this.y,this.x+B.x,this.y+B.y))}let Et=.5*l*p**2-f*o*l/g,Jt=Math.abs(T-Et)/Math.abs(Et),Zt=Math.abs(_)/Math.max(Math.abs(X.mag()),1e-6),Qt=Math.abs(G-z.mag())/Math.max(z.mag(),1e-6),te=Math.min(1,Math.max(.1,1-.5*(Jt+Zt+Qt))),ot=new h(this.thrustX,this.thrustY);ot.normalize(),ot.mult(w*te),this.thrustX=ot.x,this.thrustY=ot.y}if(S.mult(O),this.ddx=S.x+this.thrustX,this.ddy=S.y+this.thrustY,this.dx+=this.ddx,this.dy+=this.ddy,this.x+=this.dx,this.y+=this.dy,this.x>=r-1?(this.x=r-1,this.dx=0):this.x<0&&(this.x=0,this.dx=0),this.y>=n-1?(this.y=n-1,this.dy=0):this.y<0&&(this.y=0,this.dy=0),e==="full"){let X=`x: ${this.x}
y: ${this.y}
dx: ${this.dx}
dy: ${this.dy}
ddx: ${this.ddx}
ddy: ${this.ddy}
E: ${T}
E_p: ${U}
E_k: ${q}
v_t: ${G}
v_r: ${_}
v: ${A}
vTarg: ${p}
dist: ${P}
thrustX: ${this.thrustX}
thrustY: ${this.thrustY}
status: ${N.join(", ")??"pending"}
action: ${F??""}`;s.text(X,20,s.height-300),s.stroke(128,128,255,255),s.line(this.x,this.y,this.x+L.x*50,this.y+L.y*50)}},function(x){if(x.fill(this.r,this.g,this.b,this.a),x.stroke(this.r,this.g,this.b,this.a),x.ellipse(this.x,this.y,3,3),e==="full"){x.line(c,a,this.x,this.y);let m=new h(this.dx,this.dy);m.mult(10);let b=new h(this.thrustX,this.thrustY);b.mult(1e3),x.stroke(0,255,0,255),x.line(this.x,this.y,this.x+m.x,this.y+m.y),x.stroke(255,0,0,255),x.line(this.x,this.y,this.x+b.x,this.y+b.y)}});y.createParticle(0,k.roll(r),k.roll(n),1,1,255,255,255,255),s.frame=function(){e!=="on"&&s.background(0),y.render(),s.fill(255,255,200),s.stroke(255,255,0),s.ellipse(c,a,d,d)},s.background(0),s.loop()},pattern:function(t){let e=s.createImage(),i=e.height;for(let v=0;v<e.length;++v)e[v]=Ut(i,i/8,255,v);if(e.update(),s.background(e),t===void 0)return;s.init({showFrameRate:!0,showRuler:!0});let r=s.PVector.bind(s),n=20,c=360,a=s.width/2,h=s.height/2,d=Math.hypot(100,100);s.frame=()=>{s.background(0);let v=Math.PI/c*s.frameCount,f=Math.cos(v),o=Math.sin(v),l=Math.PI/n*s.frameCount,u=Math.cos(l),g=Math.sin(l),p=-g,w=u,y=new r(a,h),x=new r(f,o);x.setMag(d),x.add(y);let m=new r(f,o),b=new r(f,o);m.setMag(d*.33),b.setMag(d*.66);let E=new r(p,w);E.setMag(m.mag()*.5),E.add(m),E.add(y);let A=new r(u,g);A.setMag(b.mag()*.5),A.add(b),A.add(y);let L=new r(x.x,x.y);L.sub(y);let C=new r(E.x,E.y);C.sub(y);let R=(L.x*C.y-L.y*C.x)/L.mag()*1.5,P=new r(y.x,y.y);P.sub(x);let O=new r(-P.y,P.x);switch(O.setMag(R),O.add(x),s.fill(0,0,0,0),t){case"circles":case"full":if(s.stroke(255,0,0,255),s.line(y.x,y.y,x.x,x.y),s.ellipse(y.x+m.x,y.y+m.y,m.mag(),m.mag()),s.ellipse(y.x+b.x,y.y+b.y,b.mag(),b.mag()),s.stroke(0,255,0,255),s.line(y.x+m.x,y.y+m.y,E.x,E.y),s.line(y.x+b.x,y.y+b.y,A.x,A.y),s.line(x.x,x.y,O.x,O.y),s.ellipse(E.x,E.y,3,3),s.ellipse(A.x,A.y,3,3),s.ellipse(O.x,O.y,3,3),t==="circles")break;case"tail":s.stroke(255,255,255,255),s.bezier(y.x,y.y,E.x,E.y,A.x,A.y,O.x,O.y)}},s.loop()},plasma:function(){s.init({background:0,height:300,width:300});let t=s.width,e=s.height,i=s.createImage(),r={},n={};function c(g){let p=1-g/255,w=255*p,y=255*p*p;return[255*p*p*p*p,y,w,255]}for(let g=0;g<256;++g)n[g]=c(g);for(let g=0;g<512;++g){let p=g*.703125*.0174532;r[g]=Math.sin(p)*1024}let a=0,h=0,d=0,v=0,f=0,o=0,l=0,u=0;s.frame=function(){l=d,u=v;for(let g=0;g<e;++g){f=a+5,o=h+3,l&=511,u&=511;for(let p=0;p<t;++p){f&=511,o&=511;let y=128+(r[f]+r[o]+r[l]+r[u]>>4);i[g*t+p]=n[y],f+=5,o+=3}l+=1,u+=3}a+=9,d+=8,i.update(),s.background(i)},s.loop()},shader:function(){s.init({showFrameRate:!0,renderer:"WEBGL"});let t=s.width,e=s.height,i=`
			attribute vec3 aPosition;
			void main(){
				gl_PointSize = 10.0;
				gl_Position = vec4(aPosition, 1.0);
			}
		`,r=`
			precision mediump float;
			void main(){
				gl_FragColor = vec4(0.0, 1.0, 0.0, 1.0); // Green
			}
		`,n=s.externals.context;n.viewport(0,0,t,e),console.log("Canvas width:",n.canvas.width,"Height:",n.canvas.height),console.log("Viewport dimensions:",n.getParameter(n.VIEWPORT)),console.log("Max viewport dims:",n.getParameter(n.MAX_VIEWPORT_DIMS)),console.log("Supported extensions:",n.getSupportedExtensions()),console.log("Max vertex attribs:",n.getParameter(n.MAX_VERTEX_ATTRIBS)),console.log("Max texture size:",n.getParameter(n.MAX_TEXTURE_SIZE));let c=Yt(n,i,n.VERTEX_SHADER),a=Yt(n,r,n.FRAGMENT_SHADER),h=n.createProgram();n.attachShader(h,c),n.attachShader(h,a),n.linkProgram(h),n.getProgramParameter(h,n.LINK_STATUS)||console.error("Could not link shaders:",n.getProgramInfoLog(h)),n.useProgram(h);let d=new Float32Array([0,0,0]),v=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,v),n.bufferData(n.ARRAY_BUFFER,d,n.STATIC_DRAW);let f=n.getBufferParameter(n.ARRAY_BUFFER,n.BUFFER_SIZE);console.log("Buffer size (bytes):",f);let o=n.getAttribLocation(h,"aPosition");if(n.enableVertexAttribArray(o),n.vertexAttribPointer(o,3,n.FLOAT,!1,0,0),o===-1){console.error("Attribute aPosition not found in shader");return}console.log("aPosition location: ",n.getAttribLocation(h,"aPosition")),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST);let l=n.getError();l!==n.NO_ERROR&&console.error("WebGL error during setup:",l),s.frame=function(){n.clearColor(0,0,0,1),n.clear(n.COLOR_BUFFER_BIT),n.drawArrays(n.POINTS,0,1),n.flush();let u=n.getError();u!==n.NO_ERROR&&console.error("WebGL error during draw:",u)},s.loop()},snow:function(){let t=s.width,e=s.height,i=new $(s,function(){this.x+=this.dx,this.y+=this.dy,(this.x>=t-1||this.y>=e-1||this.y<0)&&(this.active=!1)});s.frame=function(){s.background(0),i.createParticle(0,k.range(-t/2,t-1),0,k.range(0,.25),k.range(.4,.6),255,255,255,k.range(96,255)),i.render()},s.loop()},spiro:function(t=!0,e=!1,i=!0){let r=s.width,n=s.height,c=s.PVector.bind(s),a=new c(r/2,n/2),h=new c(0,0),d=new c(0,0),v=i==="false"?360:36,f=r/2,o=100,l=k.roll(o),u=k.roll(f),g=Math.random(),p=Math.random(),w=(o+l)/l,y=(f-u)/u;s.frame=function(){let x=Math.PI/v*s.frameCount,m=Math.cos(x),b=Math.sin(x),E=Math.PI/v*s.frameCount*w,A=-Math.PI/v*s.frameCount*y,L=new c(m,b);L.setMag(f-u),L.add(a);let C=new c(m,b);C.setMag(o+l),C.add(a);let R=new c(Math.cos(E),Math.sin(E));R.setMag(l*g),R.add(C);let P=new c(Math.cos(A),Math.sin(A));P.setMag(u*p),P.add(L),i==="false"?(s.background(0),s.fill(0,0,0,0),s.stroke(0,255,0,255),s.ellipse(a.x,a.y,f*2,f*2),s.ellipse(a.x,a.y,o*2,o*2),t&&t!=="false"&&(s.stroke(255,255,255,255),s.line(a.x,a.y,L.x,L.y),s.line(L.x,L.y,P.x,P.y),s.stroke(255,0,0,255),s.ellipse(L.x,L.y,u*2,u*2),s.ellipse(P.x,P.y,2,2)),e&&e!=="false"&&(s.stroke(255,255,255,255),s.line(a.x,a.y,C.x,C.y),s.line(C.x,C.y,R.x,R.y),s.stroke(255,0,0,255),s.ellipse(C.x,C.y,l*2,l*2),s.ellipse(R.x,R.y,2,2))):(s.stroke(255,255,255,255),t&&t!=="false"&&(d.mag()===0&&d.set(P),s.line(d.x,d.y,P.x,P.y),d.set(P)),s.stroke(128,255,128,255),e&&e!=="false"&&(h.mag()===0&&h.set(R),s.line(h.x,h.y,R.x,R.y),h.set(R)))},s.loop()},stars:function(){let t=s.width,e=s.height,i=t/2,r=e/2,n=i*.75,c=new $(s,function(){let a=this.x-3*this.dx,h=this.y-3*this.dy;this.x+=this.dx,this.y+=this.dy,s.line(this.x,this.y,a,h),(this.x>=t-1||this.y>=e-1||this.x<0||this.y<0)&&(this.active=!1);let d=Math.hypot(this.dx,this.dy),v=Math.min(k.distance(this.x,this.y,i,r),i);this.a=128*Math.max(1-v/n,0)+64*(d/10)+64*Math.max(1-this.t++,0)});s.frame=function(){s.background(0);for(let a=0;a<20;++a){let h=(k.roll(t)+k.roll(t))/2,d=k.roll(e)+k.roll(e)/2,v=Math.min(k.distance(h,d,i,r),i),f=-Math.atan2(r-d,h-i),o=10*(v/i)+1;c.createParticle(0,h,d,Math.cos(f)*o,Math.sin(f)*o,255,255,255,0)}c.render()},s.loop()},wormhole:function(){s.init({});let t=s.width,e=s.height,i=t/2,r=e/2,n=1,c=30,a=new $(s,function(){this.dx*=1.01,this.dy*=1.01,this.x+=this.dx,this.y+=this.dy,(this.x<0||this.x>=t||this.y<0||this.y>=e)&&(this.active=!1)},function(f){f.stroke(this.r,this.g,this.b,this.a),f.point(this.x,this.y,2,2)});function h(f,o,l,u,g,p,w,y,x){let m=2*Math.PI/u;for(let b=0;b<u;++b){let E=m*b,A=f+Math.cos(E)*l,L=o+Math.sin(E)*l,C=Math.cos(E)*g,R=Math.sin(E)*g;a.createParticle(0,A,L,C,R,p,w,y,x)}}let d=i,v=r;s.frame=function(){s.background(0),s.frameCount%n===0&&(d=i+Math.cos(s.frameCount/100)*100,v=r+Math.sin(s.frameCount/100)*100,h(d,v,1,c,1,255,255,255,255)),a.render()},s.loop()}};Bt.exports=ye});var jt=Y((Re,Vt)=>{var ht=Gt(),ct=at().Renderer(),vt=Object.freeze({cat:{func:function(t){this.echo(ht[t].toString())},man:"Print code listing for [demo]"},clear:{func:function(){this.clear()}},help:{func:function(t){t===void 0?(this.echo("Available commands:"),Object.keys(vt).forEach(e=>this.echo(e))):this.echo(vt[t].man)},man:"Print help text for [command].  If no command is passed, list available commands.",usage:"help [command]"},init:{func:function(){ct.init()}},load:{func:function(t,...e){t in ht&&(this.echo(`Loading ${t}\u2026`),ct.init(),ht[t].apply(this,e))},man:"Load a demo.  Some demos accept additional arguments.\n<b>Example:</b>\n`load chaos 6`.",usage:"load [demo] [args]"},ls:{func:function(){this.echo("Available demos:"),Object.keys(ht).forEach(t=>this.echo(t))},man:"List available demos"},properties:{func:function(t){t===void 0&&this.echo(JSON.stringify(ct,null,2)),this.echo(ct[t])}}});Vt.exports=vt});var bt=(J(),et(K)).default,{Executor:xe}=ft();It();var{Renderer:me}=at();bt.setLogLevel("debug");var wt=new bt("index.js");window.addEventListener("load",()=>{wt.info("Creating renderer");let t=document.querySelector("canvas"),e=t.getBoundingClientRect();t.width=e.width,t.height=e.height,wt.debug(`initial canvas width (${t.width}) height (${t.height})`),me(t),wt.info("Creating executor");let i=document.querySelector("ng-terminal"),r=new bt("Executor.js");i.executor=xe.bind(i)(r,jt())});})();
