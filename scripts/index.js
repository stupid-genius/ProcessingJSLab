(()=>{var ut=Object.defineProperty;var ce=Object.getOwnPropertyDescriptor;var le=Object.getOwnPropertyNames;var de=Object.prototype.hasOwnProperty;var ue=(t,e)=>()=>(t&&(e=t(t=0)),e);var j=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),fe=(t,e)=>{for(var i in e)ut(t,i,{get:e[i],enumerable:!0})},pe=(t,e,i,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of le(e))!de.call(t,r)&&r!==i&&ut(t,r,{get:()=>e[r],enumerable:!(n=ce(e,r))||n.enumerable});return t};var V=t=>pe(ut({},"__esModule",{value:!0}),t);var B={};fe(B,{APITransport:()=>Nt,ConsoleTransport:()=>ft,FileTransport:()=>St,default:()=>F,interpolate:()=>Ht});function F(t){if(t===void 0)throw new Error("Logger requires the file name of where it's being used.");if(!new.target)return new F(...arguments);Object.defineProperties(this,{log:{value:function(e,i,n){z.indexOf(e)<=z.indexOf(F.state.currentLevel)&&Object.values(F.state.transports).forEach(r=>{queueMicrotask(()=>r.log({level:e,msg:i,category:t,...n}))})}}}),z.forEach(e=>{let i;e==="noop"?i=()=>{}:i=this.log.bind(this,e),Object.defineProperty(this,e,{value:i})})}function ft(t){if(!new.target)return new ft(...arguments);Object.defineProperty(this,"log",{value:function(e){let i=Object.assign({},t,e);if(i.isTable)console.table(i.msg,i.args);else if(i.group)console[i.group](i.msg);else{let[n,r]=i.style?.length===2?i.style:["font-weight: bold; color: green;","font-style: italic;"];console[i.level](`%c${i.timestamp||new Date().toLocaleTimeString("en-US",i.dateFmt)}%c %c[${i.category}]%c ${i.msg}`,n,"",r,"",...i.args||[])}}})}function St(t){if(window.showSaveFilePicker===void 0){let e="FileTransport requires the File System Access API";throw console.warn(e),new Error(e)}if(!new.target)return new St(...arguments);Object.defineProperty(this,"initialize",{value:async function(){try{let e=await window.showSaveFilePicker({types:[{description:"Log Files",accept:{"text/plain":[".log"]}}]});Object.defineProperty(this,"log",{value:async function(i){let n=Object.assign({},t,i),r;try{r=await e.createWritable({keepExistingData:!0}),await r.write(`${n.timestamp||new Date().toLocaleTimeString("en-US",n.dateFmt)} [${n.category}] ${n.level}: ${n.msg}
`)}catch(o){console.error(o)}finally{await r.close()}}})}catch(e){console.error(e)}}})}function Nt(t){if(!new.target)return new Nt(...arguments);Object.defineProperty(this,"log",{value:async function(e){let i=Ht(t,e);try{let n=await fetch(i.url,{method:i.method,headers:Object.entries(i.headers||{}).reduce((r,[o,h])=>(r[o]=h,r),{}),body:i.body});console.debug(n)}catch(n){console.error(n)}}})}var z,Ht,G=ue(()=>{z=["noop","error","warn","info","debug","silly"];Object.defineProperties(F,{addTransport:{value:(t,e)=>{F.state.transports[t]=e}},state:{value:{currentLevel:"noop",transports:{}}},level:{get:()=>F.state.currentLevel},removeTransport:{value:t=>{delete F.state.transports[t]}},setLogLevel:{value:t=>{if(z.some(e=>e===t))F.state.currentLevel=t;else throw new Error(`${t} is not a valid logger level`)}}});F.addTransport("default",ft({}));z.reduce((t,e)=>(Object.defineProperty(t,e.toUpperCase(),{enumerable:!0,get:()=>e}),t),F);Ht=function t(e,i){if(e instanceof Object){let n=Array.isArray(e)?[]:{};for(let r in e){let o=t(e[r],i);try{n[r]=JSON.parse(o)}catch{o!==void 0&&o!==""&&(n[r]=o)}}return n}return typeof e!="string"?e:e.replace(/\{\{(.+?)}}/g,(n,r)=>{let o=i[r]||"";return o instanceof Object?JSON.stringify(o):o})}});var qt=j((Te,Ft)=>{var pt;typeof window>"u"?pt=(G(),V(B)):pt=(G(),V(B)).default;var ye=new pt("getopt.js"),$t=function(t){ye.warn(t)};function w(t,e){typeof w.place>"u"&&(w.place="",w.iplace=0);let i;if(w.optreset>0||w.iplace===w.place.length){if(w.optreset=0,w.place=t[w.optind],w.iplace=0,w.optind>=t.length||w.place.charAt(w.iplace++)!=="-")return w.place="",w.iplace=0,"";if(w.optopt=w.place.charAt(w.iplace++),w.optopt==="-"&&w.iplace===w.place.length)return++w.optind,w.getopt.place="",w.getopt.iplace=0,"";if(w.optopt===0){if(w.place="",w.iplace=0,e.indexOf("-")===-1)return"";w.optopt="-"}}else w.optopt=w.place.charAt(w.iplace++);if(w.optopt===":"||(i=e.indexOf(w.optopt))===-1)return w.iplace===w.place.length&&++w.optind,w.opterr&&e.charAt(0)!==":"&&$t("illegal option -- "+w.optopt),"?";if(e.charAt(i+1)!==":")w.optarg=null,w.iplace===w.place.length&&++w.optind;else{if(w.iplace<w.place.length)w.optarg=w.place.substr(w.iplace);else if(t.length>++w.optind)w.optarg=t[w.optind];else return w.place="",w.iplace=0,e.charAt(0)===":"?":":w.opterr?($t("option requires an argument -- "+w.optopt),":"):"?";w.place="",w.iplace=0,++w.optind}return w.optopt}w.opterr=1;w.optind=0;w.optopt="";w.optreset=0;w.optarg="";Ft.exports=w});var yt=j((ke,Dt)=>{var _=qt();function $(t,e,i){if(typeof e=="function")return function(){return e.apply(this,arguments)||$.OK};let n=this;n.echo===void 0&&(n.echo=t.info);let r=[],o=/"([^"]*)"|'([^']*)'|\S+/g,h=async function(c){t.info(`Executing: ${c}`);let d=c.match(o).map(u=>u.replace(/^['"]|['"]$/g,"")),f=d.shift(),l=e[f];if(l===void 0){if(r.includes(f))try{let u=JSON.stringify(await i(c));return t.debug(`RPC Response: ${u}`),n.echo(u),$.OK}catch(u){return n.echo(u),$.ECMDERR}return n.echo(`${f}: no such command`),$.ENOTFOUND}let{func:a,opts:p,usage:x}=l,g=p;if(x&&(g=g?`${g}h`:"h"),g!==void 0){t.debug(`Parsing options: ${g} with ${d}`);let u={},y;for(_.optreset=1,_.optind=0;(y=_(d,g))!=="";)switch(t.debug(`Opt: ${y}, optarg: ${_.optarg}, optind: ${_.optind}`),y){case"h":return n.echo(`Usage: ${x}`),$.OK;case":":return n.echo(`${_.optopt}: option needs a value`),$.EBADARGS;case"?":return n.echo(`${_.optopt}: no such option`),$.EBADARGS;default:t.debug(`Switch: ${y}, optarg: ${_.optarg}`),u[y]=_.optarg||!0}a.opts=u,t.debug(`Switches: ${JSON.stringify(u)}`)}else _.optind=0;return t.debug(`Terms: ${d}`),await a.apply(this,d.slice(_.optind))??$.OK};return i!==void 0&&queueMicrotask(async function(){let c=await i("system.describe");t.debug(`system.describe result: ${c}`),JSON.parse(c).procs.forEach(d=>r.push(d)),e.help.rpcList=r,t.debug(`RPC List: ${r}`),Object.defineProperties(h,{login:{value:async function(d,f){t.info(`Attempting to log in user ${d}`);try{let l=await i(`login ${d} ${f}`);if(l===!1)return n.echo("Login failed"),$.NOTOKEN;let a=i;return h.exit??Object.defineProperty(h,"exit",{value:async function(){t.info("Logging out"),i=a,n.authState=$.NOTOKEN,n.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!0}}))}}),i=new Proxy(i,{apply:function(p,x,g){return p(g[0],l)}}),$.OK}catch(l){return t.error(l),l}}}})}),h}var Q=0;Object.defineProperties($,{OK:{value:Q++},ENOTFOUND:{value:Q++},ECMDERR:{value:Q++},EBADARGS:{value:Q++},NOTOKEN:{value:Q++}});function ge(t,e){let i=0;return function(n,r){try{t.info(`Executing RPC: ${n}`);let o=n.trim().split(/\s+/),h=o.shift(),c=o;r&&(c={token:r,params:c}),t.debug(`Method: ${h}, params: ${c}`);try{return e.jsonrpc({id:i++,method:h,params:c}).then(d=>{let f=JSON.parse(d);if(t.debug(`Response: ${JSON.stringify(f)}`),f.error)throw new Error(f.error.message);return f.result})}catch(d){return t.error(d),d}}catch(o){return t.error(o),o}}}Dt.exports={JSONRPCClient:ge,Executor:$}});var _t=j(()=>{var{Executor:Y}=yt(),gt=(G(),V(B)).default,R=new gt("Terminal.js"),xe=100,me=1e3,xt=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.parentTerminal=null,this.commandHistory=[],this.historyIndex=-1;let e=localStorage.getItem("commandHistory");e&&(this.commandHistory=JSON.parse(e),R.debug(`Loading command history (${this.commandHistory.length} items)`),this.historyIndex=this.commandHistory.length),this.inputHandler=this.inputHandler.bind(this),this.reset=this.reset.bind(this),this.addEventListener("terminal-reset",this.reset);let i=function(){R.debug("DOMContentLoaded event fired"),this.reset(new CustomEvent("terminal-reset",{detail:{clear:!0}})),document.removeEventListener("DOMContentLoaded",i)}.bind(this);document.addEventListener("DOMContentLoaded",i)}connectedCallback(){R.debug("Terminal connected")}disconnectedCallback(){R.debug("Terminal disconnected"),this.inputLine.removeEventListener("keydown",this.inputHandler),this.removeEventListener("click",this.focusHandler)}reset(e){if(R.debug(`Terminal reset (${this.parentTerminal?"sub-terminal":"main terminal"})`),R.debug(`Auth state: ${this.authState}, RPC enabled: ${this.rpcEnabled}`),this.rpcEnabled&&this.authState!==Y.OK)R.debug("logging in"),this.loginModal();else{let i=e.detail?.clear??!1;R.debug(`reset ${i?"and clear ":""}terminal`),this.uiModal(i)}this.focusHandler=function(){this.inputLine.focus()}.bind(this),this.addEventListener("click",this.focusHandler),this.focusHandler()}applyStyles(){let e=this.querySelector("style").cloneNode(!0);this.shadowRoot.appendChild(e)}loginModal(){this.shadowRoot.innerHTML="",this.applyStyles();let e=this.querySelector("template#login").content.cloneNode(!0);this.shadowRoot.appendChild(e),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.output=this.shadowRoot.querySelector(".output"),this.echo("Please log in");let i,n,r=async o=>{if(o.key==="Enter"){o.preventDefault();let h=(this.inputLine.value??this.inputLine.textContent).trim();if(i===void 0?i=h:n=h,i&&n)try{if(this.authState=await this.executor.login(i,n),R.debug(`Login state: ${this.authState}`),this.authState===Y.NOTOKEN){this.loginModal(),this.focusHandler();return}this.inputLine.removeEventListener("keydown",r),this.removeEventListener("click",this.focusHandler),this.reset(new CustomEvent("terminal-reset",{detail:{clear:!0}}))}catch(c){this.echo(c),R.error(c)}else{R.debug(`awaiting password for ${i}`);let c=document.createElement("input");c.type="password",c.classList.add("input-line"),this.inputLine.textContent=this.inputLine.value="",this.inputLine.removeEventListener("keydown",r),this.removeEventListener("click",this.focusHandler),this.inputLine.replaceWith(c),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.prompt="password:",this.inputLine.addEventListener("keydown",r),this.addEventListener("click",this.focusHandler),this.focusHandler()}}};this.inputLine.addEventListener("keydown",r)}uiModal(e){let i=this.shadowRoot.querySelector(".output")?.innerHTML;this.shadowRoot.innerHTML="",this.applyStyles();let n=this.querySelector("template#ui").content.cloneNode(!0);this.shadowRoot.appendChild(n),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.output=this.shadowRoot.querySelector(".output"),e&&this.greeting?(R.debug("clearing terminal"),this.echo(this.greeting)):this.output.innerHTML=i??"",this.inputLine.addEventListener("keydown",this.inputHandler),this.inputLine.focus()}get executor(){return this._executor}set executor(e){R.info("Setting executor"),this._executor=e}get greeting(){return this.getAttribute("greeting")}set greeting(e){e===void 0?this.removeAttribute("greeting"):this.setAttribute("greeting",e)}get prompt(){return this.shadowRoot.querySelector(".prompt").textContent}set prompt(e){let i=this.shadowRoot.querySelector(".prompt");i.innerHTML=`${e}&nbsp;`}get rpcEnabled(){return this.getAttribute("rpc")==="true"}inputHandler(e){switch(e.key){case"Enter":{e.preventDefault();let i=this.inputLine.textContent.trim();this.inputLine.textContent="",this.echo(`${this.prompt}${i}`),this.processCommand(i),this.historyIndex=this.commandHistory.length;break}case"ArrowUp":R.debug(`History index (back): ${this.historyIndex}`),this.historyIndex>0&&(this.historyIndex-=1,this.inputLine.textContent=this.commandHistory[this.historyIndex]);break;case"ArrowDown":R.debug(`History index (forward): ${this.historyIndex}`),this.historyIndex<this.commandHistory.length-1?(this.historyIndex+=1,this.inputLine.textContent=this.commandHistory[this.historyIndex]):(this.historyIndex=this.commandHistory.length,this.inputLine.textContent="");break}}async processCommand(e){try{let i=await this.executor(e);switch(R.debug(`Status: ${i}`),i){case Y.OK:R.debug(`${e} executed successfully`),e!==this.commandHistory[this.commandHistory.length-1]&&(this.commandHistory.push(e),this.commandHistory.length>xe&&this.commandHistory.shift(),localStorage.setItem("commandHistory",JSON.stringify(this.commandHistory)));break;case Y.ENOTFOUND:R.info(`${e} not found`);break;case Y.ECMDERR:R.error(`Error executing ${e}`);break;case Y.EBADARGS:R.warn(`${e} called with bad arguments`);break;default:R.error(`Unknown status: ${i} for ${e}`);break}}catch(i){R.error(i),this.echo(i)}}clear(){this.output.innerHTML=""}echo(e){for(e!=null&&e!==""&&(this.output.innerHTML+=`<div>${e}</div>`);this.output.children.length>me;)this.output.removeChild(this.output.firstChild);this.inputLine.getBoundingClientRect().bottom>window.innerHeight&&this.inputLine.scrollIntoView({behavior:"smooth"})}log(e){gt.level==="debug"&&(typeof e=="string"?console.info(e):console.dir(e))}startSubTerminal(e){R.info(`Starting sub-terminal: ${e.name}`),this.removeEventListener("terminal-reset",this.reset);let i=new gt(`Executor.js (${e.name})`),n=document.createElement("ng-terminal");return n.innerHTML=this.innerHTML,n.greeting=e.greeting,n.executor=Y.bind(n)(i,e.registry),n.parentTerminal=this,this.replaceWith(n),n.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!0}})),e.prompt!==void 0&&(n.prompt=e.prompt),n}exitSubTerminal(){this.parentTerminal?(R.info("Exiting sub-terminal"),R.debug(`Parent terminal: ${JSON.stringify(this.parentTerminal)}`),this.parentTerminal.addEventListener("terminal-reset",this.parentTerminal.reset),this.replaceWith(this.parentTerminal),this.parentTerminal.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!1}}))):R.warn("No parent terminal found")}};customElements.define("ng-terminal",xt)});var it=j((Ie,Xt)=>{var we=(G(),V(B)).default,U=new we("Renderer.js");function mt(t,e){if(!new.target)return new mt(...arguments);let i=t.pixels.toArray(),n=i.length,r=new Proxy(t,{get:function(o,h,c){if(typeof h=="string"&&!isNaN(h)){let d=+h;if(Number.isInteger(d)&&d>=0&&d<n)return i[d]}else return Reflect.get(o,h,c)},set:function(o,h,c,d){if(typeof h=="string"&&!isNaN(h)){let f=Math.round(+h);Number.isInteger(f)&&f>=0&&f<n?i[f]=Array.isArray(c)?e.color(...c):c:U.noop(`index ${f} out of range, ${n}`)}else return Reflect.set(o,h,c,d)}});return t.loaded=!0,Object.defineProperties(r,{blit:{value:function(o,h){t.pixels.set(i),e.image(t,o,h)}},length:{value:i.length},update:{value:function(){t.pixels.set(i)}}}),r}function wt(t){if(!new.target)return new wt(...arguments);let e=0,i=[];Object.defineProperties(i,{flip:{value:function(){e^=1}},read:{get:function(){return this[e^1]}},write:{get:function(){return this[e]}}});let n=t.createImage();i.push({buffer:n,get pixels(){return n.pixels.toArray()}});let r=t.createImage();i.push({buffer:r,get pixels(){return r.pixels.toArray()}}),Object.defineProperties(this,{flip:{value:function(){let o=i.write.buffer;o.update(),t.background(o),i.flip()}},readBuffer:{get:function(){return i.read.pixels}},writeBuffer:{get:function(){return i.write.buffer}}})}function Z(t){if(Z.instance!==void 0)return Z.instance;if(!new.target)return new Z(...arguments);let e=new Proxy(this,{get:function(f,l){return f[l]??n[l]}});Object.defineProperty(Z,"instance",{value:e});let i={background:4278849802,frameRate:60,height:t.height,showFrameRate:!1,showRuler:!1,width:t.width},n,r=!1,o=!1,h=50,c=5,d=[];return Object.defineProperties(this,{createImage:{value:function(f,l){let a=n.createImage(f??t.width,l??t.height);return new mt(a,n)}},frame:{set:function(f){let l=n.width/2,a=n.height/2,p=new Proxy(f,{apply:function(x,g,u){if(x.apply(g,u),r&&(n.fill(255),n.textSize(12),n.text(n.__frameRate,n.width-50,n.height-10)),o){n.stroke(255),n.line(0,a,n.width,a),n.line(l,0,l,n.height);for(let y=h;y<n.width;y+=h)n.point(l+y,a-1),n.point(l-y,a-1),n.point(l+y,a+1),n.point(l-y,a+1);for(let y=h;y<n.height;y+=h)n.point(l-1,a+y),n.point(l-1,a-y),n.point(l+1,a+y),n.point(l+1,a-y)}}});Object.defineProperty(n,"draw",{value:p,writable:!0}),U.debug("pjs.draw set")}},doubleBuffer:{value:function(){return new wt(this)}},echo:{value:function(f){d.push(f),d.length>c&&d.shift()}},init:{value:function(f){if(n!==void 0){n.exit(),n=void 0;let a=document.createElement("canvas");t.replaceWith(a),t=a}let l=Object.assign({},i,f);n=new Processing(t,a=>{U.info("Processing.js created"),U.debug(`canvas width (${t.width}) height (${t.height})`),Object.defineProperties(a,{keyPressed:{value:function(){switch(a.keyCode){case a.UP:a.loop();break;case a.DOWN:a.noLoop();break;case a.LEFT:a.save("image.png");break;case a.RIGHT:a.redraw()}},writable:!0},setup:{value:function(){a.size(l.width,l.height,a[l.renderer]),U.debug(`processingjs width (${a.width}) height (${a.height}) ${a.use3DContext}`),a.frameRate(l.frameRate),a.noLoop(),a.background(l.background),r=l.showFrameRate,o=l.showRuler,U.info("Processing.js setup")},writable:!0}})})}},input:{set:function(f){U.debug("keyPressed set"),Object.defineProperty(n,"keyPressed",{value:f,writable:!0})}},pixelHeight:{get:function(){return 0}},pixelWidth:{get:function(){return 0}}}),this.init(),e}Xt.exports={DoubleBuffer:wt,Image:mt,Renderer:Z}});var Yt=j((Se,jt)=>{function W(){if(W.instance instanceof W)return W.instance;if(!new.target)return new W(...arguments);Object.defineProperty(W,"instance",{value:this});let t=Math.PI/180;Object.defineProperties(this,{cos:{value:{},enumerable:!0},sin:{value:{},enumerable:!0}});for(let e=0;e<=360;++e)Object.defineProperty(this.cos,e,{value:Math.cos(e*t)}),Object.defineProperty(this.sin,e,{value:Math.sin(e*t)})}var tt=Object.freeze({addColors:(...t)=>t.length===0?[]:t[0].map((e,i)=>t.reduce((n,r)=>n+r[i],0)),decodeColor:t=>[t>>16&255,t>>8&255,t&255,t>>>24],direction:(t,e,i,n)=>Math.atan2(n-e,i-t),distance:(t,e,i,n)=>Math.hypot(Math.abs(i-t),Math.abs(n-e)),fastInvSqrt:t=>{let i=new Float32Array([t]),n=new Float32Array([t]),r=new Int32Array(i.buffer);return r[0]=1597463007-(r[0]>>1),n[0]=i[0],n[0]=n[0]*(1.5-t*.5*n[0]*n[0]),n[0]},fastTrig:W(),invSqrt:t=>1/Math.sqrt(t),randomColor:(t=!1)=>{let e=Array.from({length:3},()=>tt.roll(255));return e.push(t?tt.roll(255):255),e},randomGrayscale:(t=!1)=>{let e=tt.roll(255),i=Array.from({length:3},()=>e);return i.push(t?tt.roll(255):255),i},range:(t,e)=>{let i=Math.random()*(e-t);return Number.isInteger(t)&&Number.isInteger(e)&&(i=Math.floor(i)),i+t},roll:t=>Math.floor(Math.random()*t)});jt.exports=tt});var Gt=j((Ne,Bt)=>{function be(){this.x+=this.dx,this.y+=this.dy}function Me(t){t.stroke(this.r,this.g,this.b,this.a),t.point(this.x,this.y)}function Ut(t,e=be,i=Me){if(!new.target)return new Ut(...arguments);let n=2,r=new o;r.next=new o,r.prev=r.next,r.prev.next=r,r.prev.prev=r,r.active=!1,r.prev.active=!1,this.ACCELERATION=[0,.25],this.ELASTICITY=.2,this.MAX_COUNT=1e4,Object.defineProperties(this,{count:{get:function(){return n}},createParticle:{value:function(h,c,d,f,l,a,p,x,g){let u;if(r.prev.active){if(n>=this.MAX_COUNT)return;u=new o(h,c,d,f,l,a,p,x,g),u.next=r,u.prev=r.prev,u.prev.next=u,r.prev=u,r=u,++n}else u=r.prev,u.activate(h,c,d,f,l,a,p,x,g),r=u;return u}},list:{get:function(){return r}},render:{value:function(){let h=r;for(;h.active;){e.call(h,this),i.call(h,t);let c=h;if(h.ttl>0&&++h.t>=h.ttl&&(h.active=!1),h=h.next,h===r)break;c.active||(c===r?r=c.next:(c.next.prev=c.prev,c.prev.next=c.next,c.next=r,c.prev=r.prev,r.prev.next=c,r.prev=c))}}}});function o(h,c,d,f,l,a,p,x,g){if(!new.target)return new o(...arguments);Object.defineProperties(this,{activate:{value:function(u,y,b,A,C,T,L,k,P){this.active=!0,this.ttl=u,this.t=0,this.x=y,this.y=b,this.dx=A,this.dy=C,this.ddx=0,this.ddy=0,this.dddx=0,this.dddy=0,this.r=T,this.g=L,this.b=k,this.a=P}}}),this.activate(h,c,d,f,l,a,p,x,g)}}Bt.exports=Ut});var Kt=j((He,Jt)=>{function Wt(t=10){if(!new.target)return new Wt(...arguments);let e=new Map;Object.defineProperties(this,{add:{value:function(i,n,r){let o=`${Math.floor(i/t)},${Math.floor(n/t)}`;if(e.has(o)){let h=e.get(o);h.includes(r)||h.push(r)}else e.set(o,[r])}},get:{value:function(i,n){let r=`${Math.floor(i/t)},${Math.floor(n/t)}`;return e.get(r)??[]}},remove:{value:function(i,n,r){let o=`${Math.floor(i/t)},${Math.floor(n/t)}`,h=e.get(o);if(h!==void 0){let c=h.indexOf(r);c!==-1&&h.splice(c,1)}}}})}Jt.exports={Space:Wt}});var Qt=j(($e,zt)=>{var m=Yt(),N=Gt(),s=it().Renderer(),{Space:ve}=Kt();function Vt(t,e,i,n){let r=n%t,o=Math.floor(n/t),h=i,c=Math.floor(r/e)%2==0,d=Math.floor(o/e)%2==0;return c!=d&&(h=0),[h,h,h,255]}var Ee={"3d":function(){s.init({renderer:"P3D"});let t=s.width,e=s.height,i=0,n=255,r=255,o=255;s.frame=function(){s.background(0),s.camera(t/2,e/5,200,t/2,e/2,0,0,1,0),s.pointLight(n,r/10,o/10,t/3,e/3,100),s.pointLight(n/10,r,o/10,300,t/3,100),s.pointLight(n/10,r/10,o,300,300,-100),s.pointLight(n,r,o,t/3,300,-100),s.translate(t/2,e/2),s.rotateY(i),s.normal(0,0,1),s.fill(128),s.rect(-100,-100,200,200),i+=.01},s.loop()},ants:function(){let t=s.width,e=s.height,i=200,n=1,r=s.createImage();r.update();let o=new N(s,function(h){let c=h.list,d=c;for(;d.active;){if(d===this){if(d=d.next,d===c)break;continue}if(d=d.next,d===c)break}this.last??=m.roll(60),this.last++>60&&(this.ddx=m.range(-.05,.05),this.ddy=m.range(-.05,.05),this.last=0),this.dx+=this.ddx,this.dy+=this.ddy;let f=Math.hypot(this.dx,this.dy);f>n&&(this.dx=this.dx/f*n,this.dy=this.dy/f*n);let l=this.x-3*this.dx,a=this.y-3*this.dy;this.x+=this.dx,this.y+=this.dy,s.line(this.x,this.y,l,a),this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-1?(this.y=e-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1)});for(let h=0;h<i;++h)o.createParticle(0,m.range(1e-4,t),m.range(1e-4,e),0,0,207,16,32);s.stroke(0,0,0,255),s.frame=function(){s.background(r),o.render()},s.loop()},balls:function(){s.init({showFrameRate:!0});let t=s.width,e=s.height,i=1e3,n=10,r=2,o=new ve(n*3),h=new N(s,function(){this.x+=this.dx,this.y+=this.dy,this.x<0&&(this.x=0,this.dx*=-1),this.x>t&&(this.x=t,this.dx*=-1),this.y<0&&(this.y=0,this.dy*=-1),this.y>e&&(this.y=e,this.dy*=-1);let c=o.get(this.x,this.y);for(let f=0;f<c.length;++f){let l=c[f];if(l===this)continue;let a=Math.hypot(this.x-l.x,this.y-l.y);if(a<n){let p=Math.atan2(this.y-l.y,this.x-l.x),x=(n-a)/n;this.dx+=Math.cos(p)*x,this.dy+=Math.sin(p)*x,l.dx-=Math.cos(p)*x,l.dy-=Math.sin(p)*x,this.x+=this.dx,this.y+=this.dy,l.x+=l.dx,l.y+=l.dy}}o.add(this.x,this.y,this);let d=Math.hypot(this.dx,this.dy);d>r&&(this.dx=this.dx/d*r,this.dy=this.dy/d*r)},function(c){c.fill(this.r,this.g,this.b,this.a),c.stroke(this.r,this.g,this.b,this.a),c.ellipse(this.x,this.y,n,n)});for(let c=0;c<i;++c){let d=h.createParticle(0,m.range(.01,t),m.range(.01,e),m.range(-1,1.01),m.range(-1,1.01),...m.randomColor());o.add(d.x,d.y,d)}s.frame=function(){s.background(0),h.render()},s.loop()},boids:function(){let t=s.width,e=s.height,i=t/2,n=e/2,r=200,o=3,h=5e-4,c=100,d=40,f=1,l=1.25,a=1,p=.75,x=new N(s,function(u){let y=0,b=0,A=0,C=0,T=0,L=0,k=0,P=0,E=0,v=0,O=u.list,M=O;for(;M.active;){if(M===this){if(M=M.next,M===O)break;continue}let S=Math.hypot(this.x-M.x,this.y-M.y);if(S<c&&(y+=M.dx,b+=M.dy,A+=M.x,C+=M.y,E++),S<d){let I=(d-S)/d;T+=(this.x-M.x)*I,L+=(this.y-M.y)*I,v++}if(M=M.next,M===O)break}if(E>0){y/=E,b/=E;let S=Math.hypot(y,b);S>0&&(y=y/S*h*f,b=b/S*h*f),A=(A/E-this.x)*h*l,C=(C/E-this.y)*h*l}if(v>0){T/=v,L/=v;let S=Math.hypot(T,L);S>0&&(T=T/S*h*a,L=L/S*h*a)}if(Math.random()>p){let S=Math.atan2(this.dy,this.dx)+m.range(-.1,.1),I=Math.hypot(this.dx,this.dy);k=I*Math.cos(S)-this.dx,P=I*Math.sin(S)-this.dy}this.ddx=y+A+T+k,this.ddy=b+C+L+P,this.dx+=this.ddx,this.dy+=this.ddy;let q=Math.hypot(this.dx,this.dy);q>o&&(this.dx=this.dx/q*o,this.dy=this.dy/q*o);let D=this.x-3*this.dx,X=this.y-3*this.dy;this.x+=this.dx,this.y+=this.dy,s.line(this.x,this.y,D,X),this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-1?(this.y=e-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1)}),g=m.range(0,2*Math.PI);for(let u=0;u<r;++u){let y=m.range(.001,1)*o,b=m.range(-.1,.1);x.createParticle(0,m.range(i-10.01,i+10),m.range(n-10.01,n+10),y*Math.cos(b+g),y*Math.sin(b+g),...m.randomColor())}s.stroke(0,0,0,255),s.frame=function(){s.background(0),x.render()},s.loop()},bz:function(){let t=s.width,e=Array.from({length:8},()=>Math.random()*t),i=Array.from({length:8},()=>Math.random()*t),n=Array.from({length:8},()=>Math.random()*15);s.background(255),s.noFill(),s.frame=function(){s.stroke(0,0,0,20),e.map(function(r,o,h){let c=r+n[o];c<0?(c=0,n[o]*=-1):c>t&&(c=t,n[o]*=-1),h[o]=c}),s.bezier.apply(null,e),s.stroke(255,128,128,20),i.map(function(r,o,h){let c=r+n[o];c<0?(c=0,n[o]*=-1):c>t&&(c=t,n[o]*=-1),h[o]=c}),s.bezier.apply(null,i)},s.loop()},cell:function(t=30,e=!1,i=200,n=200){s.init({background:0,frameRate:400,height:+n,width:+i});let r=s.width,o=s.height,h=1,c=0,d=new Array(r*o).fill(c),f=(p=>{let x=p.toString(2).padStart(8,"0"),g=[];for(let u=0;u<8;++u)+x[7-u]&&g.push(u);return(u,y)=>{let b=(y-1)*r+u,A=parseInt([d[b-1],d[b],d[b+1]].join(""),2);return g.some(C=>A===C)?h:c}})(+t);if(s.stroke(255),e===!1||e==="false")d[r/2]=h,s.point(r/2,0);else if(e==="random")for(let p=0;p<r;++p)Math.random()>.5&&(d[p]=h,s.point(p,0));else{let p=e.length,x=Math.floor((r-p)/2);for(let g=0;g<p;++g)+e[g]&&(d[x+g]=h,s.point(x+g,0))}let l=0,a=d.length/r;s.frame=function(){for(let p=0;p<r;++p){let x=f(p,l);x&&(d[l*r+p]=x,s.point(p,l))}l!==a&&l++},s.loop()},chaos:function(t="3"){s.init({frameRate:400});let e=s.width,i=s.height,n=e/2,r=i/2,o=n-50,h=Math.PI/180,c={3:[{x:e/2,y:50},{x:50,y:i-50},{x:e-50,y:i-50}],5:[{x:e-50,y:50},{x:50,y:50},{x:50,y:i-50},{x:e-50,y:i-50},{x:n,y:r}],6:[{x:Math.cos(0)*o+n,y:Math.sin(0)*o+r},{x:Math.cos(60*h)*o+n,y:Math.sin(60*h)*o+r},{x:Math.cos(120*h)*o+n,y:Math.sin(120*h)*o+r},{x:Math.cos(180*h)*o+n,y:Math.sin(180*h)*o+r},{x:Math.cos(240*h)*o+n,y:Math.sin(240*h)*o+r},{x:Math.cos(300*h)*o+n,y:Math.sin(300*h)*o+r}]}[t],d={3:2,5:1.5,6:1.5}[t];s.background(0),s.stroke(255,255,255,255);for(let{x:a,y:p}of c)s.point(a,p);let f=Math.random()*e,l=Math.random()*i;s.frame=function(){let a=m.roll(c.length);f+=(c[a].x-f)/d,l+=(c[a].y-l)/d,s.point(f,l)},s.loop()},fire:function(){s.init({background:0,frameRate:60,height:300,showFrameRate:!1,width:300});let t=s.width,e=s.doubleBuffer(),i=s.createImage(),n=s.color(255,128,96),r=4294940974;for(let d=0;d<i.length;++d)i[d]=419076398;i.update();let o=e.writeBuffer;for(let d=0;d<o.length;++d)o[d]=[0,0,0,255];e.flip(),o=e.writeBuffer;for(let d=0;d<o.length;++d)o[d]=[0,0,0,255];e.flip();let h=e.readBuffer.length/t,c=new N(s,function(){this.x+=this.dx,this.y+=this.dy,this.dy-=.05,this.x<1&&(this.x=1,this.dx*=-.5),this.x>=t-2&&(this.x=t-2,this.dx*=-.5),(this.y|0)<4&&(this.active=!1)},function(d){e.writeBuffer[(this.y|0)*t+this.x]=d.color(this.r,this.g,this.b,this.a*(1-this.t/this.ttl))});s.frame=function(){let d=e.readBuffer,f=e.writeBuffer;for(let l=0;l<t;++l)Math.random()>.97&&c.createParticle(m.range(12,24)*4,l,h-1,m.range(-.95,.95),-m.range(.01,.0625),r);for(let l=t;l<f.length-t;++l){if(l%t<1||l%t>=t-1)continue;let a=l/t;if(Math.random()<Math.pow(Math.E,Math.pow(a/h,10))-1&&Math.random()>.995){f[l-1]=n,f[l+1]=n,c.createParticle(m.range(12,24)*2,l%t,l/t,m.range(-.3,.3),-m.range(.01,.0625),n);continue}f[l]=m.addColors(m.decodeColor(d[l-1]),m.decodeColor(d[l]),m.decodeColor(d[l]),m.decodeColor(d[l+1]),m.decodeColor(d[l+t])).map((p,x)=>{if(x===3)return 255;let g=p/5.3;return g<10?0:g})}c.render(),e.flip()},s.loop()},fireworks:function(t=1){let e=s.width,i=s.height;t=+t;let n=t===0?function(a){a.stroke(this.r,this.g,this.b,this.a),a.point(this.x,this.y)}:function(a){a.fill(this.r,this.g,this.b,this.a),a.ellipse(this.x,this.y,t*this.ttl/this.t,t*this.ttl/this.t)},r=new N(s,function(){this.dx+=r.ACCELERATION[0],this.dy+=r.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let a=1-this.t/this.ttl;this.r=255*Math.pow(a,.2),this.g=255*a*a,this.b=255*a*a*a*a,this.a=255*a},n),o=new N(s,function(){this.dx+=o.ACCELERATION[0],this.dy+=o.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let a=1-this.t/this.ttl;this.b=255*Math.pow(a,.2),this.g=255*a*a,this.r=255*a*a*a*a,this.a=255*a},n),h=new N(s,function(){this.dx+=h.ACCELERATION[0],this.dy+=h.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let a=1-this.t/this.ttl;this.g=255*Math.pow(a,.2),this.r=255*a*a,this.b=255*a*a*a*a,this.a=255*a},n),c=new N(s,function(){this.dx+=c.ACCELERATION[0],this.dy+=c.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let a=1-this.t/this.ttl;this.r=255*Math.pow(a,.2),this.g=255*Math.pow(a,.2),this.b=255*a*a*a*a,this.a=255*a},n),d=new N(s,function(){this.dx+=d.ACCELERATION[0],this.dy+=d.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let a=1-this.t/this.ttl;this.r=255*Math.pow(a,.2),this.b=255*a*a*a*a,this.g=255*a,this.a=255*a},n),f=new N(s,function(){this.dx+=f.ACCELERATION[0],this.dy+=f.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let a=1-this.t/this.ttl;this.r=255*Math.pow(a,.2),this.b=255*Math.pow(a,.2),this.g=255*a*a*a*a,this.a=255*a},n);r.ACCELERATION=[0,.15],o.ACCELERATION=[0,.15],h.ACCELERATION=[0,.15],c.ACCELERATION=[0,.15],d.ACCELERATION=[0,.15],f.ACCELERATION=[0,.15];function l(a,p){let x;switch(m.range(0,5)){case 0:x=r;break;case 1:x=o;break;case 2:x=h;break;case 3:x=c;break;case 4:x=f;break;case 5:x=d;break}for(let g=0;g<300;++g){let u=m.range(0,Math.PI*2),y=m.range(.001,10);x.createParticle(m.range(50.001,100),a,p,Math.cos(u)*y,Math.sin(u)*y,0,0,0,0)}}s.frame=function(){s.background(0),Math.random()>.95&&l(m.range(.001,e),m.range(.001,i/2)),r.render(),o.render(),h.render(),c.render(),f.render(),d.render()},s.loop()},fountain:function(){let t=s.width,e=s.height,i=new N(s,function(){this.dx+=i.ACCELERATION[0],this.dy+=i.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let o=1-this.t/this.ttl;this.r=255*Math.pow(o,.2),this.g=255*o*o,this.b=255*o*o*o*o,this.a=255*Math.pow(o,.2),this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-2?(this.dy<.25?this.y=e-1:this.y=e-2,this.dy*=-1.2*Math.random()*i.ELASTICITY,Math.random()<.5?this.dx-=this.dy:this.dx+=this.dy):this.y<0&&(this.y=0,this.dy*=-1*i.ELASTICITY),this.y===e-1&&(this.active=!1)}),n=-20.01,r=[255,255,255,255];s.frame=function(){s.background(0);for(let o=0;o<15;++o){let h=m.range(-.098,.098),c=m.range(n,.8*n);i.createParticle(m.range(10,30.01)*-c,t/2,e-20,Math.sin(h)*c,Math.cos(h)*c,...r)}i.render()},s.loop()},graviton:function(t=3.4,e=20){let i=s.width,n=s.height,r=i/2,o=n/2,h=25,c=+e,d=6,f=2,l=+t,a=new N(s,function(p){let x=0,g=0,u=p.list,y=u;for(;y.active;){if(y===this){if(y=y.next,y===u)break;continue}let P=m.distance(this.x,this.y,y.x,y.y),E=m.direction(this.x,this.y,y.x,y.y),v=l*3/(P/3)**f,O=v*Math.cos(E),M=v*Math.sin(E);if(P<1){let q=m.direction(this.x,this.y,y.x,y.y),D=Math.cos(q),X=Math.sin(q),S=Math.hypot(this.dx,this.dy),I=Math.hypot(y.dx,y.dy);this.dx=I*D,this.dy=I*X,y.dx=S*D,y.dy=S*X;break}else P<3?(x+=-O*2,g+=-M*2):(x+=O,g+=M);if(y=y.next,y===u)break}this.ddx=x,this.ddy=g;let b=m.direction(this.x,this.y,r,o),A=m.distance(this.x,this.y,r,o),C=l*7/(A/5)**f,T=C*Math.cos(b),L=C*Math.sin(b);A<h?(this.ddx+=-L*2,this.ddy+=-T*2):(this.ddx+=T,this.ddy+=L),this.dx+=this.ddx,this.dy+=this.ddy;let k=Math.hypot(this.dx,this.dy);k>d&&(this.dx=this.dx/k*d,this.dy=this.dy/k*d),this.x+=this.dx,this.y+=this.dy,this.x>=i-1?(this.x=i-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=n-1?(this.y=n-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1),this.x===0&&this.y===0&&(this.x=m.roll(i),this.y=m.roll(n))},function(p){p.stroke(this.r,this.g,this.b,this.a),p.ellipse(this.x,this.y,3,3)});for(let p=0;p<c;++p){let x=d,g=1.25+m.range(-.088,.088);a.createParticle(0,m.roll(r-100),m.roll(o),x*Math.cos(g),x*Math.sin(g),255,255,196)}s.stroke(0,0,0,255),s.frame=function(){s.background(0),a.render(),s.fill(255,255,200),s.stroke(255,255,0),s.ellipse(r,o,h,h)},s.loop()},lens:function(t=150,e=30){t=+t,e=+e;let i=s.width,n=s.createImage(),r=n.height;for(let u=0;u<n.length;++u)n[u]=Vt(r,r/32,255,u);n.update();let o=s.createImage(t,t),h=new Array(t*t).fill(0),c=Math.round(t/2),d=c*c,f=c*(t+1),l;for(let u=0;u<d;++u){let y=u%c,b=Math.floor(u/c),A=y*y,C=b*b,T=0,L=0;if(A+C<d){let k=e/Math.sqrt(e*e-(A+C-d));T=Math.floor(y*k)-y,L=Math.floor(b*k)-b}l=L*i+T,h[f-b*t-y]=-l,h[f+b*t+y]=l,l=-L*i+T,h[f-b*t+y]=l,h[f+b*t-y]=-l}let a=i/2,p=i/2,x=1,g=2;s.frame=function(){a+=x,p+=g,a<0&&(a=0,x=-x),a>i-t&&(a=i-t,x=-x),p<0&&(p=0,g=-g),p>i-t&&(p=i-t,g=-g),s.background(n);let u=p*i+a;for(let y=0;y<t*t;++y)o[y]=n[Math.round(u)+Math.floor(y/t)*i+y%t+h[y]];o.blit(a,p)},s.loop()},life:function(t=300,e=300){s.init({background:0,frameRate:12,height:+e,width:+t});let i=s.width,n=s.height,r=.05,o=0,h=1,c=1,d=0,f=-1,l=Array.from(Array(i*n)).map(()=>Array.from(Array(2)));l.forEach(p=>{p[o]=d,p[h]=Math.random()<r?c:d});function a(p){let x=p%i,g=Math.floor(p/i),u=0;return g>0&&(x>0&&(u+=l[p-i-1][o]),x<i-1&&(u+=l[p-i+1][o]),u+=l[p-i][o]),g<n-1&&(x>0&&(u+=l[p+i-1][o]),x<i-1&&(u+=l[p+i+1][o]),u+=l[p+i][o]),x>0&&(u+=l[p-1][o]),x<i-1&&(u+=l[p+1][o]),u}s.stroke(255),s.frame=function(){s.background(0),l.forEach((p,x)=>{let g=l[x];if(p[h]===c||p[o]===c){g[o]=c;let A=x%i,C=x/i;s.point(A,C)}p[h]===f&&(g[o]=d),g[h]=d;let u=x-3*i;if(u<0)return;let y=l[u],b=a(u);b===3&&y[o]===d&&(y[h]=c),(b<2||b>3)&&y[o]===c&&(y[h]=f)})},s.loop()},pattern:function(t){let e=s.createImage(),i=e.height;for(let f=0;f<e.length;++f)e[f]=Vt(i,i/8,255,f);if(e.update(),s.background(e),t===void 0)return;s.init({showFrameRate:!0,showRuler:!0});let n=s.PVector.bind(s),r=20,o=360,h=s.width/2,c=s.height/2,d=Math.hypot(100,100);s.frame=()=>{s.background(0);let f=Math.PI/o*s.frameCount,l=Math.cos(f),a=Math.sin(f),p=Math.PI/r*s.frameCount,x=Math.cos(p),g=Math.sin(p),u=-g,y=x,b=new n(h,c),A=new n(l,a);A.setMag(d),A.add(b);let C=new n(l,a),T=new n(l,a);C.setMag(d*.33),T.setMag(d*.66);let L=new n(u,y);L.setMag(C.mag()*.5),L.add(C),L.add(b);let k=new n(x,g);k.setMag(T.mag()*.5),k.add(T),k.add(b);let P=new n(A.x,A.y);P.sub(b);let E=new n(L.x,L.y);E.sub(b);let v=(P.x*E.y-P.y*E.x)/P.mag()*1.5,O=new n(b.x,b.y);O.sub(A);let M=new n(-O.y,O.x);switch(M.setMag(v),M.add(A),s.fill(0,0,0,0),t){case"circles":case"full":if(s.stroke(255,0,0,255),s.line(b.x,b.y,A.x,A.y),s.ellipse(b.x+C.x,b.y+C.y,C.mag(),C.mag()),s.ellipse(b.x+T.x,b.y+T.y,T.mag(),T.mag()),s.stroke(0,255,0,255),s.line(b.x+C.x,b.y+C.y,L.x,L.y),s.line(b.x+T.x,b.y+T.y,k.x,k.y),s.line(A.x,A.y,M.x,M.y),s.ellipse(L.x,L.y,3,3),s.ellipse(k.x,k.y,3,3),s.ellipse(M.x,M.y,3,3),t==="circles")break;case"tail":s.stroke(255,255,255,255),s.bezier(b.x,b.y,L.x,L.y,k.x,k.y,M.x,M.y)}},s.loop()},plasma:function(){s.init({background:0,height:300,width:300});let t=s.width,e=s.height,i=s.createImage(),n={},r={};function o(g){let u=1-g/255,y=255*u,b=255*u*u;return[255*u*u*u*u,b,y,255]}for(let g=0;g<256;++g)r[g]=o(g);for(let g=0;g<512;++g){let u=g*.703125*.0174532;n[g]=Math.sin(u)*1024}let h=0,c=0,d=0,f=0,l=0,a=0,p=0,x=0;s.frame=function(){p=d,x=f;for(let g=0;g<e;++g){l=h+5,a=c+3,p&=511,x&=511;for(let u=0;u<t;++u){l&=511,a&=511;let b=128+(n[l]+n[a]+n[p]+n[x]>>4);i[g*t+u]=r[b],l+=5,a+=3}p+=1,x+=3}h+=9,d+=8,i.update(),s.background(i)},s.loop()},rod:function(){let t=s.width,e=s.height,i=t/2,n=e/2,r=t/2+m.range(-100,100.01),o=t/2+m.range(-100,100.01),h=m.roll(-3.01,3),c=m.roll(-3.01,3),d,f,l=20,a=12,p=5,x=200,g=3,u=5e-4,y=100,b=40,A=.75,C=.5,T=3,L=.66,k=new N(s,function(E){let v={x:0,y:0},O={x:0,y:0},M={x:0,y:0},q={x:0,y:0},D=0,X=0,S=E.list,I=S;for(;I.active;){if(I===this){if(I=I.next,I===S)break;continue}let H=Math.hypot(this.x-I.x,this.y-I.y);if(H<y&&(v.x+=I.dx,v.y+=I.dy,O.x+=I.x,O.y+=I.y,D++),H<b){let K=(b-H)/b;M.x+=(this.x-I.x)*K,M.y+=(this.y-I.y)*K,X++}if(I=I.next,I===S)break}if(d+=this.x,f+=this.y,D>0){v.x/=D,v.y/=D;let H=Math.hypot(v.x,v.y);H>0&&(v.x=v.x/H*u*A,v.y=v.y/H*u*A),O.x=(O.x/D-this.x)*u*C,O.y=(O.y/D-this.y)*u*C}if(X>0){M.x/=X,M.y/=X;let H=Math.hypot(M.x,M.y);H>0&&(M.x=M.x/H*u*T,M.y=M.y/H*u*T)}if(Math.random()>L){let H=Math.atan2(this.dy,this.dx)+m.range(-.1,.1),K=Math.hypot(this.dx,this.dy);q.x=K*Math.cos(H)-this.dx,q.y=K*Math.sin(H)-this.dy}this.ddx=v.x+O.x+M.x+q.x+(r-this.x)*1e-4,this.ddy=v.y+O.y+M.y+q.y+(o-this.y)*1e-4,m.distance(this.x,this.y,r,o)<50&&(this.ddx+=(r-this.x)*.01,this.ddy+=(o-this.y)*.01),this.dx+=this.ddx,this.dy+=this.ddy;let ot=Math.hypot(this.dx,this.dy);ot>g&&(this.dx=this.dx/ot*g,this.dy=this.dy/ot*g),this.x+=this.dx,this.y+=this.dy;let Et=m.direction(this.x,this.y,this.x-this.dx,this.y-this.dy),rt=Math.cos(Et),at=Math.sin(Et),At=.33*a,Ct=.66*a,ht=At*rt,ct=At*at,lt=Ct*rt,dt=Ct*at,Ot=this.x+a*rt,Lt=this.y+a*at;this.unique??=m.roll(Math.PI/2);let Tt=Math.PI/p*s.frameCount+this.unique,et=Math.cos(Tt),J=Math.sin(Tt),ee=this.x+ht+.5*(ht*-J-ct*et),ie=this.y+ct+.5*(ht*et+ct*-J),ne=this.x+lt+.5*(lt*et-dt*J),se=this.y+dt+.5*(lt*J+dt*et),kt=this.x-Ot,Pt=this.y-Lt,Rt=Math.hypot(kt,Pt),oe=-Pt/Rt,re=kt/Rt,It=J*3,ae=Ot+oe*It,he=Lt+re*It;s.bezier(this.x,this.y,ee,ie,ne,se,ae,he),this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-1?(this.y=e-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1)},function(E){E.stroke(this.r,this.g,this.b,this.a),E.ellipse(this.x,this.y,2,2)}),P=m.range(0,2*Math.PI);for(let E=0;E<x;++E){let v=m.range(.001,1)*g,O=m.range(-.1,.1);k.createParticle(0,m.range(i-10.01,i+10),m.range(n-10.01,n+10),v*Math.cos(O+P),v*Math.sin(O+P),255,255,255,255)}s.frame=function(){d=0,f=0,s.background(0),s.fill(0,0,0,0),s.stroke(255,255,255,255),k.render(),d/=k.count,f/=k.count,h+=-(d-r)*1e-4+(i-r)*1e-4,c+=-(f-o)*1e-4+(n-o)*1e-4;let E=Math.hypot(h,c);E>g*1.4&&(h=h/E*g*1.4,c=c/E*g*1.4),r+=h,o+=c,r<0&&(r=0,h=-h),r>t-l&&(r=t-l,h=-h),o<0&&(o=0,c=-c),o>e-l&&(o=e-l,c=-c),s.stroke(196,128,196),s.fill(255,128,164,128),s.ellipse(r,o,l,l)},s.loop()},snow:function(){let t=s.width,e=s.height,i=new N(s,function(){this.x+=this.dx,this.y+=this.dy,(this.x>=t-1||this.y>=e-1||this.y<0)&&(this.active=!1)});s.frame=function(){s.background(0),i.createParticle(0,m.range(-t/2,t-1),0,m.range(0,.25),m.range(.4,.6),255,255,255,m.range(96,255)),i.render()},s.loop()},spiro:function(t=!0,e=!1,i=!0){let n=s.width,r=s.height,o=s.PVector.bind(s),h=new o(n/2,r/2),c=new o(0,0),d=new o(0,0),f=i==="false"?360:36,l=n/2,a=100,p=m.roll(a),x=m.roll(l),g=Math.random(),u=Math.random(),y=(a+p)/p,b=(l-x)/x;s.frame=function(){let A=Math.PI/f*s.frameCount,C=Math.cos(A),T=Math.sin(A),L=Math.PI/f*s.frameCount*y,k=-Math.PI/f*s.frameCount*b,P=new o(C,T);P.setMag(l-x),P.add(h);let E=new o(C,T);E.setMag(a+p),E.add(h);let v=new o(Math.cos(L),Math.sin(L));v.setMag(p*g),v.add(E);let O=new o(Math.cos(k),Math.sin(k));O.setMag(x*u),O.add(P),i==="false"?(s.background(0),s.fill(0,0,0,0),s.stroke(0,255,0,255),s.ellipse(h.x,h.y,l*2,l*2),s.ellipse(h.x,h.y,a*2,a*2),t&&t!=="false"&&(s.stroke(255,255,255,255),s.line(h.x,h.y,P.x,P.y),s.line(P.x,P.y,O.x,O.y),s.stroke(255,0,0,255),s.ellipse(P.x,P.y,x*2,x*2),s.ellipse(O.x,O.y,2,2)),e&&e!=="false"&&(s.stroke(255,255,255,255),s.line(h.x,h.y,E.x,E.y),s.line(E.x,E.y,v.x,v.y),s.stroke(255,0,0,255),s.ellipse(E.x,E.y,p*2,p*2),s.ellipse(v.x,v.y,2,2))):(s.stroke(255,255,255,255),t&&t!=="false"&&(d.mag()===0&&d.set(O),s.line(d.x,d.y,O.x,O.y),d.set(O)),s.stroke(128,255,128,255),e&&e!=="false"&&(c.mag()===0&&c.set(v),s.line(c.x,c.y,v.x,v.y),c.set(v)))},s.loop()},stars:function(){let t=s.width,e=s.height,i=t/2,n=e/2,r=i*.75,o=new N(s,function(){let h=this.x-3*this.dx,c=this.y-3*this.dy;this.x+=this.dx,this.y+=this.dy,s.line(this.x,this.y,h,c),(this.x>=t-1||this.y>=e-1||this.x<0||this.y<0)&&(this.active=!1);let d=Math.hypot(this.dx,this.dy),f=Math.min(m.distance(this.x,this.y,i,n),i);this.a=128*Math.max(1-f/r,0)+64*(d/10)+64*Math.max(1-this.t++,0)});s.frame=function(){s.background(0);for(let h=0;h<20;++h){let c=(m.roll(t)+m.roll(t))/2,d=m.roll(e)+m.roll(e)/2,f=Math.min(m.distance(c,d,i,n),i),l=-Math.atan2(n-d,c-i),a=10*(f/i)+1;o.createParticle(0,c,d,Math.cos(l)*a,Math.sin(l)*a,255,255,255,0)}o.render()},s.loop()}};zt.exports=Ee});var te=j((Fe,Zt)=>{var nt=Qt(),st=it().Renderer(),bt=Object.freeze({cat:{func:function(t){this.echo(nt[t].toString())},man:"Print code listing for [demo]"},clear:{func:function(){this.clear()}},help:{func:function(t){t===void 0?(this.echo("Available commands:"),Object.keys(bt).forEach(e=>this.echo(e))):this.echo(bt[t].man)},man:"Print help text for [command].  If no command is passed, list available commands.",usage:"help [command]"},init:{func:function(){st.init()}},load:{func:function(t,...e){t in nt&&(this.echo(`Loading ${t}\u2026`),st.init(),nt[t].apply(this,e))},man:"Load a demo.  Some demos accept additional arguments.\n<b>Example:</b>\n`load chaos 6`.",usage:"load [demo] [args]"},ls:{func:function(){this.echo("Available demos:"),Object.keys(nt).filter(t=>t!=="rod").forEach(t=>this.echo(t))},man:"List available demos"},properties:{func:function(t){t===void 0&&this.echo(JSON.stringify(st,null,2)),this.echo(st[t])}}});Zt.exports=bt});var vt=(G(),V(B)).default,{Executor:Ae}=yt();_t();var{Renderer:Ce}=it();vt.setLogLevel("error");var Mt=new vt("index.js");window.addEventListener("load",()=>{Mt.info("Creating renderer");let t=document.querySelector("canvas"),e=t.getBoundingClientRect();t.width=e.width,t.height=e.height,Mt.debug(`initial canvas width (${t.width}) height (${t.height})`),Ce(t),Mt.info("Creating executor");let i=document.querySelector("ng-terminal"),n=new vt("Executor.js");i.executor=Ae.bind(i)(n,te())});})();
