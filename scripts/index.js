(()=>{var ut=Object.defineProperty;var ce=Object.getOwnPropertyDescriptor;var le=Object.getOwnPropertyNames;var de=Object.prototype.hasOwnProperty;var ue=(t,e)=>()=>(t&&(e=t(t=0)),e);var j=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),fe=(t,e)=>{for(var i in e)ut(t,i,{get:e[i],enumerable:!0})},pe=(t,e,i,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of le(e))!de.call(t,r)&&r!==i&&ut(t,r,{get:()=>e[r],enumerable:!(n=ce(e,r))||n.enumerable});return t};var V=t=>pe(ut({},"__esModule",{value:!0}),t);var B={};fe(B,{APITransport:()=>Nt,ConsoleTransport:()=>ft,FileTransport:()=>St,default:()=>F,interpolate:()=>Ht});function F(t){if(t===void 0)throw new Error("Logger requires the file name of where it's being used.");if(!new.target)return new F(...arguments);Object.defineProperties(this,{log:{value:function(e,i,n){z.indexOf(e)<=z.indexOf(F.state.currentLevel)&&Object.values(F.state.transports).forEach(r=>{queueMicrotask(()=>r.log({level:e,msg:i,category:t,...n}))})}}}),z.forEach(e=>{let i;e==="noop"?i=()=>{}:i=this.log.bind(this,e),Object.defineProperty(this,e,{value:i})})}function ft(t){if(!new.target)return new ft(...arguments);Object.defineProperty(this,"log",{value:function(e){let i=Object.assign({},t,e);if(i.isTable)console.table(i.msg,i.args);else if(i.group)console[i.group](i.msg);else{let[n,r]=i.style?.length===2?i.style:["font-weight: bold; color: green;","font-style: italic;"];console[i.level](`%c${i.timestamp||new Date().toLocaleTimeString("en-US",i.dateFmt)}%c %c[${i.category}]%c ${i.msg}`,n,"",r,"",...i.args||[])}}})}function St(t){if(window.showSaveFilePicker===void 0){let e="FileTransport requires the File System Access API";throw console.warn(e),new Error(e)}if(!new.target)return new St(...arguments);Object.defineProperty(this,"initialize",{value:async function(){try{let e=await window.showSaveFilePicker({types:[{description:"Log Files",accept:{"text/plain":[".log"]}}]});Object.defineProperty(this,"log",{value:async function(i){let n=Object.assign({},t,i),r;try{r=await e.createWritable({keepExistingData:!0}),await r.write(`${n.timestamp||new Date().toLocaleTimeString("en-US",n.dateFmt)} [${n.category}] ${n.level}: ${n.msg}
`)}catch(o){console.error(o)}finally{await r.close()}}})}catch(e){console.error(e)}}})}function Nt(t){if(!new.target)return new Nt(...arguments);Object.defineProperty(this,"log",{value:async function(e){let i=Ht(t,e);try{let n=await fetch(i.url,{method:i.method,headers:Object.entries(i.headers||{}).reduce((r,[o,a])=>(r[o]=a,r),{}),body:i.body});console.debug(n)}catch(n){console.error(n)}}})}var z,Ht,G=ue(()=>{z=["noop","error","warn","info","debug","silly"];Object.defineProperties(F,{addTransport:{value:(t,e)=>{F.state.transports[t]=e}},state:{value:{currentLevel:"noop",transports:{}}},level:{get:()=>F.state.currentLevel},removeTransport:{value:t=>{delete F.state.transports[t]}},setLogLevel:{value:t=>{if(z.some(e=>e===t))F.state.currentLevel=t;else throw new Error(`${t} is not a valid logger level`)}}});F.addTransport("default",ft({}));z.reduce((t,e)=>(Object.defineProperty(t,e.toUpperCase(),{enumerable:!0,get:()=>e}),t),F);Ht=function t(e,i){if(e instanceof Object){let n=Array.isArray(e)?[]:{};for(let r in e){let o=t(e[r],i);try{n[r]=JSON.parse(o)}catch{o!==void 0&&o!==""&&(n[r]=o)}}return n}return typeof e!="string"?e:e.replace(/\{\{(.+?)}}/g,(n,r)=>{let o=i[r]||"";return o instanceof Object?JSON.stringify(o):o})}});var qt=j((Te,Ft)=>{var pt;typeof window>"u"?pt=(G(),V(B)):pt=(G(),V(B)).default;var ye=new pt("getopt.js"),$t=function(t){ye.warn(t)};function w(t,e){typeof w.place>"u"&&(w.place="",w.iplace=0);let i;if(w.optreset>0||w.iplace===w.place.length){if(w.optreset=0,w.place=t[w.optind],w.iplace=0,w.optind>=t.length||w.place.charAt(w.iplace++)!=="-")return w.place="",w.iplace=0,"";if(w.optopt=w.place.charAt(w.iplace++),w.optopt==="-"&&w.iplace===w.place.length)return++w.optind,w.getopt.place="",w.getopt.iplace=0,"";if(w.optopt===0){if(w.place="",w.iplace=0,e.indexOf("-")===-1)return"";w.optopt="-"}}else w.optopt=w.place.charAt(w.iplace++);if(w.optopt===":"||(i=e.indexOf(w.optopt))===-1)return w.iplace===w.place.length&&++w.optind,w.opterr&&e.charAt(0)!==":"&&$t("illegal option -- "+w.optopt),"?";if(e.charAt(i+1)!==":")w.optarg=null,w.iplace===w.place.length&&++w.optind;else{if(w.iplace<w.place.length)w.optarg=w.place.substr(w.iplace);else if(t.length>++w.optind)w.optarg=t[w.optind];else return w.place="",w.iplace=0,e.charAt(0)===":"?":":w.opterr?($t("option requires an argument -- "+w.optopt),":"):"?";w.place="",w.iplace=0,++w.optind}return w.optopt}w.opterr=1;w.optind=0;w.optopt="";w.optreset=0;w.optarg="";Ft.exports=w});var yt=j((ke,Dt)=>{var _=qt();function $(t,e,i){if(typeof e=="function")return function(){return e.apply(this,arguments)||$.OK};let n=this;n.echo===void 0&&(n.echo=t.info);let r=[],o=/"([^"]*)"|'([^']*)'|\S+/g,a=async function(c){t.info(`Executing: ${c}`);let d=c.match(o).map(f=>f.replace(/^['"]|['"]$/g,"")),h=d.shift(),l=e[h];if(l===void 0){if(r.includes(h))try{let f=JSON.stringify(await i(c));return t.debug(`RPC Response: ${f}`),n.echo(f),$.OK}catch(f){return n.echo(f),$.ECMDERR}return n.echo(`${h}: no such command`),$.ENOTFOUND}let{func:u,opts:p,usage:m}=l,y=p;if(m&&(y=y?`${y}h`:"h"),y!==void 0){t.debug(`Parsing options: ${y} with ${d}`);let f={},g;for(_.optreset=1,_.optind=0;(g=_(d,y))!=="";)switch(t.debug(`Opt: ${g}, optarg: ${_.optarg}, optind: ${_.optind}`),g){case"h":return n.echo(`Usage: ${m}`),$.OK;case":":return n.echo(`${_.optopt}: option needs a value`),$.EBADARGS;case"?":return n.echo(`${_.optopt}: no such option`),$.EBADARGS;default:t.debug(`Switch: ${g}, optarg: ${_.optarg}`),f[g]=_.optarg||!0}u.opts=f,t.debug(`Switches: ${JSON.stringify(f)}`)}else _.optind=0;return t.debug(`Terms: ${d}`),await u.apply(this,d.slice(_.optind))??$.OK};return i!==void 0&&queueMicrotask(async function(){let c=await i("system.describe");t.debug(`system.describe result: ${c}`),JSON.parse(c).procs.forEach(d=>r.push(d)),e.help.rpcList=r,t.debug(`RPC List: ${r}`),Object.defineProperties(a,{login:{value:async function(d,h){t.info(`Attempting to log in user ${d}`);try{let l=await i(`login ${d} ${h}`);if(l===!1)return n.echo("Login failed"),$.NOTOKEN;let u=i;return a.exit??Object.defineProperty(a,"exit",{value:async function(){t.info("Logging out"),i=u,n.authState=$.NOTOKEN,n.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!0}}))}}),i=new Proxy(i,{apply:function(p,m,y){return p(y[0],l)}}),$.OK}catch(l){return t.error(l),l}}}})}),a}var Q=0;Object.defineProperties($,{OK:{value:Q++},ENOTFOUND:{value:Q++},ECMDERR:{value:Q++},EBADARGS:{value:Q++},NOTOKEN:{value:Q++}});function ge(t,e){let i=0;return function(n,r){try{t.info(`Executing RPC: ${n}`);let o=n.trim().split(/\s+/),a=o.shift(),c=o;r&&(c={token:r,params:c}),t.debug(`Method: ${a}, params: ${c}`);try{return e.jsonrpc({id:i++,method:a,params:c}).then(d=>{let h=JSON.parse(d);if(t.debug(`Response: ${JSON.stringify(h)}`),h.error)throw new Error(h.error.message);return h.result})}catch(d){return t.error(d),d}}catch(o){return t.error(o),o}}}Dt.exports={JSONRPCClient:ge,Executor:$}});var _t=j(()=>{var{Executor:Y}=yt(),gt=(G(),V(B)).default,R=new gt("Terminal.js"),xe=100,me=1e3,xt=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.parentTerminal=null,this.commandHistory=[],this.historyIndex=-1;let e=localStorage.getItem("commandHistory");e&&(this.commandHistory=JSON.parse(e),R.debug(`Loading command history (${this.commandHistory.length} items)`),this.historyIndex=this.commandHistory.length),this.inputHandler=this.inputHandler.bind(this),this.reset=this.reset.bind(this),this.addEventListener("terminal-reset",this.reset);let i=function(){R.debug("DOMContentLoaded event fired"),this.reset(new CustomEvent("terminal-reset",{detail:{clear:!0}})),document.removeEventListener("DOMContentLoaded",i)}.bind(this);document.addEventListener("DOMContentLoaded",i)}connectedCallback(){R.debug("Terminal connected")}disconnectedCallback(){R.debug("Terminal disconnected"),this.inputLine.removeEventListener("keydown",this.inputHandler),this.removeEventListener("click",this.focusHandler)}reset(e){if(R.debug(`Terminal reset (${this.parentTerminal?"sub-terminal":"main terminal"})`),R.debug(`Auth state: ${this.authState}, RPC enabled: ${this.rpcEnabled}`),this.rpcEnabled&&this.authState!==Y.OK)R.debug("logging in"),this.loginModal();else{let i=e.detail?.clear??!1;R.debug(`reset ${i?"and clear ":""}terminal`),this.uiModal(i)}this.focusHandler=function(){this.inputLine.focus()}.bind(this),this.addEventListener("click",this.focusHandler),this.focusHandler()}applyStyles(){let e=this.querySelector("style").cloneNode(!0);this.shadowRoot.appendChild(e)}loginModal(){this.shadowRoot.innerHTML="",this.applyStyles();let e=this.querySelector("template#login").content.cloneNode(!0);this.shadowRoot.appendChild(e),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.output=this.shadowRoot.querySelector(".output"),this.echo("Please log in");let i,n,r=async o=>{if(o.key==="Enter"){o.preventDefault();let a=(this.inputLine.value??this.inputLine.textContent).trim();if(i===void 0?i=a:n=a,i&&n)try{if(this.authState=await this.executor.login(i,n),R.debug(`Login state: ${this.authState}`),this.authState===Y.NOTOKEN){this.loginModal(),this.focusHandler();return}this.inputLine.removeEventListener("keydown",r),this.removeEventListener("click",this.focusHandler),this.reset(new CustomEvent("terminal-reset",{detail:{clear:!0}}))}catch(c){this.echo(c),R.error(c)}else{R.debug(`awaiting password for ${i}`);let c=document.createElement("input");c.type="password",c.classList.add("input-line"),this.inputLine.textContent=this.inputLine.value="",this.inputLine.removeEventListener("keydown",r),this.removeEventListener("click",this.focusHandler),this.inputLine.replaceWith(c),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.prompt="password:",this.inputLine.addEventListener("keydown",r),this.addEventListener("click",this.focusHandler),this.focusHandler()}}};this.inputLine.addEventListener("keydown",r)}uiModal(e){let i=this.shadowRoot.querySelector(".output")?.innerHTML;this.shadowRoot.innerHTML="",this.applyStyles();let n=this.querySelector("template#ui").content.cloneNode(!0);this.shadowRoot.appendChild(n),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.output=this.shadowRoot.querySelector(".output"),e&&this.greeting?(R.debug("clearing terminal"),this.echo(this.greeting)):this.output.innerHTML=i??"",this.inputLine.addEventListener("keydown",this.inputHandler),this.inputLine.focus()}get executor(){return this._executor}set executor(e){R.info("Setting executor"),this._executor=e}get greeting(){return this.getAttribute("greeting")}set greeting(e){e===void 0?this.removeAttribute("greeting"):this.setAttribute("greeting",e)}get prompt(){return this.shadowRoot.querySelector(".prompt").textContent}set prompt(e){let i=this.shadowRoot.querySelector(".prompt");i.innerHTML=`${e}&nbsp;`}get rpcEnabled(){return this.getAttribute("rpc")==="true"}inputHandler(e){switch(e.key){case"Enter":{e.preventDefault();let i=this.inputLine.textContent.trim();this.inputLine.textContent="",this.echo(`${this.prompt}${i}`),this.processCommand(i),this.historyIndex=this.commandHistory.length;break}case"ArrowUp":R.debug(`History index (back): ${this.historyIndex}`),this.historyIndex>0&&(this.historyIndex-=1,this.inputLine.textContent=this.commandHistory[this.historyIndex]);break;case"ArrowDown":R.debug(`History index (forward): ${this.historyIndex}`),this.historyIndex<this.commandHistory.length-1?(this.historyIndex+=1,this.inputLine.textContent=this.commandHistory[this.historyIndex]):(this.historyIndex=this.commandHistory.length,this.inputLine.textContent="");break}}async processCommand(e){try{let i=await this.executor(e);switch(R.debug(`Status: ${i}`),i){case Y.OK:R.debug(`${e} executed successfully`),e!==this.commandHistory[this.commandHistory.length-1]&&(this.commandHistory.push(e),this.commandHistory.length>xe&&this.commandHistory.shift(),localStorage.setItem("commandHistory",JSON.stringify(this.commandHistory)));break;case Y.ENOTFOUND:R.info(`${e} not found`);break;case Y.ECMDERR:R.error(`Error executing ${e}`);break;case Y.EBADARGS:R.warn(`${e} called with bad arguments`);break;default:R.error(`Unknown status: ${i} for ${e}`);break}}catch(i){R.error(i),this.echo(i)}}clear(){this.output.innerHTML=""}echo(e){for(e!=null&&e!==""&&(this.output.innerHTML+=`<div>${e}</div>`);this.output.children.length>me;)this.output.removeChild(this.output.firstChild);this.inputLine.getBoundingClientRect().bottom>window.innerHeight&&this.inputLine.scrollIntoView({behavior:"smooth"})}log(e){gt.level==="debug"&&(typeof e=="string"?console.info(e):console.dir(e))}startSubTerminal(e){R.info(`Starting sub-terminal: ${e.name}`),this.removeEventListener("terminal-reset",this.reset);let i=new gt(`Executor.js (${e.name})`),n=document.createElement("ng-terminal");return n.innerHTML=this.innerHTML,n.greeting=e.greeting,n.executor=Y.bind(n)(i,e.registry),n.parentTerminal=this,this.replaceWith(n),n.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!0}})),e.prompt!==void 0&&(n.prompt=e.prompt),n}exitSubTerminal(){this.parentTerminal?(R.info("Exiting sub-terminal"),R.debug(`Parent terminal: ${JSON.stringify(this.parentTerminal)}`),this.parentTerminal.addEventListener("terminal-reset",this.parentTerminal.reset),this.replaceWith(this.parentTerminal),this.parentTerminal.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!1}}))):R.warn("No parent terminal found")}};customElements.define("ng-terminal",xt)});var nt=j((Ie,Xt)=>{var we=(G(),V(B)).default,U=new we("Renderer.js");function mt(t,e){if(!new.target)return new mt(...arguments);let i=t.pixels.toArray(),n=i.length,r=new Proxy(t,{get:function(o,a,c){if(typeof a=="string"&&!isNaN(a)){let d=+a;if(Number.isInteger(d)&&d>=0&&d<n)return i[d]}else return Reflect.get(o,a,c)},set:function(o,a,c,d){if(typeof a=="string"&&!isNaN(a)){let h=Math.round(+a);Number.isInteger(h)&&h>=0&&h<n?i[h]=Array.isArray(c)?e.color(...c):c:U.noop(`index ${h} out of range, ${n}`)}else return Reflect.set(o,a,c,d)}});return t.loaded=!0,Object.defineProperties(r,{blit:{value:function(o,a){t.pixels.set(i),e.image(t,o,a)}},length:{value:i.length},update:{value:function(){t.pixels.set(i)}}}),r}function wt(t){if(!new.target)return new wt(...arguments);let e=0,i=[];Object.defineProperties(i,{flip:{value:function(){e^=1}},read:{get:function(){return this[e^1]}},write:{get:function(){return this[e]}}});let n=t.createImage();i.push({buffer:n,get pixels(){return n.pixels.toArray()}});let r=t.createImage();i.push({buffer:r,get pixels(){return r.pixels.toArray()}}),Object.defineProperties(this,{flip:{value:function(){let o=i.write.buffer;o.update(),t.background(o),i.flip()}},readBuffer:{get:function(){return i.read.pixels}},writeBuffer:{get:function(){return i.write.buffer}}})}function Z(t){if(Z.instance!==void 0)return Z.instance;if(!new.target)return new Z(...arguments);let e=new Proxy(this,{get:function(h,l){return h[l]??n[l]}});Object.defineProperty(Z,"instance",{value:e});let i={background:4278849802,frameRate:60,height:t.height,showFrameRate:!1,showRuler:!1,width:t.width},n,r=!1,o=!1,a=50,c=5,d=[];return Object.defineProperties(this,{createImage:{value:function(h,l){let u=n.createImage(h??t.width,l??t.height);return new mt(u,n)}},frame:{set:function(h){let l=n.width/2,u=n.height/2,p=new Proxy(h,{apply:function(m,y,f){if(m.apply(y,f),r&&(n.fill(255),n.textSize(12),n.text(n.__frameRate,n.width-50,n.height-10)),o){n.stroke(255),n.line(0,u,n.width,u),n.line(l,0,l,n.height);for(let g=a;g<n.width;g+=a)n.point(l+g,u-1),n.point(l-g,u-1),n.point(l+g,u+1),n.point(l-g,u+1);for(let g=a;g<n.height;g+=a)n.point(l-1,u+g),n.point(l-1,u-g),n.point(l+1,u+g),n.point(l+1,u-g)}}});Object.defineProperty(n,"draw",{value:p,writable:!0}),U.debug("pjs.draw set")}},doubleBuffer:{value:function(){return new wt(this)}},echo:{value:function(h){d.push(h),d.length>c&&d.shift()}},init:{value:function(h){if(n!==void 0){n.exit(),n=void 0;let u=document.createElement("canvas");t.replaceWith(u),t=u}let l=Object.assign({},i,h);n=new Processing(t,u=>{U.info("Processing.js created"),U.debug(`canvas width (${t.width}) height (${t.height})`),Object.defineProperties(u,{keyPressed:{value:function(){switch(u.keyCode){case u.UP:u.loop();break;case u.DOWN:u.noLoop();break;case u.LEFT:u.save("image.png");break;case u.RIGHT:u.redraw()}},writable:!0},setup:{value:function(){u.size(l.width,l.height,u[l.renderer]),U.debug(`processingjs width (${u.width}) height (${u.height}) ${u.use3DContext}`),u.frameRate(l.frameRate),u.noLoop(),u.background(l.background),r=l.showFrameRate,o=l.showRuler,U.info("Processing.js setup")},writable:!0}})})}},input:{set:function(h){U.debug("keyPressed set"),Object.defineProperty(n,"keyPressed",{value:h,writable:!0})}},pixelHeight:{get:function(){return 0}},pixelWidth:{get:function(){return 0}}}),this.init(),e}Xt.exports={DoubleBuffer:wt,Image:mt,Renderer:Z}});var Yt=j((Se,jt)=>{function W(){if(W.instance instanceof W)return W.instance;if(!new.target)return new W(...arguments);Object.defineProperty(W,"instance",{value:this});let t=Math.PI/180;Object.defineProperties(this,{cos:{value:{},enumerable:!0},sin:{value:{},enumerable:!0}});for(let e=0;e<=360;++e)Object.defineProperty(this.cos,e,{value:Math.cos(e*t)}),Object.defineProperty(this.sin,e,{value:Math.sin(e*t)})}var tt=Object.freeze({addColors:(...t)=>t.length===0?[]:t[0].map((e,i)=>t.reduce((n,r)=>n+r[i],0)),decodeColor:t=>[t>>16&255,t>>8&255,t&255,t>>>24],direction:(t,e,i,n)=>Math.atan2(n-e,i-t),distance:(t,e,i,n)=>Math.hypot(Math.abs(i-t),Math.abs(n-e)),fastInvSqrt:t=>{let i=new Float32Array([t]),n=new Float32Array([t]),r=new Int32Array(i.buffer);return r[0]=1597463007-(r[0]>>1),n[0]=i[0],n[0]=n[0]*(1.5-t*.5*n[0]*n[0]),n[0]},fastTrig:W(),invSqrt:t=>1/Math.sqrt(t),randomColor:(t=!1)=>{let e=Array.from({length:3},()=>tt.roll(255));return e.push(t?tt.roll(255):255),e},randomGrayscale:(t=!1)=>{let e=tt.roll(255),i=Array.from({length:3},()=>e);return i.push(t?tt.roll(255):255),i},range:(t,e)=>{let i=Math.random()*(e-t);return Number.isInteger(t)&&Number.isInteger(e)&&(i=Math.floor(i)),i+t},roll:t=>Math.floor(Math.random()*t)});jt.exports=tt});var Gt=j((Ne,Bt)=>{function be(){this.x+=this.dx,this.y+=this.dy}function Me(t){t.stroke(this.r,this.g,this.b,this.a),t.point(this.x,this.y)}function Ut(t,e=be,i=Me){if(!new.target)return new Ut(...arguments);let n=2,r=new o;r.next=new o,r.prev=r.next,r.prev.next=r,r.prev.prev=r,r.active=!1,r.prev.active=!1,this.ACCELERATION=[0,.25],this.ELASTICITY=.2,this.MAX_COUNT=3e3,Object.defineProperties(this,{count:{get:function(){return n}},createParticle:{value:function(a,c,d,h,l,u,p,m,y){let f;if(r.prev.active){if(n>=this.MAX_COUNT)return;f=new o(a,c,d,h,l,u,p,m,y),f.next=r,f.prev=r.prev,f.prev.next=f,r.prev=f,r=f,++n}else f=r.prev,f.activate(a,c,d,h,l,u,p,m,y),r=f;return f}},list:{get:function(){return r}},render:{value:function(){let a=r;for(;a.active;){e.call(a,this),i.call(a,t);let c=a;if(a.ttl>0&&++a.t>=a.ttl&&(a.active=!1),a=a.next,a===r)break;c.active||(c===r?r=c.next:(c.next.prev=c.prev,c.prev.next=c.next,c.next=r,c.prev=r.prev,r.prev.next=c,r.prev=c))}}}});function o(a,c,d,h,l,u,p,m,y){if(!new.target)return new o(...arguments);Object.defineProperties(this,{activate:{value:function(f,g,b,A,C,T,L,k,P){this.active=!0,this.ttl=f,this.t=0,this.x=g,this.y=b,this.dx=A,this.dy=C,this.ddx=0,this.ddy=0,this.dddx=0,this.dddy=0,this.r=T,this.g=L,this.b=k,this.a=P}}}),this.activate(a,c,d,h,l,u,p,m,y)}}Bt.exports=Ut});var Kt=j((He,Jt)=>{function Wt(t=10){if(!new.target)return new Wt(...arguments);let e=new Map;Object.defineProperties(this,{add:{value:function(i,n,r){let o=`${Math.floor(i/t)},${Math.floor(n/t)}`;if(e.has(o)){let a=e.get(o);a.includes(r)||a.push(r)}else e.set(o,[r])}},get:{value:function(i,n){let r=`${Math.floor(i/t)},${Math.floor(n/t)}`,o=e.get(r)??[];return e.delete(r),o}},remove:{value:function(i,n,r){let o=`${Math.floor(i/t)},${Math.floor(n/t)}`,a=e.get(o);if(a!==void 0){let c=a.indexOf(r);c!==-1&&a.splice(c,1)}}}})}Jt.exports={Space:Wt}});var Qt=j(($e,zt)=>{var x=Yt(),N=Gt(),s=nt().Renderer(),{Space:ve}=Kt();function Vt(t,e,i,n){let r=n%t,o=Math.floor(n/t),a=i,c=Math.floor(r/e)%2==0,d=Math.floor(o/e)%2==0;return c!=d&&(a=0),[a,a,a,255]}var Ee={"3d":function(){s.init({renderer:"P3D"});let t=s.width,e=s.height,i=0,n=255,r=255,o=255;s.frame=function(){s.background(0),s.camera(t/2,e/5,200,t/2,e/2,0,0,1,0),s.pointLight(n,r/10,o/10,t/3,e/3,100),s.pointLight(n/10,r,o/10,300,t/3,100),s.pointLight(n/10,r/10,o,300,300,-100),s.pointLight(n,r,o,t/3,300,-100),s.translate(t/2,e/2),s.rotateY(i),s.normal(0,0,1),s.fill(128),s.rect(-100,-100,200,200),i+=.01},s.loop()},ants:function(){let t=s.width,e=s.height,i=200,n=1,r=s.createImage();r.update();let o=new N(s,function(a){let c=a.list,d=c;for(;d.active;){if(d===this){if(d=d.next,d===c)break;continue}if(d=d.next,d===c)break}this.last??=x.roll(60),this.last++>60&&(this.ddx=x.range(-.05,.05),this.ddy=x.range(-.05,.05),this.last=0),this.dx+=this.ddx,this.dy+=this.ddy;let h=Math.hypot(this.dx,this.dy);h>n&&(this.dx=this.dx/h*n,this.dy=this.dy/h*n);let l=this.x-3*this.dx,u=this.y-3*this.dy;this.x+=this.dx,this.y+=this.dy,s.line(this.x,this.y,l,u),this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-1?(this.y=e-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1)});for(let a=0;a<i;++a)o.createParticle(0,x.range(1e-4,t),x.range(1e-4,e),0,0,207,16,32);s.stroke(0,0,0,255),s.frame=function(){s.background(r),o.render()},s.loop()},balls:function(){s.init({showFrameRate:!0});let t=s.width,e=s.height,i=1e3,n=10,r=2,o=new ve(n*2),a=new N(s,function(){this.x+=this.dx,this.y+=this.dy,this.x<0&&(this.x=0,this.dx*=-1),this.x>t&&(this.x=t,this.dx*=-1),this.y<0&&(this.y=0,this.dy*=-1),this.y>e&&(this.y=e,this.dy*=-1);let c=o.get(this.x,this.y);for(let h=0;h<c.length;++h){let l=c[h];if(l===this)continue;let u=Math.hypot(this.x-l.x,this.y-l.y);if(u<n){let p=Math.atan2(this.y-l.y,this.x-l.x),m=(n-u)/n;this.dx+=Math.cos(p)*m,this.dy+=Math.sin(p)*m,l.dx-=Math.cos(p)*m,l.dy-=Math.sin(p)*m,this.x+=this.dx,this.y+=this.dy,l.x+=l.dx,l.y+=l.dy}}o.add(this.x,this.y,this);let d=Math.hypot(this.dx,this.dy);d>r&&(this.dx=this.dx/d*r,this.dy=this.dy/d*r)},function(c){c.fill(this.r,this.g,this.b,this.a),c.stroke(this.r,this.g,this.b,this.a),c.ellipse(this.x,this.y,n,n)});for(let c=0;c<i;++c){let d=a.createParticle(0,x.range(.01,t),x.range(.01,e),x.range(-1,1.01),x.range(-1,1.01),...x.randomColor());o.add(d.x,d.y,d)}s.frame=function(){s.background(0),a.render()},s.loop()},boids:function(){let t=s.width,e=s.height,i=t/2,n=e/2,r=200,o=3,a=5e-4,c=100,d=40,h=1,l=1.25,u=1,p=.75,m=new N(s,function(f){let g=0,b=0,A=0,C=0,T=0,L=0,k=0,P=0,E=0,v=0,O=f.list,M=O;for(;M.active;){if(M===this){if(M=M.next,M===O)break;continue}let S=Math.hypot(this.x-M.x,this.y-M.y);if(S<c&&(g+=M.dx,b+=M.dy,A+=M.x,C+=M.y,E++),S<d){let I=(d-S)/d;T+=(this.x-M.x)*I,L+=(this.y-M.y)*I,v++}if(M=M.next,M===O)break}if(E>0){g/=E,b/=E;let S=Math.hypot(g,b);S>0&&(g=g/S*a*h,b=b/S*a*h),A=(A/E-this.x)*a*l,C=(C/E-this.y)*a*l}if(v>0){T/=v,L/=v;let S=Math.hypot(T,L);S>0&&(T=T/S*a*u,L=L/S*a*u)}if(Math.random()>p){let S=Math.atan2(this.dy,this.dx)+x.range(-.1,.1),I=Math.hypot(this.dx,this.dy);k=I*Math.cos(S)-this.dx,P=I*Math.sin(S)-this.dy}this.ddx=g+A+T+k,this.ddy=b+C+L+P,this.dx+=this.ddx,this.dy+=this.ddy;let q=Math.hypot(this.dx,this.dy);q>o&&(this.dx=this.dx/q*o,this.dy=this.dy/q*o);let D=this.x-3*this.dx,X=this.y-3*this.dy;this.x+=this.dx,this.y+=this.dy,s.line(this.x,this.y,D,X),this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-1?(this.y=e-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1)}),y=x.range(0,2*Math.PI);for(let f=0;f<r;++f){let g=x.range(.001,1)*o,b=x.range(-.1,.1);m.createParticle(0,x.range(i-10.01,i+10),x.range(n-10.01,n+10),g*Math.cos(b+y),g*Math.sin(b+y),...x.randomColor())}s.stroke(0,0,0,255),s.frame=function(){s.background(0),m.render()},s.loop()},bz:function(){let t=s.width,e=Array.from({length:8},()=>Math.random()*t),i=Array.from({length:8},()=>Math.random()*t),n=Array.from({length:8},()=>Math.random()*15);s.background(255),s.noFill(),s.frame=function(){s.stroke(0,0,0,20),e.map(function(r,o,a){let c=r+n[o];c<0?(c=0,n[o]*=-1):c>t&&(c=t,n[o]*=-1),a[o]=c}),s.bezier.apply(null,e),s.stroke(255,128,128,20),i.map(function(r,o,a){let c=r+n[o];c<0?(c=0,n[o]*=-1):c>t&&(c=t,n[o]*=-1),a[o]=c}),s.bezier.apply(null,i)},s.loop()},cell:function(t=30,e=!1,i=200,n=200){s.init({background:0,frameRate:400,height:+n,width:+i});let r=s.width,o=s.height,a=1,c=0,d=new Array(r*o).fill(c),h=(p=>{let m=p.toString(2).padStart(8,"0"),y=[];for(let f=0;f<8;++f)+m[7-f]&&y.push(f);return(f,g)=>{let b=(g-1)*r+f,A=parseInt([d[b-1],d[b],d[b+1]].join(""),2);return y.some(C=>A===C)?a:c}})(+t);if(s.stroke(255),e===!1||e==="false")d[r/2]=a,s.point(r/2,0);else if(e==="random")for(let p=0;p<r;++p)Math.random()>.5&&(d[p]=a,s.point(p,0));else{let p=e.length,m=Math.floor((r-p)/2);for(let y=0;y<p;++y)+e[y]&&(d[m+y]=a,s.point(m+y,0))}let l=0,u=d.length/r;s.frame=function(){for(let p=0;p<r;++p){let m=h(p,l);m&&(d[l*r+p]=m,s.point(p,l))}l!==u&&l++},s.loop()},chaos:function(t="3"){s.init({frameRate:400});let e=s.width,i=s.height,n=e/2,r=i/2,o=n-50,a=Math.PI/180,c={3:[{x:e/2,y:50},{x:50,y:i-50},{x:e-50,y:i-50}],5:[{x:e-50,y:50},{x:50,y:50},{x:50,y:i-50},{x:e-50,y:i-50},{x:n,y:r}],6:[{x:Math.cos(0)*o+n,y:Math.sin(0)*o+r},{x:Math.cos(60*a)*o+n,y:Math.sin(60*a)*o+r},{x:Math.cos(120*a)*o+n,y:Math.sin(120*a)*o+r},{x:Math.cos(180*a)*o+n,y:Math.sin(180*a)*o+r},{x:Math.cos(240*a)*o+n,y:Math.sin(240*a)*o+r},{x:Math.cos(300*a)*o+n,y:Math.sin(300*a)*o+r}]}[t],d={3:2,5:1.5,6:1.5}[t];s.background(0),s.stroke(255,255,255,255);for(let{x:u,y:p}of c)s.point(u,p);let h=Math.random()*e,l=Math.random()*i;s.frame=function(){let u=x.roll(c.length);h+=(c[u].x-h)/d,l+=(c[u].y-l)/d,s.point(h,l)},s.loop()},fire:function(){s.init({background:0,frameRate:60,height:300,showFrameRate:!1,width:300});let t=s.width,e=s.doubleBuffer(),i=s.createImage(),n=s.color(255,128,96),r=4294940974;for(let d=0;d<i.length;++d)i[d]=419076398;i.update();let o=e.writeBuffer;for(let d=0;d<o.length;++d)o[d]=[0,0,0,255];e.flip(),o=e.writeBuffer;for(let d=0;d<o.length;++d)o[d]=[0,0,0,255];e.flip();let a=e.readBuffer.length/t,c=new N(s,function(){this.x+=this.dx,this.y+=this.dy,this.dy-=.05,this.x<1&&(this.x=1,this.dx*=-.5),this.x>=t-2&&(this.x=t-2,this.dx*=-.5),(this.y|0)<4&&(this.active=!1)},function(d){e.writeBuffer[(this.y|0)*t+this.x]=d.color(this.r,this.g,this.b,this.a*(1-this.t/this.ttl))});s.frame=function(){let d=e.readBuffer,h=e.writeBuffer;for(let l=0;l<t;++l)Math.random()>.97&&c.createParticle(x.range(12,24)*4,l,a-1,x.range(-.95,.95),-x.range(.01,.0625),r);for(let l=t;l<h.length-t;++l){if(l%t<1||l%t>=t-1)continue;let u=l/t;if(Math.random()<Math.pow(Math.E,Math.pow(u/a,10))-1&&Math.random()>.995){h[l-1]=n,h[l+1]=n,c.createParticle(x.range(12,24)*2,l%t,l/t,x.range(-.3,.3),-x.range(.01,.0625),n);continue}h[l]=x.addColors(x.decodeColor(d[l-1]),x.decodeColor(d[l]),x.decodeColor(d[l]),x.decodeColor(d[l+1]),x.decodeColor(d[l+t])).map((p,m)=>{if(m===3)return 255;let y=p/5.3;return y<10?0:y})}c.render(),e.flip()},s.loop()},fireworks:function(){let t=s.width,e=s.height,i=new N(s,function(){this.dx+=i.ACCELERATION[0],this.dy+=i.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let h=1-this.t/this.ttl;this.r=255*Math.pow(h,.2),this.g=255*h*h,this.b=255*h*h*h*h,this.a=255*h}),n=new N(s,function(){this.dx+=n.ACCELERATION[0],this.dy+=n.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let h=1-this.t/this.ttl;this.b=255*Math.pow(h,.2),this.g=255*h*h,this.r=255*h*h*h*h,this.a=255*h}),r=new N(s,function(){this.dx+=r.ACCELERATION[0],this.dy+=r.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let h=1-this.t/this.ttl;this.g=255*Math.pow(h,.2),this.r=255*h*h,this.b=255*h*h*h*h,this.a=255*h}),o=new N(s,function(){this.dx+=o.ACCELERATION[0],this.dy+=o.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let h=1-this.t/this.ttl;this.r=255*Math.pow(h,.2),this.g=255*Math.pow(h,.2),this.b=255*h*h*h*h,this.a=255*h}),a=new N(s,function(){this.dx+=a.ACCELERATION[0],this.dy+=a.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let h=1-this.t/this.ttl;this.r=255*Math.pow(h,.2),this.b=255*h*h*h*h,this.g=255*h,this.a=255*h}),c=new N(s,function(){this.dx+=c.ACCELERATION[0],this.dy+=c.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let h=1-this.t/this.ttl;this.r=255*Math.pow(h,.2),this.b=255*Math.pow(h,.2),this.g=255*h*h*h*h,this.a=255*h});i.ACCELERATION=[0,.15],n.ACCELERATION=[0,.15],r.ACCELERATION=[0,.15],o.ACCELERATION=[0,.15],a.ACCELERATION=[0,.15],c.ACCELERATION=[0,.15];function d(h,l){let u;switch(x.range(0,5)){case 0:u=i;break;case 1:u=n;break;case 2:u=r;break;case 3:u=o;break;case 4:u=c;break;case 5:u=a;break}for(let p=0;p<300;++p){let m=x.range(0,Math.PI*2),y=x.range(.001,10);u.createParticle(x.range(50.001,100),h,l,Math.cos(m)*y,Math.sin(m)*y,0,0,0,0)}}s.frame=function(){s.background(0),Math.random()>.95&&d(x.range(.001,t),x.range(.001,e/2)),i.render(),n.render(),r.render(),o.render(),c.render(),a.render()},s.loop()},fountain:function(){let t=s.width,e=s.height,i=new N(s,function(){this.dx+=i.ACCELERATION[0],this.dy+=i.ACCELERATION[1],this.x+=this.dx,this.y+=this.dy;let o=1-this.t/this.ttl;this.r=255*Math.pow(o,.2),this.g=255*o*o,this.b=255*o*o*o*o,this.a=255*Math.pow(o,.2),this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-2?(this.dy<.25?this.y=e-1:this.y=e-2,this.dy*=-1.2*Math.random()*i.ELASTICITY,Math.random()<.5?this.dx-=this.dy:this.dx+=this.dy):this.y<0&&(this.y=0,this.dy*=-1*i.ELASTICITY),this.y===e-1&&(this.active=!1)}),n=-20.01,r=[255,255,255,255];s.frame=function(){s.background(0);for(let o=0;o<15;++o){let a=x.range(-.098,.098),c=x.range(n,.8*n);i.createParticle(x.range(10,30.01)*-c,t/2,e-20,Math.sin(a)*c,Math.cos(a)*c,...r)}i.render()},s.loop()},graviton:function(t=3.4,e=20){let i=s.width,n=s.height,r=i/2,o=n/2,a=25,c=+e,d=6,h=2,l=+t,u=new N(s,function(p){let m=0,y=0,f=p.list,g=f;for(;g.active;){if(g===this){if(g=g.next,g===f)break;continue}let P=x.distance(this.x,this.y,g.x,g.y),E=x.direction(this.x,this.y,g.x,g.y),v=l*3/(P/3)**h,O=v*Math.cos(E),M=v*Math.sin(E);if(P<1){let q=x.direction(this.x,this.y,g.x,g.y),D=Math.cos(q),X=Math.sin(q),S=Math.hypot(this.dx,this.dy),I=Math.hypot(g.dx,g.dy);this.dx=I*D,this.dy=I*X,g.dx=S*D,g.dy=S*X;break}else P<3?(m+=-O*2,y+=-M*2):(m+=O,y+=M);if(g=g.next,g===f)break}this.ddx=m,this.ddy=y;let b=x.direction(this.x,this.y,r,o),A=x.distance(this.x,this.y,r,o),C=l*7/(A/5)**h,T=C*Math.cos(b),L=C*Math.sin(b);A<a?(this.ddx+=-L*2,this.ddy+=-T*2):(this.ddx+=T,this.ddy+=L),this.dx+=this.ddx,this.dy+=this.ddy;let k=Math.hypot(this.dx,this.dy);k>d&&(this.dx=this.dx/k*d,this.dy=this.dy/k*d),this.x+=this.dx,this.y+=this.dy,this.x>=i-1?(this.x=i-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=n-1?(this.y=n-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1),this.x===0&&this.y===0&&(this.x=x.roll(i),this.y=x.roll(n))},function(p){p.stroke(this.r,this.g,this.b,this.a),p.ellipse(this.x,this.y,3,3)});for(let p=0;p<c;++p){let m=d,y=1.25+x.range(-.088,.088);u.createParticle(0,x.roll(r-100),x.roll(o),m*Math.cos(y),m*Math.sin(y),255,255,196)}s.stroke(0,0,0,255),s.frame=function(){s.background(0),u.render(),s.fill(255,255,200),s.stroke(255,255,0),s.ellipse(r,o,a,a)},s.loop()},lens:function(t=150,e=30){t=+t,e=+e;let i=s.width,n=s.createImage(),r=n.height;for(let f=0;f<n.length;++f)n[f]=Vt(r,r/32,255,f);n.update();let o=s.createImage(t,t),a=new Array(t*t).fill(0),c=Math.round(t/2),d=c*c,h=c*(t+1),l;for(let f=0;f<d;++f){let g=f%c,b=Math.floor(f/c),A=g*g,C=b*b,T=0,L=0;if(A+C<d){let k=e/Math.sqrt(e*e-(A+C-d));T=Math.floor(g*k)-g,L=Math.floor(b*k)-b}l=L*i+T,a[h-b*t-g]=-l,a[h+b*t+g]=l,l=-L*i+T,a[h-b*t+g]=l,a[h+b*t-g]=-l}let u=i/2,p=i/2,m=1,y=2;s.frame=function(){u+=m,p+=y,u<0&&(u=0,m=-m),u>i-t&&(u=i-t,m=-m),p<0&&(p=0,y=-y),p>i-t&&(p=i-t,y=-y),s.background(n);let f=p*i+u;for(let g=0;g<t*t;++g)o[g]=n[Math.round(f)+Math.floor(g/t)*i+g%t+a[g]];o.blit(u,p)},s.loop()},life:function(t=300,e=300){s.init({background:0,frameRate:12,height:+e,width:+t});let i=s.width,n=s.height,r=.05,o=0,a=1,c=1,d=0,h=-1,l=Array.from(Array(i*n)).map(()=>Array.from(Array(2)));l.forEach(p=>{p[o]=d,p[a]=Math.random()<r?c:d});function u(p){let m=p%i,y=Math.floor(p/i),f=0;return y>0&&(m>0&&(f+=l[p-i-1][o]),m<i-1&&(f+=l[p-i+1][o]),f+=l[p-i][o]),y<n-1&&(m>0&&(f+=l[p+i-1][o]),m<i-1&&(f+=l[p+i+1][o]),f+=l[p+i][o]),m>0&&(f+=l[p-1][o]),m<i-1&&(f+=l[p+1][o]),f}s.stroke(255),s.frame=function(){s.background(0),l.forEach((p,m)=>{let y=l[m];if(p[a]===c||p[o]===c){y[o]=c;let A=m%i,C=m/i;s.point(A,C)}p[a]===h&&(y[o]=d),y[a]=d;let f=m-3*i;if(f<0)return;let g=l[f],b=u(f);b===3&&g[o]===d&&(g[a]=c),(b<2||b>3)&&g[o]===c&&(g[a]=h)})},s.loop()},pattern:function(t){let e=s.createImage(),i=e.height;for(let h=0;h<e.length;++h)e[h]=Vt(i,i/8,255,h);if(e.update(),s.background(e),t===void 0)return;s.init({showFrameRate:!0,showRuler:!0});let n=s.PVector.bind(s),r=20,o=360,a=s.width/2,c=s.height/2,d=Math.hypot(100,100);s.frame=()=>{s.background(0);let h=Math.PI/o*s.frameCount,l=Math.cos(h),u=Math.sin(h),p=Math.PI/r*s.frameCount,m=Math.cos(p),y=Math.sin(p),f=-y,g=m,b=new n(a,c),A=new n(l,u);A.setMag(d),A.add(b);let C=new n(l,u),T=new n(l,u);C.setMag(d*.33),T.setMag(d*.66);let L=new n(f,g);L.setMag(C.mag()*.5),L.add(C),L.add(b);let k=new n(m,y);k.setMag(T.mag()*.5),k.add(T),k.add(b);let P=new n(A.x,A.y);P.sub(b);let E=new n(L.x,L.y);E.sub(b);let v=(P.x*E.y-P.y*E.x)/P.mag()*1.5,O=new n(b.x,b.y);O.sub(A);let M=new n(-O.y,O.x);switch(M.setMag(v),M.add(A),s.fill(0,0,0,0),t){case"circles":case"full":if(s.stroke(255,0,0,255),s.line(b.x,b.y,A.x,A.y),s.ellipse(b.x+C.x,b.y+C.y,C.mag(),C.mag()),s.ellipse(b.x+T.x,b.y+T.y,T.mag(),T.mag()),s.stroke(0,255,0,255),s.line(b.x+C.x,b.y+C.y,L.x,L.y),s.line(b.x+T.x,b.y+T.y,k.x,k.y),s.line(A.x,A.y,M.x,M.y),s.ellipse(L.x,L.y,3,3),s.ellipse(k.x,k.y,3,3),s.ellipse(M.x,M.y,3,3),t==="circles")break;case"tail":s.stroke(255,255,255,255),s.bezier(b.x,b.y,L.x,L.y,k.x,k.y,M.x,M.y)}},s.loop()},plasma:function(){s.init({background:0,height:300,width:300});let t=s.width,e=s.height,i=s.createImage(),n={},r={};function o(y){let f=1-y/255,g=255*f,b=255*f*f;return[255*f*f*f*f,b,g,255]}for(let y=0;y<256;++y)r[y]=o(y);for(let y=0;y<512;++y){let f=y*.703125*.0174532;n[y]=Math.sin(f)*1024}let a=0,c=0,d=0,h=0,l=0,u=0,p=0,m=0;s.frame=function(){p=d,m=h;for(let y=0;y<e;++y){l=a+5,u=c+3,p&=511,m&=511;for(let f=0;f<t;++f){l&=511,u&=511;let b=128+(n[l]+n[u]+n[p]+n[m]>>4);i[y*t+f]=r[b],l+=5,u+=3}p+=1,m+=3}a+=9,d+=8,i.update(),s.background(i)},s.loop()},rod:function(){let t=s.width,e=s.height,i=t/2,n=e/2,r=t/2+x.range(-100,100.01),o=t/2+x.range(-100,100.01),a=x.roll(-3.01,3),c=x.roll(-3.01,3),d,h,l=20,u=12,p=5,m=200,y=3,f=5e-4,g=100,b=40,A=.75,C=.5,T=3,L=.66,k=new N(s,function(E){let v={x:0,y:0},O={x:0,y:0},M={x:0,y:0},q={x:0,y:0},D=0,X=0,S=E.list,I=S;for(;I.active;){if(I===this){if(I=I.next,I===S)break;continue}let H=Math.hypot(this.x-I.x,this.y-I.y);if(H<g&&(v.x+=I.dx,v.y+=I.dy,O.x+=I.x,O.y+=I.y,D++),H<b){let K=(b-H)/b;M.x+=(this.x-I.x)*K,M.y+=(this.y-I.y)*K,X++}if(I=I.next,I===S)break}if(d+=this.x,h+=this.y,D>0){v.x/=D,v.y/=D;let H=Math.hypot(v.x,v.y);H>0&&(v.x=v.x/H*f*A,v.y=v.y/H*f*A),O.x=(O.x/D-this.x)*f*C,O.y=(O.y/D-this.y)*f*C}if(X>0){M.x/=X,M.y/=X;let H=Math.hypot(M.x,M.y);H>0&&(M.x=M.x/H*f*T,M.y=M.y/H*f*T)}if(Math.random()>L){let H=Math.atan2(this.dy,this.dx)+x.range(-.1,.1),K=Math.hypot(this.dx,this.dy);q.x=K*Math.cos(H)-this.dx,q.y=K*Math.sin(H)-this.dy}this.ddx=v.x+O.x+M.x+q.x+(r-this.x)*1e-4,this.ddy=v.y+O.y+M.y+q.y+(o-this.y)*1e-4,x.distance(this.x,this.y,r,o)<50&&(this.ddx+=(r-this.x)*.01,this.ddy+=(o-this.y)*.01),this.dx+=this.ddx,this.dy+=this.ddy;let ot=Math.hypot(this.dx,this.dy);ot>y&&(this.dx=this.dx/ot*y,this.dy=this.dy/ot*y),this.x+=this.dx,this.y+=this.dy;let Et=x.direction(this.x,this.y,this.x-this.dx,this.y-this.dy),rt=Math.cos(Et),at=Math.sin(Et),At=.33*u,Ct=.66*u,ht=At*rt,ct=At*at,lt=Ct*rt,dt=Ct*at,Ot=this.x+u*rt,Lt=this.y+u*at;this.unique??=x.roll(Math.PI/2);let Tt=Math.PI/p*s.frameCount+this.unique,it=Math.cos(Tt),J=Math.sin(Tt),ee=this.x+ht+.5*(ht*-J-ct*it),ie=this.y+ct+.5*(ht*it+ct*-J),ne=this.x+lt+.5*(lt*it-dt*J),se=this.y+dt+.5*(lt*J+dt*it),kt=this.x-Ot,Pt=this.y-Lt,Rt=Math.hypot(kt,Pt),oe=-Pt/Rt,re=kt/Rt,It=J*3,ae=Ot+oe*It,he=Lt+re*It;s.bezier(this.x,this.y,ee,ie,ne,se,ae,he),this.x>=t-1?(this.x=t-1,this.dx*=-1):this.x<0&&(this.x=0,this.dx*=-1),this.y>=e-1?(this.y=e-1,this.dy*=-1):this.y<0&&(this.y=0,this.dy*=-1)},function(E){E.stroke(this.r,this.g,this.b,this.a),E.ellipse(this.x,this.y,2,2)}),P=x.range(0,2*Math.PI);for(let E=0;E<m;++E){let v=x.range(.001,1)*y,O=x.range(-.1,.1);k.createParticle(0,x.range(i-10.01,i+10),x.range(n-10.01,n+10),v*Math.cos(O+P),v*Math.sin(O+P),255,255,255,255)}s.frame=function(){d=0,h=0,s.background(0),s.fill(0,0,0,0),s.stroke(255,255,255,255),k.render(),d/=k.count,h/=k.count,a+=-(d-r)*1e-4+(i-r)*1e-4,c+=-(h-o)*1e-4+(n-o)*1e-4;let E=Math.hypot(a,c);E>y*1.4&&(a=a/E*y*1.4,c=c/E*y*1.4),r+=a,o+=c,r<0&&(r=0,a=-a),r>t-l&&(r=t-l,a=-a),o<0&&(o=0,c=-c),o>e-l&&(o=e-l,c=-c),s.stroke(196,128,196),s.fill(255,128,164,128),s.ellipse(r,o,l,l)},s.loop()},snow:function(){let t=s.width,e=s.height,i=new N(s,function(){this.x+=this.dx,this.y+=this.dy,(this.x>=t-1||this.y>=e-1||this.y<0)&&(this.active=!1)});s.frame=function(){s.background(0),i.createParticle(0,x.range(-t/2,t-1),0,x.range(0,.25),x.range(.4,.6),255,255,255,x.range(96,255)),i.render()},s.loop()},spiro:function(t=!0,e=!1,i=!0){let n=s.width,r=s.height,o=s.PVector.bind(s),a=new o(n/2,r/2),c=new o(0,0),d=new o(0,0),h=i==="false"?360:36,l=n/2,u=100,p=x.roll(u),m=x.roll(l),y=Math.random(),f=Math.random(),g=(u+p)/p,b=(l-m)/m;s.frame=function(){let A=Math.PI/h*s.frameCount,C=Math.cos(A),T=Math.sin(A),L=Math.PI/h*s.frameCount*g,k=-Math.PI/h*s.frameCount*b,P=new o(C,T);P.setMag(l-m),P.add(a);let E=new o(C,T);E.setMag(u+p),E.add(a);let v=new o(Math.cos(L),Math.sin(L));v.setMag(p*y),v.add(E);let O=new o(Math.cos(k),Math.sin(k));O.setMag(m*f),O.add(P),i==="false"?(s.background(0),s.fill(0,0,0,0),s.stroke(0,255,0,255),s.ellipse(a.x,a.y,l*2,l*2),s.ellipse(a.x,a.y,u*2,u*2),t&&t!=="false"&&(s.stroke(255,255,255,255),s.line(a.x,a.y,P.x,P.y),s.line(P.x,P.y,O.x,O.y),s.stroke(255,0,0,255),s.ellipse(P.x,P.y,m*2,m*2),s.ellipse(O.x,O.y,2,2)),e&&e!=="false"&&(s.stroke(255,255,255,255),s.line(a.x,a.y,E.x,E.y),s.line(E.x,E.y,v.x,v.y),s.stroke(255,0,0,255),s.ellipse(E.x,E.y,p*2,p*2),s.ellipse(v.x,v.y,2,2))):(s.stroke(255,255,255,255),t&&t!=="false"&&(d.mag()===0&&d.set(O),s.line(d.x,d.y,O.x,O.y),d.set(O)),s.stroke(128,255,128,255),e&&e!=="false"&&(c.mag()===0&&c.set(v),s.line(c.x,c.y,v.x,v.y),c.set(v)))},s.loop()},stars:function(){let t=s.width,e=s.height,i=t/2,n=e/2,r=i*.75,o=new N(s,function(){let a=this.x-3*this.dx,c=this.y-3*this.dy;this.x+=this.dx,this.y+=this.dy,s.line(this.x,this.y,a,c),(this.x>=t-1||this.y>=e-1||this.x<0||this.y<0)&&(this.active=!1);let d=Math.hypot(this.dx,this.dy),h=Math.min(x.distance(this.x,this.y,i,n),i);this.a=128*Math.max(1-h/r,0)+64*(d/10)+64*Math.max(1-this.t++,0)});s.frame=function(){s.background(0);for(let a=0;a<20;++a){let c=(x.roll(t)+x.roll(t))/2,d=x.roll(e)+x.roll(e)/2,h=Math.min(x.distance(c,d,i,n),i),l=-Math.atan2(n-d,c-i),u=10*(h/i)+1;o.createParticle(0,c,d,Math.cos(l)*u,Math.sin(l)*u,255,255,255,0)}o.render()},s.loop()}};zt.exports=Ee});var te=j((Fe,Zt)=>{var et=Qt(),st=nt().Renderer(),bt=Object.freeze({cat:{func:function(t){this.echo(et[t].toString())},man:"Print code listing for [demo]"},clear:{func:function(){this.clear()}},help:{func:function(t){t===void 0?(this.echo("Available commands:"),Object.keys(bt).forEach(e=>this.echo(e))):this.echo(bt[t].man)},man:"Print help text for [command].  If no command is passed, list available commands.",usage:"help [command]"},init:{func:function(){st.init()}},load:{func:function(t,...e){t in et&&(this.echo(`Loading ${t}\u2026`),st.init(),et[t].apply(et,e))},man:"Load a demo.  Some demos accept additional arguments.\n<b>Example:</b>\n`load chaos 6`.",usage:"load [demo] [args]"},ls:{func:function(){this.echo("Available demos:"),Object.keys(et).filter(t=>t!=="rod").forEach(t=>this.echo(t))},man:"List available demos"},properties:{func:function(t){t===void 0&&this.echo(JSON.stringify(st,null,2)),this.echo(st[t])}}});Zt.exports=bt});var vt=(G(),V(B)).default,{Executor:Ae}=yt();_t();var{Renderer:Ce}=nt();vt.setLogLevel("trace");var Mt=new vt("index.js");window.addEventListener("load",()=>{Mt.info("Creating renderer");let t=document.querySelector("canvas"),e=t.getBoundingClientRect();t.width=e.width,t.height=e.height,Mt.debug(`initial canvas width (${t.width}) height (${t.height})`),Ce(t),Mt.info("Creating executor");let i=document.querySelector("ng-terminal"),n=new vt("Executor.js");i.executor=Ae.bind(i)(n,te())});})();
